<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Kod Generator Pro - Ücretsiz AI Destekli QR Code Generator 2024</title>
    <meta name="description" content="🚀 Türkiye'nin en gelişmiş ÜCRETSIZ QR kod generator! AI optimizasyonu, 11 format desteği, tema sistemi, offline çalışma. Logo ekleme, toplu üretim, analytics. Profesyonel QR kodlar 30 saniyede hazır!">
    <meta name="keywords" content="qr kod generator, ücretsiz qr kod, qr code generator, ai qr kod, profesyonel qr, logo qr, toplu qr üretim, qr tarayıcı, offline qr, tema qr kod">
    <meta name="google-site-verification" content="placeholder-verification-code">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="author" content="QR Generator Pro Team">
    <meta name="generator" content="QR Generator Pro v2.2">
    <meta name="rating" content="General">
    <meta name="revisit-after" content="1 days">
    
    <!-- Content Security Policy - XSS Protection -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://pagead2.googlesyndication.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' data: blob: https:; connect-src 'self' https:; media-src 'self' blob:; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';">
    
    <!-- Enhanced Social Media & SEO Meta Tags -->
    <meta property="og:title" content="QR Generator Pro - En Gelişmiş QR Kod Üretici">
    <meta property="og:description" content="🚀 AI destekli QR kod generator! 11 farklı format, offline çalışma, tema sistemi, analytics ve daha fazlası. Ücretsiz ve profesyonel.">
    <meta property="og:image" content="https://qrgenerator-pro.com/og-image.jpg">
    <meta property="og:url" content="https://qrgenerator-pro.com">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="QR Generator Pro">
    
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@qrgeneratorpro">
    <meta name="twitter:creator" content="@qrgeneratorpro">
    <meta name="twitter:title" content="QR Generator Pro - AI-Powered QR Code Generator">
    <meta name="twitter:description" content="Create professional QR codes with AI optimization, 11 formats, themes, and offline support. Free & Open Source!">
    <meta name="twitter:image" content="https://qrgenerator-pro.com/twitter-card.jpg">
    
    <!-- LinkedIn -->
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- App Store Optimization -->
    <meta name="application-name" content="QR Generator Pro">
    <meta name="msapplication-TileColor" content="#4338CA">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://qrgenerator-pro.com">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="geo.region" content="TR">
    <meta name="geo.placename" content="Turkey">
    <meta name="ICBM" content="39.925533, 32.866287">
    <meta name="coverage" content="Worldwide">
    <meta name="distribution" content="Global">
    <meta name="target" content="all">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Business Information -->
    <meta name="business:contact_data:street_address" content="Online Service">
    <meta name="business:contact_data:locality" content="Turkey">
    <meta name="business:contact_data:region" content="Global">
    <meta name="business:contact_data:postal_code" content="00000">
    <meta name="business:contact_data:country_name" content="Turkey">
    
    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": ["WebApplication", "SoftwareApplication"],
        "name": "QR Generator Pro",
        "alternateName": "QR Kod Generator Pro",
        "description": "Türkiye'nin en gelişmiş ücretsiz QR kod generator uygulaması. AI optimizasyonu, 11 farklı format desteği, offline çalışma, tema sistemi ve profesyonel özellikler.",
        "url": "https://qrgenerator-pro.com",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "All",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "QR kod oluşturma (11 farklı tip)",
            "QR kod tarama (kamera + dosya)",
            "Toplu QR üretimi (CSV/Excel desteği)", 
            "QR geçmişi ve favoriler",
            "Gelişmiş renk/desen özelleştirme",
            "Logo ekleme desteği",
            "Offline çalışma modu",
            "PWA desteği",
            "Dark mode",
            "Accessibility (WCAG 2.1)",
            "Çoklu format export (PNG/SVG/PDF)",
            "Sosyal medya paylaşım",
            "Analytics ve istatistikler"
        ],
        "screenshot": "https://qrgenerator-pro.com/screenshot-wide.png",
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1247",
            "bestRating": "5",
            "worstRating": "1"
        },
        "author": {
            "@type": "Organization",
            "name": "QR Generator Pro Team",
            "url": "https://qrgenerator-pro.com"
        },
        "publisher": {
            "@type": "Organization",
            "name": "QR Generator Pro",
            "logo": {
                "@type": "ImageObject",
                "url": "https://qrgenerator-pro.com/favicon.svg"
            }
        },
        "datePublished": "2024-01-15",
        "dateModified": "2024-08-24",
        "inLanguage": "tr-TR",
        "isAccessibleForFree": true,
        "usageInfo": "https://qrgenerator-pro.com/kullanim-kosullari.html",
        "privacyPolicy": "https://qrgenerator-pro.com/gizlilik-politikasi.html",
        "creator": {
            "@type": "Organization",
            "name": "QR Generator Pro Development Team"
        },
        "maintainer": {
            "@type": "Organization", 
            "name": "QR Generator Pro Team"
        },
        "softwareHelp": {
            "@type": "CreativeWork",
            "name": "QR Generator Pro Yardım",
            "url": "https://qrgenerator-pro.com#help"
        }
    }
    </script>
    
    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Ana Sayfa",
                "item": "https://qrgenerator-pro.com"
            },
            {
                "@type": "ListItem", 
                "position": 2,
                "name": "QR Generator",
                "item": "https://qrgenerator-pro.com#generator"
            }
        ]
    }
    </script>
    
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "QR Generator Pro ücretsiz mi?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Evet, QR Generator Pro tamamen ücretsizdir. Tüm özellikler ücretsiz kullanılabilir."
                }
            },
            {
                "@type": "Question", 
                "name": "Hangi QR kod türlerini destekliyor?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "11 farklı QR kod türünü destekliyoruz: Metin, URL, WiFi, Telefon, E-posta, SMS, vCard, Etkinlik, Kripto, Geolokasyon, Sosyal Medya, App Store ve Toplantı."
                }
            },
            {
                "@type": "Question",
                "name": "Offline kullanım mümkün mü?",
                "acceptedAnswer": {
                    "@type": "Answer", 
                    "text": "Evet, PWA teknolojisi sayesinde internet bağlantısı olmadan da QR kod oluşturabilir ve tarayabilirsiniz."
                }
            }
        ]
    }
    </script>
    
    <!-- Enhanced Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' 'unsafe-eval' 
                   https://www.googletagmanager.com 
                   https://www.google-analytics.com 
                   https://pagead2.googlesyndication.com
                   https://cdn.jsdelivr.net
                   https://cdnjs.cloudflare.com;
        style-src 'self' 'unsafe-inline' 
                  https://fonts.googleapis.com 
                  https://cdnjs.cloudflare.com;
        font-src 'self' 
                 https://fonts.gstatic.com 
                 https://cdnjs.cloudflare.com;
        img-src 'self' data: blob: 
                https://www.google-analytics.com
                https://www.googletagmanager.com;
        connect-src 'self' 
                    https://www.google-analytics.com
                    https://www.googletagmanager.com
                    https://nominatim.openstreetmap.org;
        media-src 'self' blob:;
        worker-src 'self';
        manifest-src 'self';
        base-uri 'self';
        form-action 'self';
        frame-ancestors 'none';
        upgrade-insecure-requests;
    ">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="
        camera=(self),
        microphone=(),
        geolocation=(self),
        clipboard-write=(self),
        clipboard-read=(self),
        accelerometer=(),
        gyroscope=(),
        magnetometer=(),
        payment=(),
        usb=()
    ">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4F46E5">
    
    <!-- Core Web Vitals Optimization -->
    <!-- Resource Hints for Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
    
    <!-- Preload Critical Assets -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"></noscript>
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <!-- Prefetch Next-Page Resources -->
    <link rel="prefetch" href="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js">
    <link rel="prefetch" href="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js">
    
    <!-- DNS Prefetch for External Domains -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
    
    <!-- Structured Data - Software Application -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "QR Generator Pro",
        "description": "Ücretsiz AI destekli QR kod generator. 11 farklı format, offline çalışma, tema sistemi, analytics ve daha fazlası.",
        "url": "https://netroya.github.io/QR-CODE-GENERATOR/",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "QR Generator Pro Team"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1245"
        },
        "featureList": [
            "11 farklı QR kod formatı",
            "AI destekli optimizasyon",
            "Offline çalışma",
            "Tema sistemi",
            "Toplu üretim",
            "Logo ekleme",
            "Analytics"
        ],
        "screenshot": "https://netroya.github.io/QR-CODE-GENERATOR/og-image.jpg",
        "softwareVersion": "2.2",
        "dateModified": "2025-08-28",
        "isAccessibleForFree": true,
        "inLanguage": "tr-TR"
    }
    </script>
    
    <!-- Preload Critical Images -->
    <link rel="preload" href="favicon.svg" as="image" type="image/svg+xml">
    
    <!-- Critical CSS Inline (defer non-critical) -->
    <style>
        /* Critical Above-the-fold CSS */
        :root {
            --primary-color: #4F46E5;
            --text-primary: #1F2937;
            --bg-primary: #FFFFFF;
            --border-color: #E5E7EB;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        /* Above-the-fold content prioritized */
        .tab-content {
            display: none;
            padding: 2rem;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .generator-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .generator-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .nav-container {
                padding: 0 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .container {
                margin: 1rem;
                padding: 0 1rem;
            }
        }
    </style>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-40X5D8K6WH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-40X5D8K6WH', {
            page_title: 'QR Kod Generator Pro - Ana Sayfa',
            page_location: window.location.href
        });
    </script>
    
    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=pub-9023802833968711" crossorigin="anonymous"></script>
    
    <style>
        :root {
            --primary-color: #4F46E5;
            --primary-dark: #3730A3;
            --secondary-color: #06B6D4;
            --accent-color: #F59E0B;
            --success-color: #10B981;
            --error-color: #EF4444;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --text-primary: #1F2937;
            --text-secondary: #6B7280;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F9FAFB;
            --border-color: #E5E7EB;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
        }

        .nav-tab {
            padding: 0.5rem 1rem;
            background: none;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            color: var(--text-secondary);
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .nav-tab:hover:not(.active) {
            background: var(--bg-secondary);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .tab-content.active {
            display: block;
        }

        .tab-header {
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            text-align: center;
        }

        .tab-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .tab-header p {
            opacity: 0.9;
        }

        /* Generator Tab */
        .generator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            padding: 2rem;
        }

        .input-section {
            padding: 2rem;
            background: var(--bg-secondary);
            border-radius: 15px;
        }

        .type-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .type-btn {
            padding: 10px;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
            text-align: center;
        }

        .type-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .type-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .type-btn i {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .input-form {
            display: none;
        }

        .input-form.active {
            display: block;
        }

        .input-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .input-form input,
        .input-form textarea,
        .input-form select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-family: inherit;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }

        .input-form input:focus,
        .input-form textarea:focus,
        .input-form select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .customization-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: white;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .customization-section h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .color-picker-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .color-picker {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .color-picker input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .size-slider {
            margin-bottom: 1rem;
        }

        .size-slider input {
            width: 100%;
            margin-top: 0.5rem;
        }

        /* Enhanced CTA Styles for Conversion Optimization */
        .cta-container {
            text-align: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(67, 56, 202, 0.1), rgba(16, 185, 129, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(67, 56, 202, 0.2);
        }
        
        .enhanced-cta {
            position: relative;
            background: linear-gradient(135deg, #4338CA 0%, #10B981 100%);
            color: white;
            padding: 1.2rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 700;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(67, 56, 202, 0.3);
            min-width: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            overflow: hidden;
        }
        
        .enhanced-cta::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }
        
        .enhanced-cta:hover::before {
            left: 100%;
        }
        
        .enhanced-cta:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 15px 40px rgba(67, 56, 202, 0.4);
        }
        
        .enhanced-cta:active {
            transform: translateY(0) scale(1);
        }
        
        .cta-main {
            font-size: 1.2rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .cta-sub {
            font-size: 0.85rem;
            font-weight: 500;
            opacity: 0.95;
            letter-spacing: 0.3px;
        }
        
        .cta-features {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .feature-badge {
            background: rgba(255, 255, 255, 0.9);
            color: var(--primary-color);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid rgba(67, 56, 202, 0.2);
            transition: transform 0.2s ease;
        }
        
        .feature-badge:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(67, 56, 202, 0.2);
        }
        
        .cta-guarantee {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        /* Mobile CTA Optimization */
        @media (max-width: 768px) {
            .enhanced-cta {
                min-width: 250px;
                padding: 1rem 2rem;
                font-size: 1rem;
            }
            
            .cta-main {
                font-size: 1.1rem;
            }
            
            .cta-features {
                gap: 0.5rem;
            }
            
            .feature-badge {
                font-size: 0.7rem;
                padding: 0.3rem 0.6rem;
            }
        }

        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
            margin-top: 1rem;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
        }

        .output-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            background: var(--bg-secondary);
            border-radius: 15px;
        }

        #qr-display {
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            position: relative;
        }

        .qr-placeholder {
            text-align: center;
            color: var(--text-secondary);
        }

        .qr-placeholder i {
            font-size: 4rem;
            opacity: 0.3;
            margin-bottom: 10px;
        }

        .qr-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .action-btn {
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .action-btn.secondary {
            background: var(--text-secondary);
        }

        /* Scanner Tab */
        .scanner-container {
            padding: 2rem;
        }

        #video {
            width: 100%;
            max-width: 400px;
            height: 300px;
            background: #000;
            border-radius: 10px;
            margin: 0 auto;
            display: block;
        }

        .scanner-controls {
            text-align: center;
            margin-top: 1rem;
        }

        .scanner-result {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            display: none;
        }

        /* Batch Tab */
        .batch-container {
            padding: 2rem;
        }

        .batch-input {
            margin-bottom: 2rem;
        }

        .batch-textarea {
            width: 100%;
            height: 200px;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-family: monospace;
        }

        .batch-results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .batch-qr-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .batch-qr-item canvas {
            width: 100%;
            height: auto;
        }

        /* History Tab */
        .history-container {
            padding: 2rem;
        }

        .history-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .history-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .history-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .history-item-type {
            background: var(--primary-color);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .history-item-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .history-item-content {
            margin: 0.5rem 0;
            word-break: break-word;
        }

        .history-item-qr {
            text-align: center;
            margin: 1rem 0;
        }

        .history-item-qr canvas {
            width: 80px;
            height: 80px;
        }

        .hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .generator-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                display: none;
            }
            
            .mobile-nav {
                display: flex;
                justify-content: center;
                background: white;
                padding: 1rem;
                border-bottom: 1px solid var(--border-color);
            }
            
            .mobile-nav select {
                padding: 0.5rem;
                border-radius: 8px;
                border: 2px solid var(--border-color);
            }
        }

        @media (max-width: 768px) {
            .type-selector {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .history-list,
            .batch-results {
                grid-template-columns: 1fr;
            }
            
            .tab-header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 1rem;
            }
        }

        /* Notifications */
        /* Enhanced Notification System */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            min-width: 320px;
            max-width: 400px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            z-index: 1000;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            overflow: hidden;
            margin-bottom: 10px;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.removing {
            transform: translateX(100%);
            opacity: 0;
        }

        .notification.success {
            background: linear-gradient(135deg, var(--success-color), #059669);
            border-left: 4px solid #065f46;
        }

        .notification.error {
            background: linear-gradient(135deg, var(--error-color), #dc2626);
            border-left: 4px solid #991b1b;
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--warning-color), #d97706);
            border-left: 4px solid #92400e;
        }

        .notification.info {
            background: linear-gradient(135deg, var(--info-color), #2563eb);
            border-left: 4px solid #1d4ed8;
        }

        .notification.loading {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            border-left: 4px solid #3730a3;
        }

        .notification-content {
            display: flex;
            align-items: flex-start;
            padding: 16px 20px;
            color: white;
            gap: 12px;
        }

        .notification-icon {
            flex-shrink: 0;
            font-size: 18px;
            margin-top: 2px;
            opacity: 0.9;
        }

        .notification-message {
            flex: 1;
            font-weight: 500;
            line-height: 1.5;
            font-size: 14px;
        }

        .notification-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }

        .notification-action {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .notification-action:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            opacity: 0.7;
            transition: all 0.2s ease;
        }

        .notification-close:hover {
            background: rgba(255,255,255,0.2);
            opacity: 1;
        }

        .notification-progress {
            height: 3px;
            background: rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
        }

        .notification-progress::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: rgba(255,255,255,0.8);
            animation: progressShrink linear forwards;
        }

        @keyframes progressShrink {
            from { width: 100%; }
            to { width: 0%; }
        }

        /* Notification Stack Management */
        .notification:nth-child(n+2) {
            margin-top: -8px;
            transform: translateX(100%) scale(0.95);
            opacity: 0.8;
        }

        .notification:nth-child(n+2).show {
            transform: translateX(8px) scale(0.95);
        }

        .notification:nth-child(n+3) {
            transform: translateX(100%) scale(0.9);
            opacity: 0.6;
        }

        .notification:nth-child(n+3).show {
            transform: translateX(16px) scale(0.9);
        }

        /* Responsive Notifications */
        @media (max-width: 768px) {
            .notification {
                left: 10px;
                right: 10px;
                min-width: auto;
                max-width: none;
                top: 10px;
            }
            
            .notification.show,
            .notification:nth-child(n+2).show,
            .notification:nth-child(n+3).show {
                transform: translateX(0) scale(1);
            }
        }

        /* WCAG 2.1 Accessibility Styles */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-color);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 10000;
            font-weight: 600;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* High Contrast Mode Support */
        @media (prefers-contrast: high) {
            .nav-tab {
                border: 2px solid currentColor;
            }
            
            .type-btn {
                border: 2px solid currentColor;
            }
            
            .notification {
                border: 2px solid white;
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .notification {
                transition: none;
            }
            
            .nav-tab,
            .type-btn {
                transition: none;
            }
        }

        /* Focus Visible Enhancement */
        .nav-tab:focus-visible,
        .type-btn:focus-visible,
        button:focus-visible,
        input:focus-visible,
        select:focus-visible,
        textarea:focus-visible {
            outline: 3px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Screen Reader Only Content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Improved Color Contrast */
        :root {
            --primary-color: #4338CA; /* Improved contrast ratio */
            --primary-dark: #312E81;
            --secondary-color: #0891B2; /* Improved contrast */
            --text-primary: #111827; /* Darker for better contrast */
            --text-secondary: #4B5563; /* Better contrast */
            --success-color: #059669; /* WCAG AA compliant */
            --error-color: #DC2626; /* WCAG AA compliant */
            --warning-color: #D97706; /* WCAG AA compliant */
            --info-color: #2563EB; /* WCAG AA compliant */
        }

        /* Advanced Theme System */
        
        /* Light Theme (Default) */
        :root {
            --primary-color: #4338CA;
            --primary-dark: #312E81;
            --secondary-color: #0891B2;
            --accent-color: #F59E0B;
            --success-color: #059669;
            --error-color: #DC2626;
            --warning-color: #D97706;
            --info-color: #2563EB;
            --text-primary: #111827;
            --text-secondary: #4B5563;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F9FAFB;
            --bg-tertiary: #F3F4F6;
            --border-color: #E5E7EB;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.18);
        }

        /* Dark Theme */
        [data-theme="dark"] {
            --primary-color: #6366F1;
            --primary-dark: #4F46E5;
            --secondary-color: #06B6D4;
            --accent-color: #F59E0B;
            --success-color: #10B981;
            --error-color: #EF4444;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --text-primary: #F9FAFB;
            --text-secondary: #D1D5DB;
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-tertiary: #334155;
            --border-color: #475569;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --glass-bg: rgba(15, 23, 42, 0.95);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        /* High Contrast Theme */
        [data-theme="high-contrast"] {
            --primary-color: #0000FF;
            --primary-dark: #000080;
            --secondary-color: #008080;
            --accent-color: #FFD700;
            --success-color: #008000;
            --error-color: #FF0000;
            --warning-color: #FFA500;
            --info-color: #0000FF;
            --text-primary: #000000;
            --text-secondary: #333333;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F0F0F0;
            --bg-tertiary: #E0E0E0;
            --border-color: #000000;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            --glass-bg: rgba(255, 255, 255, 1);
            --glass-border: rgba(0, 0, 0, 0.3);
        }

        /* Auto Theme - System preference */
        @media (prefers-color-scheme: dark) {
            [data-theme="auto"] {
                --primary-color: #6366F1;
                --primary-dark: #4F46E5;
                --secondary-color: #06B6D4;
                --accent-color: #F59E0B;
                --success-color: #10B981;
                --error-color: #EF4444;
                --warning-color: #F59E0B;
                --info-color: #3B82F6;
                --text-primary: #F9FAFB;
                --text-secondary: #D1D5DB;
                --bg-primary: #0F172A;
                --bg-secondary: #1E293B;
                --bg-tertiary: #334155;
                --border-color: #475569;
                --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
                --glass-bg: rgba(15, 23, 42, 0.95);
                --glass-border: rgba(255, 255, 255, 0.1);
            }
        }

        /* Theme Controls Styling */
        .theme-controls {
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            position: relative;
            width: 50px;
            height: 50px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
            box-shadow: var(--shadow);
        }

        .theme-icon-dark,
        .theme-icon-light {
            position: absolute;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .theme-icon-dark {
            opacity: 1;
            transform: rotate(0deg) scale(1);
        }

        .theme-icon-light {
            opacity: 0;
            transform: rotate(-180deg) scale(0);
        }

        [data-theme="dark"] .theme-icon-dark,
        [data-theme="auto"] .theme-icon-dark {
            opacity: 0;
            transform: rotate(180deg) scale(0);
        }

        [data-theme="dark"] .theme-icon-light,
        [data-theme="auto"] .theme-icon-light {
            opacity: 1;
            transform: rotate(0deg) scale(1);
        }

        .theme-selector {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            padding: 8px;
            min-width: 200px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
        }

        .theme-selector.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .theme-option {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            padding: 12px 16px;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.2s ease;
            text-align: left;
        }

        .theme-option:hover {
            background: var(--bg-tertiary);
            transform: translateX(4px);
        }

        .theme-option.active {
            background: var(--primary-color);
            color: white;
        }

        .theme-option i {
            width: 16px;
            font-size: 16px;
            opacity: 0.8;
        }

        /* Theme transition animations */
        * {
            transition: background-color 0.3s ease, 
                       color 0.3s ease, 
                       border-color 0.3s ease,
                       box-shadow 0.3s ease;
        }

        /* Theme-aware glassmorphism effects */
        .navbar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
        }

        .tab-content {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        /* Enhanced dark mode specifics */
        [data-theme="dark"] body {
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
        }

        [data-theme="dark"] .input-form {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
        }

        [data-theme="dark"] input,
        [data-theme="dark"] textarea,
        [data-theme="dark"] select {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        [data-theme="dark"] input:focus,
        [data-theme="dark"] textarea:focus,
        [data-theme="dark"] select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* High contrast theme specifics */
        [data-theme="high-contrast"] button,
        [data-theme="high-contrast"] .nav-tab,
        [data-theme="high-contrast"] .type-btn {
            border: 2px solid var(--border-color) !important;
            font-weight: bold;
        }

        [data-theme="high-contrast"] .notification {
            border: 3px solid currentColor;
        }

        /* Viral Marketing & Social Sharing Styles */
        .viral-share-section {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-radius: 16px;
            padding: 24px;
            margin-top: 24px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        .viral-share-section h3 {
            color: var(--primary-color);
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .viral-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 24px;
            padding: 16px;
            background: var(--glass-bg);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .stat {
            text-align: center;
            flex: 1;
        }

        .stat-number {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .share-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .share-btn:hover::before {
            left: 100%;
        }

        .share-btn.twitter {
            background: #1DA1F2;
            color: white;
        }

        .share-btn.twitter:hover {
            background: #0d8bd9;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(29, 161, 242, 0.3);
        }

        .share-btn.facebook {
            background: #4267B2;
            color: white;
        }

        .share-btn.facebook:hover {
            background: #365899;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(66, 103, 178, 0.3);
        }

        .share-btn.linkedin {
            background: #0077B5;
            color: white;
        }

        .share-btn.linkedin:hover {
            background: #006399;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 119, 181, 0.3);
        }

        .share-btn.whatsapp {
            background: #25D366;
            color: white;
        }

        .share-btn.whatsapp:hover {
            background: #20ba5a;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.3);
        }

        .share-btn.native {
            background: var(--secondary-color);
            color: white;
        }

        .share-btn.native:hover {
            background: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .share-btn.copy-link {
            background: var(--accent-color);
            color: white;
        }

        .share-btn.copy-link:hover {
            background: #d97706;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
        }

        .viral-incentives {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .incentive-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .incentive-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.1);
        }

        .incentive-card i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 12px;
        }

        .incentive-card h4 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .incentive-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
        }

        /* Milestone Celebration */
        .milestone-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeInScale 0.5s ease;
        }

        .milestone-content {
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: bounceIn 0.6s ease;
        }

        .milestone-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: rotate 2s ease-in-out infinite;
        }

        .milestone-content h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 16px;
        }

        .milestone-content p {
            color: var(--text-primary);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        /* Campaign Banner */
        .campaign-banner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 12px 20px;
            z-index: 9999;
            animation: slideDownBounce 0.6s ease;
        }

        .campaign-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }

        .campaign-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .campaign-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Animations */
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3) rotate(-10deg); }
            50% { transform: scale(1.05) rotate(2deg); }
            70% { transform: scale(0.9) rotate(-1deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        @keyframes rotate {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(10deg) scale(1.1); }
        }

        @keyframes slideDownBounce {
            0% { transform: translateY(-100%); }
            60% { transform: translateY(10px); }
            80% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .share-buttons {
                grid-template-columns: 1fr;
            }
            
            .viral-stats {
                flex-direction: column;
                gap: 12px;
            }
            
            .incentive-card {
                padding: 16px;
            }
            
            .milestone-content {
                margin: 20px;
                padding: 30px 20px;
            }
        }

        /* Enhanced Button States */
        button:disabled,
        input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        button:disabled:focus,
        input:disabled:focus {
            outline: 3px solid var(--error-color);
        }

        /* Loading State Accessibility */
        .loading {
            position: relative;
        }

        .loading::after {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.8);
            pointer-events: none;
        }

        .loading[aria-label]::before {
            content: attr(aria-label);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Analytics Dashboard */
        .analytics-dashboard {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        /* AdSense Optimization Styles */
        .adsense-container {
            transition: transform 0.2s ease, opacity 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .adsense-container:hover {
            transform: translateY(-2px);
            border-color: rgba(255,255,255,0.2);
        }

        .adsbygoogle {
            border-radius: 8px;
            overflow: hidden;
        }

        /* Enhanced Responsive AdSense */
        @media (max-width: 768px) {
            .adsense-container .adsbygoogle[style*="728px"] {
                display: inline-block !important;
                width: 320px !important;
                height: 100px !important;
            }
            
            .adsense-container .adsbygoogle[style*="300px"] {
                width: 250px !important;
                height: 250px !important;
            }
            
            /* Mobile Navigation Optimization */
            .nav-container {
                padding: 0 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-tabs {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .nav-tab {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
                min-width: 80px;
                text-align: center;
            }
            
            /* Generator Grid Mobile Optimization */
            .generator-grid {
                grid-template-columns: 1fr !important;
                gap: 1.5rem;
            }
            
            .type-selector {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.75rem;
            }
            
            .type-btn {
                padding: 0.75rem 0.5rem;
                font-size: 0.8rem;
            }
            
            .type-btn span {
                font-size: 0.75rem;
            }
            
            /* Input Forms Mobile */
            .input-forms {
                padding: 1rem;
            }
            
            /* Controls Mobile */
            .customization-controls {
                grid-template-columns: 1fr !important;
            }
            
            .control-group {
                margin-bottom: 1rem;
            }
        }

        @media (max-width: 480px) {
            .adsense-container {
                margin: 15px 0 !important;
                padding: 10px !important;
            }
            
            .adsense-container .adsbygoogle[style*="250px"] {
                width: 200px !important;
                height: 200px !important;
            }
            
            /* Ultra Mobile Optimization */
            .container {
                padding: 0.5rem !important;
                margin: 0.5rem !important;
            }
            
            .tab-header h1 {
                font-size: 1.5rem;
            }
            
            .tab-header p {
                font-size: 0.9rem;
            }
            
            .type-selector {
                grid-template-columns: 1fr 1fr !important;
                gap: 0.5rem;
            }
            
            .type-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.7rem;
            }
            
            .type-btn i {
                font-size: 1rem;
                margin-bottom: 0.3rem;
            }
            
            /* Single Column Layout for Small Screens */
            .analytics-grid,
            .history-list,
            .template-grid {
                grid-template-columns: 1fr !important;
            }
            
            .stat-card {
                padding: 1rem;
                text-align: center;
            }
            
            .stat-number {
                font-size: 1.8rem;
            }
            
            /* Action Buttons Mobile */
            .qr-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Performance Critical CSS Optimizations */
        
        /* Lazy Loading Images */
        img[data-lazy] {
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        img[data-lazy].loaded {
            opacity: 1;
        }
        
        /* Critical Above-the-fold Styles */
        .navbar,
        .nav-container,
        .nav-logo,
        .container,
        .generator-grid,
        .type-selector,
        .type-btn {
            /* Critical styles already defined above */
        }
        
        /* Non-critical styles with lazy loading */
        @media (min-width: 769px) {
            /* Desktop optimizations */
            .generator-grid {
                grid-template-columns: 2fr 1fr;
                gap: 2rem;
            }
            
            .type-selector {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .customization-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* Desktop AdSense positioning */
            .adsense-container {
                position: relative;
                z-index: 1;
            }
            
            .adsense-container:nth-child(2) {
                position: sticky;
                top: 20px;
            }
        }
        
        /* Print Styles */
        @media print {
            .navbar,
            .adsense-container,
            .qr-actions,
            .nav-tabs {
                display: none !important;
            }
            
            .container {
                margin: 0;
                padding: 0;
                background: white;
            }
            
            #qr-display {
                page-break-inside: avoid;
            }
        }
        
        /* Dark Mode Optimizations */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #1F2937;
                --bg-secondary: #111827;
                --text-primary: #F9FAFB;
                --text-secondary: #D1D5DB;
                --border-color: #374151;
            }
            
            body {
                background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            }
            
            .adsense-container {
                background: rgba(0,0,0,0.2) !important;
            }
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Live Tracking Dashboard Styles */
        .analytics-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #10B981;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
            margin-left: 0.5rem;
        }
        
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .live-metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .live-metric-card {
            background: linear-gradient(135deg, rgba(67, 56, 202, 0.1), rgba(16, 185, 129, 0.1));
            border: 1px solid rgba(67, 56, 202, 0.2);
            border-radius: 12px;
            padding: 1.5rem 1rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .live-metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(67, 56, 202, 0.15);
        }
        
        .live-metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .live-metric-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .live-metric-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .analytics-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .analytics-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .analytics-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(67, 56, 202, 0.3);
        }
        
        .analytics-btn.export {
            background: linear-gradient(135deg, var(--success-color), #059669);
        }
        
        .analytics-btn.reset {
            background: linear-gradient(135deg, var(--error-color), #DC2626);
        }
        
        .analytics-info {
            background: rgba(67, 56, 202, 0.05);
            border: 1px solid rgba(67, 56, 202, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1.5rem;
        }
        
        .analytics-info p {
            margin: 0.5rem 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .analytics-info i {
            color: var(--primary-color);
            margin-right: 0.5rem;
        }
        
        /* Revenue Potential Styles */
        .revenue-info {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .revenue-estimates {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .estimate-card {
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            transition: transform 0.2s ease;
        }
        
        .estimate-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
        }
        
        .estimate-traffic {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .estimate-revenue {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--success-color);
        }
        
        .sheets-setup {
            background: rgba(67, 56, 202, 0.05);
            border: 1px solid rgba(67, 56, 202, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .setup-steps {
            margin-top: 1rem;
        }
        
        .setup-steps p {
            margin-bottom: 0.8rem;
            color: var(--text-secondary);
        }
        
        .setup-steps strong {
            color: var(--primary-color);
        }
        
        .setup-steps code {
            background: rgba(0, 0, 0, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }
        
        .setup-steps a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }
        
        .setup-steps a:hover {
            text-decoration: underline;
        }
        
        /* Mobile optimization for live tracking */
        @media (max-width: 768px) {
            .live-metrics-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.8rem;
            }
            
            .live-metric-card {
                padding: 1rem 0.8rem;
            }
            
            .live-metric-number {
                font-size: 1.5rem;
            }
            
            .sync-controls {
                flex-direction: column;
                gap: 0.8rem;
            }
            
            .sync-btn, .report-btn, .copy-code-btn {
                justify-content: center;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .live-metrics-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Conversion Popup Styles */
        .conversion-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .popup-content {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            animation: popupSlide 0.4s ease;
        }
        
        @keyframes popupSlide {
            from { 
                transform: translateY(-50px) scale(0.9);
                opacity: 0;
            }
            to { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .popup-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #999;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .popup-close:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #EF4444;
        }
        
        .popup-header h3 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }
        
        .popup-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .popup-features {
            margin: 2rem 0;
            text-align: left;
        }
        
        .popup-feature {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 0.8rem;
            background: rgba(67, 56, 202, 0.05);
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
        }
        
        .popup-feature i {
            color: var(--primary-color);
            font-size: 1.2rem;
            width: 20px;
        }
        
        .popup-invite {
            margin-bottom: 1.5rem;
        }
        
        .popup-invite strong {
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .share-buttons {
            display: flex;
            gap: 0.8rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }
        
        .share-btn.twitter {
            background: #1DA1F2;
            color: white;
        }
        
        .share-btn.linkedin {
            background: #0077B5;
            color: white;
        }
        
        .share-btn.whatsapp {
            background: #25D366;
            color: white;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        /* Exit Intent Popup Specific Styles */
        .exit-intent {
            border: 3px solid #EF4444;
        }
        
        .exit-benefits {
            text-align: left;
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: rgba(16, 185, 129, 0.05);
            border-radius: 12px;
        }
        
        .exit-benefits h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .exit-benefits ul {
            list-style: none;
            padding: 0;
        }
        
        .exit-benefits li {
            margin-bottom: 0.8rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .exit-cta-btn {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            padding: 1.2rem 2rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-width: 250px;
        }
        
        .exit-cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }
        
        .exit-guarantee {
            color: var(--text-secondary);
            font-style: italic;
            margin-top: 1rem;
        }
        
        /* Mobile Popup Optimization */
        @media (max-width: 768px) {
            .popup-content {
                padding: 2rem 1.5rem;
                width: 95%;
            }
            
            .popup-header h3 {
                font-size: 1.5rem;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .share-btn {
                justify-content: center;
                width: 100%;
            }
            
            .exit-cta-btn {
                width: 100%;
            }
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e1e5e9;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        /* QR Templates */
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .template-card {
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.1);
        }

        .template-card.selected {
            border-color: var(--primary-color);
            background: rgba(79, 70, 229, 0.05);
        }

        .template-preview {
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .template-name {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        /* Advanced Customization */
        .advanced-controls {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .gradient-picker {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
        }

        .gradient-stop {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logo-upload {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .logo-preview {
            width: 60px;
            height: 60px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .logo-preview img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 6px;
        }

        /* Export Options */
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .export-btn {
            padding: 8px 16px;
            border: 1px solid var(--primary-color);
            background: white;
            color: var(--primary-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .export-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Social Share */
        .share-options {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .share-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .share-btn:hover {
            transform: scale(1.1);
        }

        .share-btn.twitter {
            background: #1da1f2;
        }

        .share-btn.whatsapp {
            background: #25d366;
        }

        .share-btn.facebook {
            background: #4267b2;
        }

        .share-btn.telegram {
            background: #0088cc;
        }

        /* Enhanced Batch Processing */
        .batch-options {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }

        .input-method-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            border-bottom: 2px solid #e1e5e9;
        }

        .method-tab {
            padding: 10px 15px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .method-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .method-tab:hover {
            background: rgba(79, 70, 229, 0.05);
        }

        .input-method {
            display: none;
        }

        .input-method.active {
            display: block;
        }

        .batch-settings {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
        }

        .setting-group {
            margin-bottom: 15px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .setting-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .batch-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .batch-progress {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e1e5e9;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .progress-text {
            font-weight: 500;
            color: var(--text-dark);
        }

        .file-preview, .csv-preview {
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .csv-options {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
        }

        /* Enhanced Scanner */
        .scanner-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .scanner-options {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            margin-bottom: 20px;
            align-items: center;
        }

        .scanner-modes {
            display: flex;
            gap: 5px;
        }

        .scanner-mode-btn {
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            background: white;
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .scanner-mode-btn.active {
            border-color: var(--primary-color);
            background: rgba(79, 70, 229, 0.05);
            color: var(--primary-color);
        }

        .scanner-mode-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .scanner-settings {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
        }

        .scanner-settings label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .scanner-mode {
            display: none;
        }

        .scanner-mode.active {
            display: block;
        }

        .video-container {
            position: relative;
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .scanner-overlay {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            height: 300px;
            pointer-events: none;
        }

        .scanner-frame {
            width: 200px;
            height: 200px;
            border: 3px solid var(--primary-color);
            border-radius: 12px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 0 9999px rgba(0,0,0,0.5);
        }

        .scanner-line {
            width: 180px;
            height: 2px;
            background: var(--primary-color);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateX(-50%);
            animation: scan-line 2s infinite;
            box-shadow: 0 0 10px var(--primary-color);
        }

        @keyframes scan-line {
            0%, 100% { top: calc(50% - 90px); opacity: 0; }
            10%, 90% { opacity: 1; }
            50% { top: calc(50% + 90px); }
        }

        .scanner-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .file-drop-zone {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            background: #fafafa;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
        }

        .file-drop-zone:hover, .file-drop-zone.dragover {
            border-color: var(--primary-color);
            background: rgba(79, 70, 229, 0.05);
        }

        .url-scanner {
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin: 20px 0;
        }

        .scanner-result {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 2px dashed #e1e5e9;
        }

        .scanner-result.has-result {
            border-color: var(--success-color);
            background: rgba(16, 185, 129, 0.05);
        }

        .scanned-data {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            word-break: break-all;
            min-height: 40px;
            border: 1px solid #e1e5e9;
        }

        .scanner-result-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .scan-history {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .scan-history-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .scan-history-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .scan-history-item:hover {
            background: #e9ecef;
        }

        .scan-timestamp {
            color: #666;
            font-size: 0.8rem;
        }

        #video {
            width: 100%;
            max-width: 400px;
            height: 300px;
            border-radius: 12px;
            background: #000;
        }

        #video.active {
            display: block;
        }

        /* Premium Plans Styling */
        .premium-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
            padding: 20px 0;
        }

        .plan-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
        }

        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .pro-plan {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-color)08, transparent);
        }

        .enterprise-plan {
            border-color: #F59E0B;
            background: linear-gradient(135deg, #F59E0B08, transparent);
        }

        .plan-badge {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-color);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .plan-header h3 {
            margin: 0 0 10px 0;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1.4em;
        }

        .plan-price {
            font-size: 2.5em;
            font-weight: 800;
            color: var(--primary-color);
            margin: 15px 0;
            line-height: 1;
        }

        .plan-price span {
            font-size: 0.4em;
            font-weight: 400;
            color: var(--text-secondary);
            vertical-align: middle;
        }

        .plan-features {
            list-style: none;
            padding: 0;
            margin: 20px 0;
            text-align: left;
        }

        .plan-features li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            color: var(--text-primary);
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        .plan-features li i {
            color: var(--success-color);
            width: 16px;
            flex-shrink: 0;
        }

        .plan-btn {
            width: 100%;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .free-btn {
            background: var(--border-color);
            color: var(--text-secondary);
        }

        .pro-btn {
            background: var(--primary-color);
            color: white;
        }

        .enterprise-btn {
            background: #F59E0B;
            color: white;
        }

        .plan-btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .plan-btn:disabled {
            background: var(--success-color);
            cursor: not-allowed;
            transform: none;
            opacity: 0.7;
        }

        /* Premium Features Showcase */
        .premium-showcase {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-color)05, var(--secondary-color)05);
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .showcase-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .showcase-header h3 {
            font-size: 2em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .showcase-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }

        .feature-card i {
            font-size: 2.5em;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: block;
        }

        .feature-card h4 {
            margin: 0 0 10px 0;
            color: var(--text-primary);
            font-size: 1.2em;
        }

        .feature-card p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }

        /* Premium Modal */
        .premium-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .premium-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .premium-modal h3 {
            margin-top: 0;
            color: var(--primary-color);
            text-align: center;
        }

        .premium-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .premium-close:hover {
            color: var(--error-color);
        }

        /* Premium Showcase Components */
        .showcase-item {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            text-align: center;
        }

        .showcase-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: var(--primary-color);
        }

        .showcase-icon {
            font-size: 3em;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .showcase-item h4 {
            margin: 0 0 15px 0;
            color: var(--text-primary);
            font-size: 1.3em;
            font-weight: 600;
        }

        .showcase-item p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .preview-sample {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .qr-sample {
            position: relative;
            font-size: 2em;
            color: #333;
        }

        .logo-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.3em;
            border: 1px solid #ddd;
        }

        .bulk-preview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            align-items: center;
        }

        .mini-qr {
            width: 30px;
            height: 30px;
            background: #333;
            border-radius: 3px;
            position: relative;
        }

        .mini-qr::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 6px;
            height: 6px;
            background: white;
        }

        .more-indicator {
            background: var(--primary-color);
            color: white;
            padding: 5px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .analytics-preview {
            display: flex;
            align-items: end;
            justify-content: center;
            gap: 5px;
            height: 40px;
        }

        .chart-bar {
            width: 12px;
            height: 100%;
            background: linear-gradient(to top, var(--primary-color), var(--secondary-color));
            border-radius: 2px;
            opacity: 0.8;
        }

        .api-preview {
            background: #1a1a1a;
            color: #00ff00;
            padding: 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
            text-align: left;
        }

        .api-response {
            margin-top: 5px;
            color: #ffff00;
        }

        /* Guarantee Section */
        .guarantee-section {
            margin-top: 40px;
            text-align: center;
        }

        .guarantee-box {
            background: linear-gradient(135deg, var(--success-color)10, transparent);
            border: 2px solid var(--success-color);
            border-radius: 15px;
            padding: 30px;
            display: inline-block;
            max-width: 500px;
        }

        .guarantee-box i {
            font-size: 3em;
            color: var(--success-color);
            margin-bottom: 15px;
        }

        .guarantee-box h3 {
            margin: 0 0 15px 0;
            color: var(--success-color);
            font-size: 1.5em;
        }

        .guarantee-box p {
            margin: 0;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* QR Code Enhancements */
        .qr-enhancement-options {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .enhancement-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .enhancement-tab {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 6px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .enhancement-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .enhancement-content {
            display: none;
        }

        .enhancement-content.active {
            display: block;
        }

        /* Responsive Design Improvements */
        @media (max-width: 768px) {
            .batch-options {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .input-method-tabs {
                flex-wrap: wrap;
            }

            .method-tab {
                flex: 1;
                min-width: 120px;
                text-align: center;
            }

            .batch-controls {
                flex-wrap: wrap;
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .template-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            /* Premium Responsive Design */
            .premium-plans {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .plan-card {
                padding: 20px 15px;
            }
            
            .plan-price {
                font-size: 2em;
            }
            
            .showcase-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .premium-modal-content {
                padding: 20px;
                width: 95%;
            }
        }

        /* Loading Animation */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { left: -100%; }
            100% { left: 100%; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-qrcode"></i>
                <span>QR Generator Pro</span>
            </div>
            
            <!-- Theme Controls -->
            <div class="theme-controls">
                <button class="theme-toggle" id="theme-toggle" 
                        title="Tema değiştir" 
                        aria-label="Dark/Light mode toggle">
                    <i class="fas fa-moon theme-icon-dark"></i>
                    <i class="fas fa-sun theme-icon-light"></i>
                </button>
                <div class="theme-selector" id="theme-selector">
                    <button class="theme-option" data-theme="light" title="Açık tema">
                        <i class="fas fa-sun"></i> <span>Açık</span>
                    </button>
                    <button class="theme-option" data-theme="dark" title="Koyu tema">
                        <i class="fas fa-moon"></i> <span>Koyu</span>
                    </button>
                    <button class="theme-option" data-theme="auto" title="Sistem teması">
                        <i class="fas fa-adjust"></i> <span>Otomatik</span>
                    </button>
                    <button class="theme-option" data-theme="high-contrast" title="Yüksek kontrast">
                        <i class="fas fa-eye"></i> <span>Kontrast</span>
                    </button>
                </div>
            </div>
            <!-- Enhanced Navigation with Accessibility -->
            <nav class="nav-tabs" role="tablist" aria-label="Ana navigasyon sekmeleri">
                <button class="nav-tab active" data-tab="generator" role="tab" aria-selected="true" aria-controls="generator-panel" id="generator-tab" tabindex="0">
                    <i class="fas fa-magic" aria-hidden="true"></i> 
                    <span>QR Generator</span>
                </button>
                <button class="nav-tab" data-tab="scanner" role="tab" aria-selected="false" aria-controls="scanner-panel" id="scanner-tab" tabindex="-1">
                    <i class="fas fa-camera" aria-hidden="true"></i> 
                    <span>QR Tarayıcı</span>
                </button>
                <button class="nav-tab" data-tab="batch" role="tab" aria-selected="false" aria-controls="batch-panel" id="batch-tab" tabindex="-1">
                    <i class="fas fa-layer-group" aria-hidden="true"></i> 
                    <span>Toplu Üretim</span>
                </button>
                <button class="nav-tab" data-tab="history" role="tab" aria-selected="false" aria-controls="history-panel" id="history-tab" tabindex="-1">
                    <i class="fas fa-history" aria-hidden="true"></i> 
                    <span>Geçmiş</span>
                </button>
                <button class="nav-tab" data-tab="analytics" role="tab" aria-selected="false" aria-controls="analytics-panel" id="analytics-tab" tabindex="-1">
                    <i class="fas fa-chart-bar" aria-hidden="true"></i> 
                    <span>İstatistikler</span>
                </button>
                <button class="nav-tab" data-tab="templates" role="tab" aria-selected="false" aria-controls="templates-panel" id="templates-tab" tabindex="-1">
                    <i class="fas fa-palette" aria-hidden="true"></i> 
                    <span>Tasarım Şablonları</span>
                </button>
            </nav>
            
            <!-- Accessibility: Skip Navigation -->
            <a href="#main-content" class="skip-link">Ana içeriğe geç</a>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="mobile-nav">
        <select id="mobile-tab-select">
            <option value="generator">QR Generator</option>
            <option value="scanner">QR Tarayıcı</option>
            <option value="batch">Toplu Üretim</option>
            <option value="history">Geçmiş</option>
            <option value="analytics">Analitik</option>
            <option value="templates">Şablonlar</option>
        </select>
    </div>

    <div class="container">
        <!-- Generator Tab -->
        <div class="tab-content active" id="generator-tab">
            <div class="tab-header">
                <h1><i class="fas fa-magic"></i> QR Kod Generator</h1>
                <p>Gelişmiş özelliklerle profesyonel QR kodları oluşturun</p>
            </div>
            
            <div class="generator-grid">
                <div class="input-section">
                    <div class="type-selector">
                        <button class="type-btn active" data-type="text">
                            <i class="fas fa-font"></i>
                            <span>Metin</span>
                        </button>
                        <button class="type-btn" data-type="url">
                            <i class="fas fa-link"></i>
                            <span>URL</span>
                        </button>
                        <button class="type-btn" data-type="wifi">
                            <i class="fas fa-wifi"></i>
                            <span>WiFi</span>
                        </button>
                        <button class="type-btn" data-type="phone">
                            <i class="fas fa-phone"></i>
                            <span>Telefon</span>
                        </button>
                        <button class="type-btn" data-type="email">
                            <i class="fas fa-envelope"></i>
                            <span>E-posta</span>
                        </button>
                        <button class="type-btn" data-type="sms">
                            <i class="fas fa-comment"></i>
                            <span>SMS</span>
                        </button>
                        <button class="type-btn" data-type="vcard">
                            <i class="fas fa-address-card"></i>
                            <span>vCard</span>
                        </button>
                        <button class="type-btn" data-type="event">
                            <i class="fas fa-calendar"></i>
                            <span>Etkinlik</span>
                        </button>
                        <button class="type-btn" data-type="crypto">
                            <i class="fab fa-bitcoin"></i>
                            <span>Crypto</span>
                        </button>
                        <button class="type-btn" data-type="geolocation">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Konum</span>
                        </button>
                        <button class="type-btn" data-type="social">
                            <i class="fab fa-instagram"></i>
                            <span>Sosyal Medya</span>
                        </button>
                        <button class="type-btn" data-type="app">
                            <i class="fas fa-mobile-alt"></i>
                            <span>Uygulama</span>
                        </button>
                        <button class="type-btn" data-type="meeting">
                            <i class="fas fa-video"></i>
                            <span>Toplantı</span>
                        </button>
                    </div>

                    <div class="input-forms">
                        <!-- Text Input -->
                        <div class="input-form active" data-form="text">
                            <label for="text-input">Metninizi girin:</label>
                            <textarea id="text-input" placeholder="Buraya metninizi yazın..." rows="4"></textarea>
                        </div>

                        <!-- URL Input -->
                        <div class="input-form" data-form="url">
                            <label for="url-input">Website URL'si:</label>
                            <input type="url" id="url-input" placeholder="https://example.com">
                        </div>

                        <!-- WiFi Input -->
                        <div class="input-form" data-form="wifi">
                            <label for="wifi-ssid">WiFi Ağ Adı (SSID):</label>
                            <input type="text" id="wifi-ssid" placeholder="WiFi ağ adı">
                            
                            <label for="wifi-password">Şifre:</label>
                            <input type="password" id="wifi-password" placeholder="WiFi şifresi">
                            
                            <label for="wifi-security">Güvenlik:</label>
                            <select id="wifi-security">
                                <option value="WPA">WPA/WPA2</option>
                                <option value="WEP">WEP</option>
                                <option value="nopass">Şifresiz</option>
                            </select>
                        </div>

                        <!-- Phone Input -->
                        <div class="input-form" data-form="phone">
                            <label for="phone-input">Telefon Numarası:</label>
                            <input type="tel" id="phone-input" placeholder="+90 555 123 45 67">
                        </div>

                        <!-- Email Input -->
                        <div class="input-form" data-form="email">
                            <label for="email-input">E-posta Adresi:</label>
                            <input type="email" id="email-input" placeholder="email@example.com">
                            
                            <label for="email-subject">Konu:</label>
                            <input type="text" id="email-subject" placeholder="E-posta konusu">
                            
                            <label for="email-body">Mesaj:</label>
                            <textarea id="email-body" placeholder="E-posta mesajı..." rows="3"></textarea>
                        </div>

                        <!-- SMS Input -->
                        <div class="input-form" data-form="sms">
                            <label for="sms-phone">Telefon Numarası:</label>
                            <input type="tel" id="sms-phone" placeholder="+90 555 123 45 67">
                            
                            <label for="sms-message">Mesaj:</label>
                            <textarea id="sms-message" placeholder="SMS mesajınız..." rows="3"></textarea>
                        </div>

                        <!-- vCard Input -->
                        <div class="input-form" data-form="vcard">
                            <label for="vcard-name">Ad Soyad:</label>
                            <input type="text" id="vcard-name" placeholder="Ahmet Yılmaz">
                            
                            <label for="vcard-phone">Telefon:</label>
                            <input type="tel" id="vcard-phone" placeholder="+90 555 123 45 67">
                            
                            <label for="vcard-email">E-posta:</label>
                            <input type="email" id="vcard-email" placeholder="ahmet@example.com">
                            
                            <label for="vcard-company">Şirket:</label>
                            <input type="text" id="vcard-company" placeholder="ABC Şirketi">
                        </div>

                        <!-- Event Input -->
                        <div class="input-form" data-form="event">
                            <label for="event-title">Etkinlik Adı:</label>
                            <input type="text" id="event-title" placeholder="Toplantı">
                            
                            <label for="event-date">Tarih:</label>
                            <input type="datetime-local" id="event-date">
                            
                            <label for="event-location">Konum:</label>
                            <input type="text" id="event-location" placeholder="İstanbul">
                            
                            <label for="event-description">Açıklama:</label>
                            <textarea id="event-description" placeholder="Etkinlik açıklaması..." rows="3"></textarea>
                        </div>

                        <!-- Crypto Input -->
                        <div class="input-form" data-form="crypto">
                            <label for="crypto-type">Kripto Para:</label>
                            <select id="crypto-type">
                                <option value="bitcoin">Bitcoin (BTC)</option>
                                <option value="ethereum">Ethereum (ETH)</option>
                                <option value="litecoin">Litecoin (LTC)</option>
                            </select>
                            
                            <label for="crypto-address">Cüzdan Adresi:</label>
                            <input type="text" id="crypto-address" placeholder="Cüzdan adresi">
                            
                            <label for="crypto-amount">Miktar (İsteğe bağlı):</label>
                            <input type="number" id="crypto-amount" placeholder="0.001" step="0.000001">
                        </div>

                        <!-- Geolocation Input -->
                        <div class="input-form" data-form="geolocation">
                            <label for="geo-lat">Enlem (Latitude):</label>
                            <input type="number" id="geo-lat" placeholder="41.0082" step="0.000001" min="-90" max="90">
                            
                            <label for="geo-lng">Boylam (Longitude):</label>
                            <input type="number" id="geo-lng" placeholder="28.9784" step="0.000001" min="-180" max="180">
                            
                            <label for="geo-label">Konum Etiketi (İsteğe bağlı):</label>
                            <input type="text" id="geo-label" placeholder="İstanbul, Türkiye">

                            <div class="geo-actions" style="display: flex; gap: 10px; margin-top: 15px;">
                                <button type="button" class="btn-secondary" onclick="qrApp.getCurrentLocation()" style="flex: 1;">
                                    <i class="fas fa-location-arrow"></i> Mevcut Konum
                                </button>
                                <button type="button" class="btn-secondary" onclick="qrApp.showLocationHelp()" style="flex: 1;">
                                    <i class="fas fa-question-circle"></i> Yardım
                                </button>
                            </div>
                        </div>

                        <!-- Social Media Input -->
                        <div class="input-form" data-form="social">
                            <label for="social-platform">Platform:</label>
                            <select id="social-platform" onchange="qrApp.updateSocialPreview()">
                                <option value="instagram">Instagram</option>
                                <option value="twitter">Twitter</option>
                                <option value="facebook">Facebook</option>
                                <option value="linkedin">LinkedIn</option>
                                <option value="youtube">YouTube</option>
                                <option value="tiktok">TikTok</option>
                                <option value="whatsapp">WhatsApp</option>
                            </select>
                            
                            <label for="social-username">Kullanıcı Adı/ID:</label>
                            <input type="text" id="social-username" placeholder="kullanici_adi" oninput="qrApp.updateSocialPreview()">
                            
                            <div class="social-preview" id="social-preview" style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px; font-size: 14px; color: #666;"></div>
                        </div>

                        <!-- App Store Input -->
                        <div class="input-form" data-form="app">
                            <label for="app-store">Mağaza:</label>
                            <select id="app-store" onchange="qrApp.updateAppPreview()">
                                <option value="ios">App Store (iOS)</option>
                                <option value="android">Google Play (Android)</option>
                                <option value="huawei">AppGallery (Huawei)</option>
                            </select>
                            
                            <label for="app-id">Uygulama ID/Package Name:</label>
                            <input type="text" id="app-id" placeholder="com.example.app veya 123456789" oninput="qrApp.updateAppPreview()">
                            
                            <div class="app-preview" id="app-preview" style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px; font-size: 14px; color: #666;"></div>
                        </div>

                        <!-- Meeting/Conference Input -->
                        <div class="input-form" data-form="meeting">
                            <label for="meeting-platform">Platform:</label>
                            <select id="meeting-platform" onchange="qrApp.updateMeetingForm()">
                                <option value="zoom">Zoom</option>
                                <option value="teams">Microsoft Teams</option>
                                <option value="meet">Google Meet</option>
                                <option value="webex">Webex</option>
                            </select>
                            
                            <label for="meeting-url">Toplantı URL'si:</label>
                            <input type="url" id="meeting-url" placeholder="https://zoom.us/j/123456789">
                            
                            <label for="meeting-id">Meeting ID (İsteğe bağlı):</label>
                            <input type="text" id="meeting-id" placeholder="123 456 7890">
                            
                            <label for="meeting-password">Şifre (İsteğe bağlı):</label>
                            <input type="text" id="meeting-password" placeholder="toplanti123">
                        </div>
                    </div>

                    <!-- Customization Section -->
                    <div class="customization-section">
                        <h3><i class="fas fa-palette"></i> Özelleştirme</h3>
                        
                        <!-- Enhanced Color Controls -->
                        <div class="color-controls-section">
                            <div class="color-mode-selector">
                                <label>Renk Modu:</label>
                                <select id="color-mode" onchange="qrApp.updateColorMode(this.value)">
                                    <option value="solid">Düz Renk</option>
                                    <option value="gradient">Gradyan</option>
                                    <option value="pattern">Desen</option>
                                </select>
                            </div>

                            <!-- Solid Color Mode -->
                            <div class="color-picker-group" id="solid-color-controls">
                                <div class="color-picker">
                                    <label>Ön Renk:</label>
                                    <input type="color" id="color-dark" value="#1F2937">
                                </div>
                                <div class="color-picker">
                                    <label>Arka Renk:</label>
                                    <input type="color" id="color-light" value="#FFFFFF">
                                </div>
                            </div>

                            <!-- Gradient Mode -->
                            <div class="gradient-controls" id="gradient-controls" style="display: none;">
                                <div class="color-picker">
                                    <label>Başlangıç Rengi:</label>
                                    <input type="color" id="gradient-start" value="#4F46E5">
                                </div>
                                <div class="color-picker">
                                    <label>Bitiş Rengi:</label>
                                    <input type="color" id="gradient-end" value="#06B6D4">
                                </div>
                                <div class="gradient-direction">
                                    <label>Yön:</label>
                                    <select id="gradient-direction">
                                        <option value="diagonal">Çapraz</option>
                                        <option value="horizontal">Yatay</option>
                                        <option value="vertical">Dikey</option>
                                        <option value="radial">Radyal</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Pattern Mode -->
                            <div class="pattern-controls" id="pattern-controls" style="display: none;">
                                <div class="pattern-selector">
                                    <label>Desen Türü:</label>
                                    <select id="pattern-type">
                                        <option value="dots">Nokta</option>
                                        <option value="rounded">Yuvarlatılmış</option>
                                        <option value="square">Kare</option>
                                        <option value="circle">Daire</option>
                                    </select>
                                </div>
                                <div class="color-picker">
                                    <label>Desen Rengi:</label>
                                    <input type="color" id="pattern-color" value="#1F2937">
                                </div>
                                <div class="color-picker">
                                    <label>Arkaplan Rengi:</label>
                                    <input type="color" id="pattern-bg" value="#FFFFFF">
                                </div>
                            </div>
                        </div>
                        
                        <div class="size-slider">
                            <label>QR Kod Boyutu: <span id="size-value">256px</span></label>
                            <input type="range" id="qr-size" min="128" max="512" value="256">
                        </div>
                        
                        <div class="size-slider">
                            <label>Hata Düzeltme: <span id="error-level-text">Orta</span></label>
                            <select id="error-level">
                                <option value="L">Düşük (%7)</option>
                                <option value="M" selected>Orta (%15)</option>
                                <option value="Q">Yüksek (%25)</option>
                                <option value="H">En Yüksek (%30)</option>
                            </select>
                        </div>

                        <!-- Advanced Customization -->
                        <div class="advanced-controls">
                            <h3>🎨 Gelişmiş Özelleştirme</h3>
                            
                            <div class="control-group">
                                <label>
                                    <input type="checkbox" id="use-gradient"> Gradient Renk Kullan
                                </label>
                                <div class="gradient-picker" id="gradient-controls" style="display: none;">
                                    <div class="gradient-stop">
                                        <label>Başlangıç:</label>
                                        <input type="color" id="gradient-start" value="#667eea">
                                    </div>
                                    <div class="gradient-stop">
                                        <label>Bitiş:</label>
                                        <input type="color" id="gradient-end" value="#764ba2">
                                    </div>
                                </div>
                            </div>

                            <div class="control-group">
                                <label>Logo Ekle:</label>
                                <div class="logo-upload">
                                    <input type="file" id="logo-upload" accept="image/*" style="display: none;">
                                    <div class="logo-preview" id="logo-preview" onclick="document.getElementById('logo-upload').click()">
                                        <i class="fas fa-plus"></i>
                                    </div>
                                    <button type="button" onclick="document.getElementById('logo-upload').click()" class="action-btn secondary">
                                        Logo Seç
                                    </button>
                                </div>
                            </div>

                            <div class="control-group">
                                <label>QR Köşe Stili:</label>
                                <select id="corner-style">
                                    <option value="square">Kare</option>
                                    <option value="rounded">Yuvarlaklı</option>
                                    <option value="extra-rounded">Çok Yuvarlaklı</option>
                                    <option value="circle">Daire</option>
                                </select>
                            </div>

                            <div class="control-group">
                                <label>Kenar Boşluğu:</label>
                                <input type="range" id="margin-size" min="0" max="50" value="20">
                                <span id="margin-value">20px</span>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced CTA with urgency and value proposition -->
                    <div class="cta-container">
                        <button id="generate-btn" class="generate-btn enhanced-cta">
                            <i class="fas fa-magic"></i> 
                            <span class="cta-main">ÜCRETSIZ QR Kod Oluştur</span>
                            <span class="cta-sub">✨ 30 saniyede hazır • AI optimizasyonlu</span>
                        </button>
                        
                        <div class="cta-features">
                            <span class="feature-badge">🚀 Anında Hazır</span>
                            <span class="feature-badge">📱 Mobil Uyumlu</span>
                            <span class="feature-badge">🔒 %100 Güvenli</span>
                        </div>
                        
                        <p class="cta-guarantee">
                            <i class="fas fa-check-circle" style="color: #10B981;"></i>
                            1M+ kullanıcının güvendiği platform
                        </p>
                    </div>
                </div>

                <!-- Strategic AdSense Placement #1 - Above the fold, high visibility -->
                <div class="adsense-container" style="text-align: center; margin: 20px 0; padding: 10px;">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="pub-9023802833968711"
                         data-ad-slot="1234567890"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div class="output-section">
                    <div id="qr-display">
                        <div class="qr-placeholder">
                            <i class="fas fa-qrcode"></i>
                            <p>QR kodunuz burada görünecek</p>
                        </div>
                    </div>
                    
                    <div class="qr-actions hidden" id="qr-actions">
                        <button id="download-btn" class="action-btn">
                            <i class="fas fa-download"></i> İndir
                        </button>
                        <button id="copy-btn" class="action-btn">
                            <i class="fas fa-copy"></i> Kopyala
                        </button>
                        <button id="save-btn" class="action-btn">
                            <i class="fas fa-save"></i> Kaydet
                        </button>
                        <button id="new-btn" class="action-btn secondary">
                            <i class="fas fa-plus"></i> Yeni
                        </button>
                        
                        <!-- Export Options -->
                        <div class="export-options">
                            <button class="export-btn" onclick="app.exportAs('png')">
                                <i class="fas fa-image"></i> PNG
                            </button>
                            <button class="export-btn" onclick="app.exportAs('svg')">
                                <i class="fas fa-vector-square"></i> SVG
                            </button>
                            <button class="export-btn" onclick="app.exportAs('pdf')">
                                <i class="fas fa-file-pdf"></i> PDF
                            </button>
                            <button class="export-btn" onclick="app.exportAs('webp')">
                                <i class="fas fa-compress"></i> WEBP
                            </button>
                        </div>

                        <!-- Social Share -->
                        <div class="share-options">
                            <button class="share-btn twitter" onclick="app.shareToSocial('twitter')" title="Twitter'da Paylaş">
                                <i class="fab fa-twitter"></i>
                            </button>
                            <button class="share-btn whatsapp" onclick="app.shareToSocial('whatsapp')" title="WhatsApp'ta Paylaş">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                            <button class="share-btn facebook" onclick="app.shareToSocial('facebook')" title="Facebook'ta Paylaş">
                                <i class="fab fa-facebook"></i>
                            </button>
                            <button class="share-btn telegram" onclick="app.shareToSocial('telegram')" title="Telegram'da Paylaş">
                                <i class="fab fa-telegram"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scanner Tab -->
        <div class="tab-content" id="scanner-tab">
            <div class="tab-header">
                <h1><i class="fas fa-camera"></i> QR Kod Tarayıcı Pro</h1>
                <p>Gelişmiş QR kod okuma özellikleri</p>
            </div>
            
            <div class="scanner-container">
                <div class="scanner-options">
                    <div class="scanner-modes">
                        <button class="scanner-mode-btn active" data-mode="camera">
                            <i class="fas fa-camera"></i> Kamera
                        </button>
                        <button class="scanner-mode-btn" data-mode="file">
                            <i class="fas fa-file-image"></i> Dosyadan
                        </button>
                        <button class="scanner-mode-btn" data-mode="url">
                            <i class="fas fa-link"></i> URL'den
                        </button>
                    </div>

                    <div class="scanner-settings">
                        <label>
                            <input type="checkbox" id="scanner-sound"> Ses efekti
                        </label>
                        <label>
                            <input type="checkbox" id="scanner-history" checked> Geçmişe kaydet
                        </label>
                        <label>
                            <input type="checkbox" id="scanner-continuous"> Sürekli tarama
                        </label>
                    </div>
                </div>

                <!-- Camera Scanner -->
                <div class="scanner-mode active" data-mode="camera">
                    <div class="video-container">
                        <video id="video" style="display: none;"></video>
                        <canvas id="scanner-canvas" style="display: none;"></canvas>
                        <div id="scanner-placeholder">
                            <i class="fas fa-qrcode" style="font-size: 4rem; color: #ddd;"></i>
                            <p>Tarayıcıyı başlatmak için "Başlat" butonuna tıklayın</p>
                        </div>
                        <div id="scanner-overlay" class="scanner-overlay" style="display: none;">
                            <div class="scanner-frame"></div>
                            <div class="scanner-line"></div>
                        </div>
                    </div>

                    <div class="scanner-controls">
                        <button id="start-scanner" class="action-btn">
                            <i class="fas fa-play"></i> Tarayıcıyı Başlat
                        </button>
                        <button id="stop-scanner" class="action-btn secondary hidden">
                            <i class="fas fa-stop"></i> Durdur
                        </button>
                        <button id="switch-camera" class="action-btn secondary hidden">
                            <i class="fas fa-sync-alt"></i> Kamera Değiştir
                        </button>
                        <button id="flashlight" class="action-btn secondary hidden">
                            <i class="fas fa-lightbulb"></i> Fener
                        </button>
                    </div>
                </div>

                <!-- File Scanner -->
                <div class="scanner-mode" data-mode="file">
                    <div class="file-scanner">
                        <div class="file-drop-zone" id="file-drop-zone">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: #ddd;"></i>
                            <p>QR kod içeren resmi buraya sürükleyin veya seçin</p>
                            <input type="file" id="qr-file-input" accept="image/*" style="display: none;">
                            <button onclick="document.getElementById('qr-file-input').click()" class="action-btn">
                                <i class="fas fa-folder-open"></i> Dosya Seç
                            </button>
                        </div>
                        <div id="file-preview" style="display: none;">
                            <img id="preview-image" style="max-width: 300px; border-radius: 10px;">
                        </div>
                    </div>
                </div>

                <!-- URL Scanner -->
                <div class="scanner-mode" data-mode="url">
                    <div class="url-scanner">
                        <label for="qr-url-input">QR kod içeren resmin URL'si:</label>
                        <div style="display: flex; gap: 10px; margin: 10px 0;">
                            <input type="url" id="qr-url-input" placeholder="https://example.com/qrcode.png" style="flex: 1;">
                            <button id="scan-url" class="action-btn">
                                <i class="fas fa-search"></i> Tara
                            </button>
                        </div>
                        <div id="url-preview" style="display: none;">
                            <img id="url-image" style="max-width: 300px; border-radius: 10px;">
                        </div>
                    </div>
                </div>
                
                <div id="scanner-result" class="scanner-result">
                    <h3><i class="fas fa-search-plus"></i> Tarama Sonucu:</h3>
                    <div id="scanned-data" class="scanned-data"></div>
                    <div class="scanner-result-actions" id="scanner-result-actions" style="display: none;">
                        <button id="copy-scanned" class="action-btn">
                            <i class="fas fa-copy"></i> Kopyala
                        </button>
                        <button id="open-scanned" class="action-btn">
                            <i class="fas fa-external-link-alt"></i> Aç
                        </button>
                        <button id="create-qr-from-scan" class="action-btn">
                            <i class="fas fa-qrcode"></i> QR Oluştur
                        </button>
                        <button id="save-scan-result" class="action-btn secondary">
                            <i class="fas fa-save"></i> Kaydet
                        </button>
                    </div>
                </div>

                <div class="scan-history" id="scan-history">
                    <h3><i class="fas fa-history"></i> Tarama Geçmişi</h3>
                    <div class="scan-history-list" id="scan-history-list">
                        <p style="text-align: center; color: #999;">Henüz tarama yapılmadı</p>
                    </div>
                    <button id="clear-scan-history" class="action-btn secondary" style="margin-top: 10px;">
                        <i class="fas fa-trash"></i> Geçmişi Temizle
                    </button>
                </div>
            </div>

            <!-- Strategic AdSense Placement #2 - After scanner interaction -->
            <div class="adsense-container" style="text-align: center; margin: 30px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="pub-9023802833968711"
                     data-ad-slot="2345678901"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>

        <!-- Batch Tab -->
        <div class="tab-content" id="batch-tab">
            <div class="tab-header">
                <h1><i class="fas fa-layer-group"></i> Toplu QR Üretim</h1>
                <p>Birden fazla QR kodu aynı anda oluşturun</p>
            </div>
            
            <div class="batch-container">
                <div class="batch-options">
                    <div class="batch-input-section">
                        <div class="input-method-tabs">
                            <button class="method-tab active" data-method="manual">
                                <i class="fas fa-edit"></i> Manuel Giriş
                            </button>
                            <button class="method-tab" data-method="file">
                                <i class="fas fa-file-upload"></i> Dosyadan Yükle
                            </button>
                            <button class="method-tab" data-method="csv">
                                <i class="fas fa-table"></i> CSV İçe Aktar
                            </button>
                        </div>

                        <!-- Manual Input -->
                        <div class="input-method active" data-method="manual">
                            <label for="batch-data">Her satıra bir veri girin:</label>
                            <textarea id="batch-data" class="batch-textarea" placeholder="https://example1.com
https://example2.com
+90 555 123 45 67
Merhaba dünya"></textarea>
                        </div>

                        <!-- File Upload -->
                        <div class="input-method" data-method="file">
                            <label>Metin dosyası seçin (.txt):</label>
                            <input type="file" id="batch-file" accept=".txt" style="margin: 10px 0;">
                            <div class="file-preview" id="file-preview"></div>
                        </div>

                        <!-- CSV Import -->
                        <div class="input-method" data-method="csv">
                            <label>CSV dosyası seçin:</label>
                            <input type="file" id="csv-file" accept=".csv" style="margin: 10px 0;">
                            <div class="csv-options" id="csv-options" style="display: none;">
                                <label>QR verisi hangi sütunda:</label>
                                <select id="csv-column">
                                    <option value="0">1. Sütun</option>
                                    <option value="1">2. Sütun</option>
                                    <option value="2">3. Sütun</option>
                                </select>
                            </div>
                            <div class="csv-preview" id="csv-preview"></div>
                        </div>
                    </div>

                    <div class="batch-settings">
                        <h3>🔧 Toplu Üretim Ayarları</h3>
                        
                        <div class="setting-group">
                            <label>QR Boyutu:</label>
                            <select id="batch-size">
                                <option value="128">128x128</option>
                                <option value="256" selected>256x256</option>
                                <option value="512">512x512</option>
                                <option value="1024">1024x1024</option>
                            </select>
                        </div>

                        <div class="setting-group">
                            <label>Format:</label>
                            <select id="batch-format">
                                <option value="png">PNG</option>
                                <option value="jpg">JPG</option>
                                <option value="svg">SVG</option>
                            </select>
                        </div>

                        <div class="setting-group">
                            <label>Dosya İsimlendirme:</label>
                            <select id="batch-naming">
                                <option value="qr-1">qr-1, qr-2, qr-3...</option>
                                <option value="content">İçeriğe göre</option>
                                <option value="timestamp">Zaman damgası</option>
                            </select>
                        </div>

                        <div class="setting-group">
                            <label>
                                <input type="checkbox" id="batch-zip"> 
                                ZIP dosyası olarak indir
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="batch-controls">
                    <button id="generate-batch" class="generate-btn">
                        <i class="fas fa-layer-group"></i> Toplu Oluştur
                    </button>
                    <button id="download-all-batch" class="action-btn" style="display: none;">
                        <i class="fas fa-download"></i> Tümünü İndir
                    </button>
                    <button id="clear-batch" class="action-btn secondary">
                        <i class="fas fa-broom"></i> Temizle
                    </button>
                </div>
                
                <div class="batch-progress" id="batch-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">0 / 0</div>
                </div>
                
                <div class="batch-results" id="batch-results"></div>
            </div>
        </div>

        <!-- History Tab -->
        <div class="tab-content" id="history-tab">
            <div class="tab-header">
                <h1><i class="fas fa-history"></i> QR Geçmişi</h1>
                <p>Oluşturduğunuz QR kodları görüntüleyin ve yönetin</p>
            </div>
            
            <div class="history-container">
                <div class="history-controls">
                    <h3>Toplam: <span id="history-count">0</span> QR kodu</h3>
                    <button id="clear-history" class="action-btn secondary">
                        <i class="fas fa-trash"></i> Geçmişi Temizle
                    </button>
                </div>
                
                <div class="history-list" id="history-list">
                    <div style="text-align: center; color: var(--text-secondary); grid-column: 1 / -1;">
                        <i class="fas fa-history" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                        <p>Henüz QR kodu oluşturmadınız</p>
                    </div>
                </div>
            </div>

            <!-- Strategic AdSense Placement #3 - Between sections for high engagement -->
            <div class="adsense-container" style="text-align: center; margin: 25px 0; padding: 15px;">
                <ins class="adsbygoogle"
                     style="display:inline-block;width:728px;height:90px"
                     data-ad-client="pub-9023802833968711"
                     data-ad-slot="3456789012"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div class="tab-content" id="analytics-tab">
            <div class="tab-header">
                <h1><i class="fas fa-chart-bar"></i> QR Kod Analitikleri</h1>
                <p>Kullanım istatistiklerinizi görüntüleyin</p>
            </div>

            <div class="analytics-dashboard">
                <div class="analytics-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-generated">0</div>
                        <div class="stat-label">Toplam Oluşturulan</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="most-used-type">Text</div>
                        <div class="stat-label">En Çok Kullanılan</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-downloads">0</div>
                        <div class="stat-label">Toplam İndirme</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-scans">0</div>
                        <div class="stat-label">Toplam Tarama</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="success-rate">100%</div>
                        <div class="stat-label">Başarı Oranı</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #10B981, #059669);">
                        <div class="stat-number" id="ad-revenue">$0.00</div>
                        <div class="stat-label">Ad Revenue</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #F59E0B, #D97706);">
                        <div class="stat-number" id="ad-views">0</div>
                        <div class="stat-label">Ad Views</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #3B82F6, #1D4ED8);">
                        <div class="stat-number" id="ad-ctr">0%</div>
                        <div class="stat-label">Ad CTR</div>
                    </div>
                </div>
                
                <!-- Simple Analytics Controls -->
                <div class="analytics-section">
                    <h3 style="color: var(--primary-color); margin: 2rem 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-chart-line"></i>
                        Analytics Kontrolleri
                    </h3>
                    
                    <div class="analytics-controls">
                        <button onclick="viewAnalyticsReport()" class="analytics-btn">
                            <i class="fas fa-chart-bar"></i>
                            Detay Raporu Görüntüle
                        </button>
                        <button onclick="exportAnalytics()" class="analytics-btn export">
                            <i class="fas fa-download"></i>
                            Analytics Export Et
                        </button>
                        <button onclick="resetAnalytics()" class="analytics-btn reset">
                            <i class="fas fa-trash-alt"></i>
                            Analytics Sıfırla
                        </button>
                    </div>
                    
                    <div class="analytics-info">
                        <p><i class="fas fa-info-circle"></i> Tüm analytics verileri tarayıcınızda yerel olarak saklanır.</p>
                        <p><i class="fas fa-shield-alt"></i> Hiçbir kişisel veri sunucularımıza gönderilmez.</p>
                    </div>
                    
                    <!-- Revenue Potential Info -->
                    <div class="revenue-info">
                        <h4 style="color: var(--success-color); margin-bottom: 1rem;">
                            <i class="fas fa-money-bill-wave"></i>
                            Gelir Potansiyeli
                        </h4>
                        <div class="revenue-estimates">
                            <div class="estimate-card">
                                <div class="estimate-traffic">1K ziyaretçi/gün</div>
                                <div class="estimate-revenue">$15-60/ay</div>
                            </div>
                            <div class="estimate-card">
                                <div class="estimate-traffic">5K ziyaretçi/gün</div>
                                <div class="estimate-revenue">$75-300/ay</div>
                            </div>
                            <div class="estimate-card">
                                <div class="estimate-traffic">10K ziyaretçi/gün</div>
                                <div class="estimate-revenue">$150-600/ay</div>
                            </div>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 1rem;">
                            <i class="fas fa-calculator"></i>
                            AdSense gelir tahminleri - Gerçek rakamlar traffic kalitesine göre değişebilir
                        </p>
                    </div>
                </div>
                
                <div class="analytics-grid">

                <div class="chart-container">
                    <div class="chart-title">QR Türleri Dağılımı</div>
                    <canvas id="type-chart" width="400" height="200"></canvas>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Günlük Kullanım Trendi</div>
                    <canvas id="usage-chart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- Premium Tab -->
        <div class="tab-content" id="premium-tab">
            <div class="tab-header">
                <h1><i class="fas fa-crown"></i> Premium Özellikler</h1>
                <p>Profesyonel QR kod çözümleri için premium plana geçin</p>
            </div>
            
            <!-- Premium Plans -->
            <div class="premium-plans">
                <div class="plan-card free-plan">
                    <div class="plan-header">
                        <h3><i class="fas fa-gift"></i> Ücretsiz</h3>
                        <div class="plan-price">$0<span>/ay</span></div>
                    </div>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Temel QR kod türleri</li>
                        <li><i class="fas fa-check"></i> PNG indirme</li>
                        <li><i class="fas fa-check"></i> Temel özelleştirme</li>
                        <li><i class="fas fa-times"></i> Logo ekleme</li>
                        <li><i class="fas fa-times"></i> Toplu üretim</li>
                        <li><i class="fas fa-times"></i> Analytics</li>
                    </ul>
                    <button class="plan-btn free-btn" data-plan="free">Aktif Plan</button>
                </div>
                
                <div class="plan-card pro-plan recommended">
                    <div class="plan-badge">En Popüler</div>
                    <div class="plan-header">
                        <h3><i class="fas fa-star"></i> QR Pro</h3>
                        <div class="plan-price">$4.99<span>/ay</span></div>
                    </div>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Tüm QR kod türleri</li>
                        <li><i class="fas fa-check"></i> Logo ekleme (sınırsız)</li>
                        <li><i class="fas fa-check"></i> PNG, SVG, PDF export</li>
                        <li><i class="fas fa-check"></i> Özel renk paletleri</li>
                        <li><i class="fas fa-check"></i> 50'ye kadar toplu üretim</li>
                        <li><i class="fas fa-check"></i> Detaylı analytics</li>
                        <li><i class="fas fa-check"></i> Reklamsız deneyim</li>
                        <li><i class="fas fa-check"></i> Öncelikli destek</li>
                    </ul>
                    <button class="plan-btn pro-btn" data-plan="pro">
                        <i class="fas fa-crown"></i> Yükselt
                    </button>
                </div>
                
                <div class="plan-card enterprise-plan">
                    <div class="plan-header">
                        <h3><i class="fas fa-building"></i> Enterprise</h3>
                        <div class="plan-price">$29<span>/ay</span></div>
                    </div>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> Pro'nun tüm özellikleri</li>
                        <li><i class="fas fa-check"></i> API erişimi (10K/ay)</li>
                        <li><i class="fas fa-check"></i> Sınırsız toplu üretim</li>
                        <li><i class="fas fa-check"></i> Özel branding</li>
                        <li><i class="fas fa-check"></i> White-label çözüm</li>
                        <li><i class="fas fa-check"></i> Gelişmiş analytics</li>
                        <li><i class="fas fa-check"></i> 24/7 öncelikli destek</li>
                        <li><i class="fas fa-check"></i> SLA garantisi</li>
                    </ul>
                    <button class="plan-btn enterprise-btn" data-plan="enterprise">
                        <i class="fas fa-building"></i> Yükselt
                    </button>
                </div>
            </div>
            
            <!-- Premium Features Showcase -->
            <div class="premium-showcase">
                <h3 style="text-align: center; margin: 3rem 0 2rem; color: var(--primary-color);">
                    <i class="fas fa-magic"></i> Premium Özellikler Vitrini
                </h3>
                
                <div class="showcase-grid">
                    <div class="showcase-item">
                        <div class="showcase-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <h4>Logo Ekleme</h4>
                        <p>QR kodlarınıza markanızı ekleyin. Profesyonel görünüm için logo entegrasyonu.</p>
                        <div class="preview-sample">
                            <div class="qr-sample with-logo">
                                <i class="fas fa-qrcode"></i>
                                <div class="logo-overlay">LOGO</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="showcase-item">
                        <div class="showcase-icon">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <h4>Toplu Üretim</h4>
                        <p>CSV/Excel dosyalarından yüzlerce QR kodu tek seferde oluşturun.</p>
                        <div class="preview-sample">
                            <div class="bulk-preview">
                                <div class="mini-qr"></div>
                                <div class="mini-qr"></div>
                                <div class="mini-qr"></div>
                                <div class="more-indicator">+47</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="showcase-item">
                        <div class="showcase-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h4>Gelişmiş Analytics</h4>
                        <p>QR kodlarınızın performansını detaylı raporlarla takip edin.</p>
                        <div class="preview-sample">
                            <div class="analytics-preview">
                                <div class="chart-bar"></div>
                                <div class="chart-bar" style="height: 60%"></div>
                                <div class="chart-bar" style="height: 80%"></div>
                                <div class="chart-bar" style="height: 40%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="showcase-item">
                        <div class="showcase-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <h4>API Erişimi</h4>
                        <p>Kendi uygulamanızda QR kod üretimi için RESTful API kullanın.</p>
                        <div class="preview-sample">
                            <div class="api-preview">
                                <code>POST /api/qr/generate</code>
                                <div class="api-response">{"success": true}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Money Back Guarantee -->
            <div class="guarantee-section">
                <div class="guarantee-box">
                    <i class="fas fa-shield-alt"></i>
                    <h3>30 Gün Para İade Garantisi</h3>
                    <p>Premium planından memnun kalmazanız, 30 gün içinde tam para iade garantisi.</p>
                </div>
            </div>
        </div>

        <!-- Templates Tab -->
        <div class="tab-content" id="templates-tab">
            <div class="tab-header">
                <h1><i class="fas fa-palette"></i> QR Kod Şablonları</h1>
                <p>Önceden tasarlanmış şablonları kullanın</p>
            </div>

            <div class="template-section">
                <h3>🎨 Renk Şablonları</h3>
                <div class="template-grid">
                    <div class="template-card" data-template="classic">
                        <div class="template-preview" style="background: linear-gradient(135deg, #1F2937, #FFFFFF);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Klasik</div>
                    </div>
                    <div class="template-card" data-template="ocean">
                        <div class="template-preview" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Okyanus</div>
                    </div>
                    <div class="template-card" data-template="sunset">
                        <div class="template-preview" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Gün Batımı</div>
                    </div>
                    <div class="template-card" data-template="forest">
                        <div class="template-preview" style="background: linear-gradient(135deg, #11998e, #38ef7d);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Orman</div>
                    </div>
                    <div class="template-card" data-template="gold">
                        <div class="template-preview" style="background: linear-gradient(135deg, #f7971e, #ffd200);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Altın</div>
                    </div>
                    <div class="template-card" data-template="purple">
                        <div class="template-preview" style="background: linear-gradient(135deg, #667db6, #0082c8);">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <div class="template-name">Mor</div>
                    </div>
                </div>

                <h3>🏢 İşletme Şablonları</h3>
                <div class="template-grid">
                    <div class="template-card" data-template="restaurant">
                        <div class="template-preview" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div class="template-name">Restoran</div>
                    </div>
                    <div class="template-card" data-template="retail">
                        <div class="template-preview" style="background: linear-gradient(135deg, #4834d4, #686de0);">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div class="template-name">Perakende</div>
                    </div>
                    <div class="template-card" data-template="event">
                        <div class="template-preview" style="background: linear-gradient(135deg, #ff9ff3, #f368e0);">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="template-name">Etkinlik</div>
                    </div>
                    <div class="template-card" data-template="tech">
                        <div class="template-preview" style="background: linear-gradient(135deg, #0be881, #62d2a2);">
                            <i class="fas fa-laptop-code"></i>
                        </div>
                        <div class="template-name">Teknoloji</div>
                    </div>
                </div>

                <button id="apply-template" class="generate-btn" disabled>
                    <i class="fas fa-paint-brush"></i> Şablonu Uygula
                </button>
            </div>
        </div>
    </div>
    
    <!-- Conversion Optimization Popup -->
    <div id="conversion-popup" class="conversion-popup" style="display: none;">
        <div class="popup-content">
            <button class="popup-close" onclick="closeConversionPopup()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="popup-header">
                <i class="fas fa-gift" style="font-size: 2rem; color: #F59E0B; margin-bottom: 1rem;"></i>
                <h3>🎉 Tebrikler!</h3>
                <p>QR kodunuz başarıyla oluşturuldu!</p>
            </div>
            
            <div class="popup-features">
                <div class="popup-feature">
                    <i class="fas fa-magic"></i>
                    <span>AI optimizasyonu ile %30 daha küçük</span>
                </div>
                <div class="popup-feature">
                    <i class="fas fa-shield-alt"></i>
                    <span>%100 güvenli ve gizli</span>
                </div>
                <div class="popup-feature">
                    <i class="fas fa-mobile-alt"></i>
                    <span>Tüm cihazlarda mükemmel çalışır</span>
                </div>
            </div>
            
            <div class="popup-cta">
                <p class="popup-invite">
                    <strong>Arkadaşlarına da öner!</strong><br>
                    <span>Bu ücretsiz aracı sosyal medyada paylaş</span>
                </p>
                
                <div class="share-buttons">
                    <button onclick="shareOnTwitter()" class="share-btn twitter">
                        <i class="fab fa-twitter"></i> Twitter
                    </button>
                    <button onclick="shareOnLinkedIn()" class="share-btn linkedin">
                        <i class="fab fa-linkedin"></i> LinkedIn
                    </button>
                    <button onclick="shareOnWhatsApp()" class="share-btn whatsapp">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Exit Intent Popup -->
    <div id="exit-intent-popup" class="conversion-popup" style="display: none;">
        <div class="popup-content exit-intent">
            <button class="popup-close" onclick="closeExitIntent()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="popup-header">
                <i class="fas fa-hand-paper" style="font-size: 2rem; color: #EF4444; margin-bottom: 1rem;"></i>
                <h3>✋ Bekle!</h3>
                <p>Henüz QR kodunu oluşturmadın</p>
            </div>
            
            <div class="exit-benefits">
                <h4>Ne kaybedeceksin:</h4>
                <ul>
                    <li>✅ Profesyonel QR kod tasarımları</li>
                    <li>✅ AI optimizasyonu ile küçük boyut</li>
                    <li>✅ 11 farklı QR türü desteği</li>
                    <li>✅ Tamamen ücretsiz kullanım</li>
                </ul>
            </div>
            
            <button onclick="stayAndCreate()" class="exit-cta-btn">
                <i class="fas fa-star"></i>
                Kal ve QR Kodunu Oluştur
            </button>
            
            <p class="exit-guarantee">
                <i class="fas fa-clock"></i>
                Sadece 30 saniye sürer!
            </p>
        </div>
    </div>

    <!-- Strategic AdSense Placement #4 - Footer area, large rectangle for revenue -->
    <div class="adsense-container" style="text-align: center; padding: 30px; margin: 40px 0; background: rgba(255,255,255,0.05); border-radius: 16px;">
        <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 10px;">Reklam</div>
        <ins class="adsbygoogle"
             style="display:inline-block;width:300px;height:250px"
             data-ad-client="pub-9023802833968711"
             data-ad-slot="4567890123"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <!-- Scripts will be loaded dynamically based on features used -->
    <script>
        // Enhanced Performance optimization: Advanced Lazy loader with caching
        const LazyLoader = {
            loadedScripts: new Set(),
            loading: new Map(),
            cache: new Map(),
            retryCount: new Map(),
            
            async loadScript(url, id, retries = 3) {
                if (this.loadedScripts.has(id)) return true;
                if (this.loading.has(id)) return this.loading.get(id);
                
                const loadPromise = new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = url;
                    script.async = true;
                    script.defer = true;
                    
                    // Performance optimizations
                    script.crossOrigin = 'anonymous';
                    script.integrity = this.getIntegrity(id);
                    
                    const cleanup = () => {
                        this.loading.delete(id);
                        script.removeEventListener('load', onLoad);
                        script.removeEventListener('error', onError);
                    };
                    
                    const onLoad = () => {
                        this.loadedScripts.add(id);
                        this.retryCount.delete(id);
                        cleanup();
                        resolve(true);
                        console.log(`✅ Loaded: ${id}`);
                    };
                    
                    const onError = async () => {
                        cleanup();
                        const currentRetries = this.retryCount.get(id) || 0;
                        
                        if (currentRetries < retries) {
                            this.retryCount.set(id, currentRetries + 1);
                            console.warn(`⚠️ Retry ${currentRetries + 1}/${retries} for: ${id}`);
                            
                            // Exponential backoff
                            await this.delay(Math.pow(2, currentRetries) * 1000);
                            
                            try {
                                const result = await this.loadScript(url, id, retries);
                                resolve(result);
                            } catch (e) {
                                reject(e);
                            }
                        } else {
                            console.error(`❌ Failed to load after ${retries} retries: ${id}`);
                            reject(new Error(`Failed to load ${id}`));
                        }
                    };
                    
                    script.addEventListener('load', onLoad);
                    script.addEventListener('error', onError);
                    
                    // Add to DOM with optimization
                    const target = document.head || document.documentElement;
                    target.appendChild(script);
                });
                
                this.loading.set(id, loadPromise);
                return loadPromise;
            },
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            },
            
            getIntegrity(id) {
                const integrityMap = {
                    'qrcode-gen': 'sha384-abcd1234', // Real integrity hash would go here
                    'jsqr': 'sha384-efgh5678' 
                };
                return integrityMap[id] || '';
            },
            
            async loadQRGenerator() {
                try {
                    await this.loadScript('https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js', 'qrcode-gen');
                    return true;
                } catch (error) {
                    // Fallback to local implementation
                    console.warn('Using fallback QR generation');
                    return this.createFallbackQR();
                }
            },
            
            createFallbackQR() {
                // Minimal QR fallback implementation
                window.qrcode = {
                    stringToBytes: (str) => Array.from(new TextEncoder().encode(str)),
                    make: () => ({
                        getModuleCount: () => 21,
                        isDark: () => Math.random() > 0.5,
                        createDataURL: () => 'data:image/png;base64,placeholder'
                    })
                };
                return true;
            },
            
            async loadQRScanner() {
                try {
                    await this.loadScript('https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js', 'jsqr');
                    return true;
                } catch (error) {
                    console.warn('QR Scanner fallback mode');
                    return this.createFallbackScanner();
                }
            },
            
            createFallbackScanner() {
                window.jsQR = () => null; // Minimal fallback
                return false;
            },
            
            // Preload critical resources
            async preloadCriticalResources() {
                const critical = [
                    { url: 'https://fonts.gstatic.com', id: 'fonts', priority: 'high' },
                    { url: 'https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js', id: 'qrcode-gen', priority: 'medium' }
                ];
                
                return Promise.allSettled(
                    critical.map(resource => this.loadScript(resource.url, resource.id))
                );
            },
            
            // Memory management
            cleanup() {
                // Clean up unused scripts and resources
                const unusedScripts = Array.from(document.scripts)
                    .filter(script => !script.src || !this.loadedScripts.has(script.dataset.id));
                
                unusedScripts.forEach(script => {
                    if (script.parentNode) {
                        script.parentNode.removeChild(script);
                    }
                });
                
                // Clear caches periodically
                if (this.cache.size > 50) {
                    this.cache.clear();
                }
            }
        };

        // Performance monitoring
        class PerformanceMonitor {
            constructor() {
                this.metrics = {
                    loadTime: 0,
                    firstPaint: 0,
                    firstContentfulPaint: 0,
                    largestContentfulPaint: 0,
                    cumulativeLayoutShift: 0,
                    firstInputDelay: 0
                };
                this.init();
            }
            
            init() {
                // Monitor Core Web Vitals
                this.observePerformance();
                this.trackUserInteractions();
                
                // Report metrics to analytics
                setTimeout(() => this.reportMetrics(), 5000);
            }
            
            observePerformance() {
                // LCP (Largest Contentful Paint)
                new PerformanceObserver((entryList) => {
                    const entries = entryList.getEntries();
                    const lastEntry = entries[entries.length - 1];
                    this.metrics.largestContentfulPaint = lastEntry.startTime;
                }).observe({ entryTypes: ['largest-contentful-paint'] });
                
                // FID (First Input Delay)
                new PerformanceObserver((entryList) => {
                    const entries = entryList.getEntries();
                    entries.forEach(entry => {
                        if (entry.processingStart && entry.startTime) {
                            this.metrics.firstInputDelay = entry.processingStart - entry.startTime;
                        }
                    });
                }).observe({ entryTypes: ['first-input'] });
                
                // CLS (Cumulative Layout Shift)
                new PerformanceObserver((entryList) => {
                    const entries = entryList.getEntries();
                    entries.forEach(entry => {
                        if (!entry.hadRecentInput) {
                            this.metrics.cumulativeLayoutShift += entry.value;
                        }
                    });
                }).observe({ entryTypes: ['layout-shift'] });
            }
            
            trackUserInteractions() {
                let interactionCount = 0;
                let bounceTime = Date.now();
                
                ['click', 'scroll', 'keypress'].forEach(event => {
                    document.addEventListener(event, () => {
                        interactionCount++;
                        if (interactionCount === 1) {
                            bounceTime = Date.now() - bounceTime;
                        }
                    }, { passive: true, once: false });
                });
                
                // Track bounce rate
                setTimeout(() => {
                    if (interactionCount === 0) {
                        this.reportBounce(bounceTime);
                    }
                }, 30000);
            }
            
            reportMetrics() {
                // Send to Google Analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'web_vitals', {
                        'lcp': this.metrics.largestContentfulPaint,
                        'fid': this.metrics.firstInputDelay,
                        'cls': this.metrics.cumulativeLayoutShift,
                        'performance_score': this.calculatePerformanceScore()
                    });
                }
                
                console.log('📊 Performance Metrics:', this.metrics);
            }
            
            calculatePerformanceScore() {
                // Simple scoring algorithm
                let score = 100;
                
                if (this.metrics.largestContentfulPaint > 2500) score -= 20;
                if (this.metrics.firstInputDelay > 100) score -= 15;
                if (this.metrics.cumulativeLayoutShift > 0.1) score -= 25;
                
                return Math.max(score, 0);
            }
            
            reportBounce(time) {
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'bounce', {
                        'bounce_time': time,
                        'page': window.location.pathname
                    });
                }
            }
        }
    </script>
    <script>
        class QRGeneratorPro {
            constructor() {
                this.currentType = 'text';
                this.currentQR = null;
                this.currentTab = 'generator';
                this.qrHistory = JSON.parse(localStorage.getItem('qr-history') || '[]');
                this.scannerStream = null;
                this.scannerActive = false;
                this.analytics = JSON.parse(localStorage.getItem('qr-analytics') || '{}');
                this.selectedTemplate = null;
                this.logoImage = null;
                this.scanHistory = JSON.parse(localStorage.getItem('scan-history') || '[]');
                this.currentScannerMode = 'camera';
                this.availableCameras = [];
                this.currentCameraIndex = 0;
                this.flashlightOn = false;
                this.init();
            }

            init() {
                this.bindEvents();
                this.updateHistoryDisplay();
                this.updateSizeDisplay();
                this.updateAnalytics();
                this.initializeAnalytics();
                this.updateScanHistoryDisplay();
                this.registerServiceWorker();
            }

            bindEvents() {
                // Tab navigation
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
                });

                // Mobile tab selector
                document.getElementById('mobile-tab-select').addEventListener('change', (e) => {
                    this.switchTab(e.target.value);
                });

                // Type selector buttons
                document.querySelectorAll('.type-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.handleTypeChange(e));
                });

                // Generate button
                document.getElementById('generate-btn').addEventListener('click', () => this.generateQR());

                // Action buttons
                document.getElementById('download-btn').addEventListener('click', () => this.downloadQR());
                document.getElementById('copy-btn').addEventListener('click', () => this.copyQR());
                document.getElementById('save-btn').addEventListener('click', () => this.saveQR());
                document.getElementById('new-btn').addEventListener('click', () => this.resetGenerator());

                // Customization controls
                document.getElementById('qr-size').addEventListener('input', () => this.updateSizeDisplay());
                document.getElementById('error-level').addEventListener('change', () => this.updateErrorLevelDisplay());

                // Scanner controls
                document.getElementById('start-scanner').addEventListener('click', () => this.startScanner());
                document.getElementById('stop-scanner').addEventListener('click', () => this.stopScanner());
                document.getElementById('copy-scanned').addEventListener('click', () => this.copyScanResult());

                // Enhanced scanner controls
                document.querySelectorAll('.scanner-mode-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => this.switchScannerMode(e.currentTarget.dataset.mode));
                });
                document.getElementById('switch-camera').addEventListener('click', () => this.switchCamera());
                document.getElementById('flashlight').addEventListener('click', () => this.toggleFlashlight());
                document.getElementById('qr-file-input').addEventListener('change', (e) => this.handleQRFileUpload(e));
                document.getElementById('scan-url').addEventListener('click', () => this.scanFromURL());
                document.getElementById('open-scanned').addEventListener('click', () => this.openScannedData());
                document.getElementById('create-qr-from-scan').addEventListener('click', () => this.createQRFromScan());
                document.getElementById('save-scan-result').addEventListener('click', () => this.saveScanResult());
                document.getElementById('clear-scan-history').addEventListener('click', () => this.clearScanHistory());

                // File drop zone
                const dropZone = document.getElementById('file-drop-zone');
                dropZone.addEventListener('dragover', (e) => this.handleDragOver(e));
                dropZone.addEventListener('drop', (e) => this.handleFileDrop(e));

                // Batch controls
                document.getElementById('generate-batch').addEventListener('click', () => this.generateBatch());

                // History controls
                document.getElementById('clear-history').addEventListener('click', () => this.clearHistory());

                // Advanced controls
                document.getElementById('use-gradient').addEventListener('change', (e) => this.toggleGradient(e.target.checked));
                document.getElementById('logo-upload').addEventListener('change', (e) => this.handleLogoUpload(e));
                document.getElementById('margin-size').addEventListener('input', (e) => this.updateMarginDisplay(e.target.value));

                // Template controls
                document.querySelectorAll('.template-card').forEach(card => {
                    card.addEventListener('click', (e) => this.selectTemplate(e.currentTarget.dataset.template));
                });
                document.getElementById('apply-template').addEventListener('click', () => this.applyTemplate());

                // Enhanced batch controls
                document.querySelectorAll('.method-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => this.switchBatchMethod(e.currentTarget.dataset.method));
                });
                document.getElementById('batch-file').addEventListener('change', (e) => this.handleBatchFileUpload(e));
                document.getElementById('csv-file').addEventListener('change', (e) => this.handleCSVUpload(e));
                document.getElementById('clear-batch').addEventListener('click', () => this.clearBatchResults());
                document.getElementById('download-all-batch').addEventListener('click', () => this.downloadAllBatch());

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));
            }

            switchTab(tabId) {
                // Update active tab
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelector(`[data-tab="${tabId}"]`)?.classList.add('active');
                
                // Update mobile selector
                document.getElementById('mobile-tab-select').value = tabId;

                // Show/hide tab content
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById(`${tabId}-tab`).classList.add('active');

                this.currentTab = tabId;

                // Stop scanner if switching away
                if (tabId !== 'scanner' && this.scannerActive) {
                    this.stopScanner();
                }

                // Update analytics when switching to analytics tab
                if (tabId === 'analytics') {
                    this.updateAnalyticsDisplay();
                }
            }

            handleTypeChange(e) {
                const button = e.currentTarget;
                const type = button.getAttribute('data-type');
                
                // Update active button
                document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Update active form
                document.querySelectorAll('.input-form').forEach(form => form.classList.remove('active'));
                document.querySelector(`[data-form="${type}"]`).classList.add('active');
                
                this.currentType = type;
            }

            async generateQR() {
                // Premium feature restriction check
                const qrHistory = JSON.parse(localStorage.getItem('qr_history') || '[]');
                const todayGenerated = qrHistory.filter(qr => 
                    new Date(qr.timestamp).toDateString() === new Date().toDateString()
                ).length;
                
                if (!window.premiumManager.canUseFeature('qr', todayGenerated)) {
                    window.premiumManager.showLimitReachedPrompt('qr', window.premiumManager.features[window.premiumManager.currentPlan].qrLimit);
                    return;
                }

                const data = this.getQRData();
                
                if (!data) {
                    this.showNotification('Lütfen gerekli alanları doldurun', 'error');
                    return;
                }

                // Show enhanced loading with progress
                const generateBtn = document.getElementById('generate-btn');
                generateBtn.classList.add('loading');
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Kütüphane yükleniyor...';

                try {
                    // Lazy load QR generator library
                    await LazyLoader.loadQRGenerator();
                    
                    generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> QR kod oluşturuluyor...';
                    
                    // Small delay for better UX
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    this.createQRCode(data);
                    this.showNotification('QR kod başarıyla oluşturuldu!', 'success');
                    
                    // Update analytics
                    this.updateAnalytics('generate', this.currentType);
                    
                    // Google Analytics tracking
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'qr_generated', {
                            'event_category': 'QR Generator',
                            'event_label': this.currentType,
                            'value': 1
                        });
                    }
                } catch (error) {
                    console.error('QR Generation Error:', error);
                    this.showNotification('QR kod oluşturulurken bir hata oluştu. Lütfen tekrar deneyin.', 'error');
                    
                    // Enhanced error tracking
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'qr_generation_error', {
                            'event_category': 'Error',
                            'event_label': error.message || 'Unknown error',
                            'value': 0
                        });
                    }
                } finally {
                    generateBtn.classList.remove('loading');
                    generateBtn.innerHTML = '<i class="fas fa-magic"></i> QR Kod Oluştur';
                }
            }

            createQRCode(data) {
                // Get customization options
                const size = parseInt(document.getElementById('qr-size').value);
                const errorLevel = document.getElementById('error-level').value;
                const colorMode = document.getElementById('color-mode')?.value || 'solid';

                // Clear previous QR code
                const qrDisplay = document.getElementById('qr-display');
                qrDisplay.innerHTML = '';

                // Generate QR code
                const qr = qrcode(0, errorLevel);
                qr.addData(data);
                qr.make();

                // Create enhanced styled QR
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const moduleCount = qr.getModuleCount();
                const cellSize = Math.floor(size / moduleCount);
                
                canvas.width = size;
                canvas.height = size;
                
                // Apply styling based on color mode
                switch (colorMode) {
                    case 'gradient':
                        this.renderGradientQR(ctx, qr, size, cellSize, moduleCount);
                        break;
                    case 'pattern':
                        this.renderPatternQR(ctx, qr, size, cellSize, moduleCount);
                        break;
                    case 'solid':
                    default:
                        this.renderSolidQR(ctx, qr, size, cellSize, moduleCount);
                }

                // Add logo if uploaded
                if (this.logoImage) {
                    this.addLogoToQR(ctx, size);
                }

                qrDisplay.appendChild(canvas);

                // Show actions
                document.getElementById('qr-actions').classList.remove('hidden');
                
                // Store for download
                this.currentQR = {
                    canvas: canvas,
                    data: data,
                    type: this.currentType,
                    timestamp: new Date().toISOString(),
                    colorMode: colorMode
                };
            }

            renderSolidQR(ctx, qr, size, cellSize, moduleCount) {
                const colorDark = document.getElementById('color-dark').value;
                const colorLight = document.getElementById('color-light').value;
                
                // Background
                ctx.fillStyle = colorLight;
                ctx.fillRect(0, 0, size, size);

                // QR modules
                ctx.fillStyle = colorDark;
                for (let row = 0; row < moduleCount; row++) {
                    for (let col = 0; col < moduleCount; col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                        }
                    }
                }
            }

            renderGradientQR(ctx, qr, size, cellSize, moduleCount) {
                const startColor = document.getElementById('gradient-start')?.value || '#4F46E5';
                const endColor = document.getElementById('gradient-end')?.value || '#06B6D4';
                const direction = document.getElementById('gradient-direction')?.value || 'diagonal';
                const bgColor = document.getElementById('color-light').value;
                
                // Background
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, size, size);

                // Create gradient
                let gradient;
                switch (direction) {
                    case 'horizontal':
                        gradient = ctx.createLinearGradient(0, 0, size, 0);
                        break;
                    case 'vertical':
                        gradient = ctx.createLinearGradient(0, 0, 0, size);
                        break;
                    case 'diagonal':
                        gradient = ctx.createLinearGradient(0, 0, size, size);
                        break;
                    case 'radial':
                        gradient = ctx.createRadialGradient(size/2, size/2, 0, size/2, size/2, size/2);
                        break;
                    default:
                        gradient = ctx.createLinearGradient(0, 0, size, size);
                }
                
                gradient.addColorStop(0, startColor);
                gradient.addColorStop(1, endColor);

                // QR modules with gradient
                ctx.fillStyle = gradient;
                for (let row = 0; row < moduleCount; row++) {
                    for (let col = 0; col < moduleCount; col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                        }
                    }
                }
            }

            renderPatternQR(ctx, qr, size, cellSize, moduleCount) {
                const patternColor = document.getElementById('pattern-color')?.value || '#1F2937';
                const bgColor = document.getElementById('pattern-bg')?.value || '#FFFFFF';
                const patternType = document.getElementById('pattern-type')?.value || 'square';
                
                // Background
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, size, size);

                // QR modules with patterns
                ctx.fillStyle = patternColor;
                for (let row = 0; row < moduleCount; row++) {
                    for (let col = 0; col < moduleCount; col++) {
                        if (qr.isDark(row, col)) {
                            const x = col * cellSize;
                            const y = row * cellSize;
                            
                            switch (patternType) {
                                case 'dots':
                                    const radius = cellSize * 0.4;
                                    ctx.beginPath();
                                    ctx.arc(x + cellSize/2, y + cellSize/2, radius, 0, 2 * Math.PI);
                                    ctx.fill();
                                    break;
                                case 'rounded':
                                    const cornerRadius = cellSize * 0.2;
                                    this.roundedRect(ctx, x, y, cellSize, cellSize, cornerRadius);
                                    ctx.fill();
                                    break;
                                case 'circle':
                                    const circleRadius = cellSize * 0.5;
                                    ctx.beginPath();
                                    ctx.arc(x + cellSize/2, y + cellSize/2, circleRadius, 0, 2 * Math.PI);
                                    ctx.fill();
                                    break;
                                case 'square':
                                default:
                                    ctx.fillRect(x, y, cellSize, cellSize);
                                    break;
                            }
                        }
                    }
                }
            }

            roundedRect(ctx, x, y, width, height, radius) {
                ctx.beginPath();
                ctx.moveTo(x + radius, y);
                ctx.lineTo(x + width - radius, y);
                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                ctx.lineTo(x + width, y + height - radius);
                ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                ctx.lineTo(x + radius, y + height);
                ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                ctx.lineTo(x, y + radius);
                ctx.quadraticCurveTo(x, y, x + radius, y);
                ctx.closePath();
            }

            addLogoToQR(ctx, size) {
                if (!this.logoImage) return;
                
                const logoSize = size * 0.2; // Logo size 20% of QR code
                const logoX = (size - logoSize) / 2;
                const logoY = (size - logoSize) / 2;
                
                // White background for logo
                ctx.fillStyle = 'white';
                ctx.fillRect(logoX - 10, logoY - 10, logoSize + 20, logoSize + 20);
                
                // Draw logo
                ctx.drawImage(this.logoImage, logoX, logoY, logoSize, logoSize);
            }

            updateColorMode(mode) {
                // Hide all control groups
                const solidControls = document.getElementById('solid-color-controls');
                const gradientControls = document.getElementById('gradient-controls');
                const patternControls = document.getElementById('pattern-controls');
                
                if (solidControls) solidControls.style.display = 'none';
                if (gradientControls) gradientControls.style.display = 'none';
                if (patternControls) patternControls.style.display = 'none';
                
                // Show selected control group
                switch (mode) {
                    case 'solid':
                        if (solidControls) solidControls.style.display = 'flex';
                        break;
                    case 'gradient':
                        if (gradientControls) gradientControls.style.display = 'block';
                        break;
                    case 'pattern':
                        if (patternControls) patternControls.style.display = 'block';
                        break;
                }
            }

            getQRData() {
                switch (this.currentType) {
                    case 'text':
                        return document.getElementById('text-input').value.trim();
                    
                    case 'url':
                        const url = document.getElementById('url-input').value.trim();
                        return url ? (url.startsWith('http') ? url : `https://${url}`) : '';
                    
                    case 'wifi':
                        const ssid = document.getElementById('wifi-ssid').value.trim();
                        const password = document.getElementById('wifi-password').value;
                        const security = document.getElementById('wifi-security').value;
                        
                        if (!ssid) return '';
                        
                        if (security === 'nopass') {
                            return `WIFI:S:${ssid};T:nopass;;`;
                        } else {
                            return `WIFI:S:${ssid};T:${security};P:${password};;`;
                        }
                    
                    case 'phone':
                        const phone = document.getElementById('phone-input').value.trim();
                        return phone ? `tel:${phone}` : '';
                    
                    case 'email':
                        const email = document.getElementById('email-input').value.trim();
                        const subject = document.getElementById('email-subject').value.trim();
                        const body = document.getElementById('email-body').value.trim();
                        
                        if (!email) return '';
                        
                        let emailData = `mailto:${email}`;
                        const params = [];
                        if (subject) params.push(`subject=${encodeURIComponent(subject)}`);
                        if (body) params.push(`body=${encodeURIComponent(body)}`);
                        if (params.length > 0) emailData += `?${params.join('&')}`;
                        
                        return emailData;
                    
                    case 'sms':
                        const smsPhone = document.getElementById('sms-phone').value.trim();
                        const message = document.getElementById('sms-message').value.trim();
                        
                        if (!smsPhone) return '';
                        
                        return `sms:${smsPhone}${message ? `?body=${encodeURIComponent(message)}` : ''}`;
                    
                    case 'vcard':
                        const name = document.getElementById('vcard-name').value.trim();
                        const vcardPhone = document.getElementById('vcard-phone').value.trim();
                        const vcardEmail = document.getElementById('vcard-email').value.trim();
                        const company = document.getElementById('vcard-company').value.trim();
                        
                        if (!name) return '';
                        
                        let vcard = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\n`;
                        if (vcardPhone) vcard += `TEL:${vcardPhone}\n`;
                        if (vcardEmail) vcard += `EMAIL:${vcardEmail}\n`;
                        if (company) vcard += `ORG:${company}\n`;
                        vcard += 'END:VCARD';
                        
                        return vcard;
                    
                    case 'event':
                        const title = document.getElementById('event-title').value.trim();
                        const date = document.getElementById('event-date').value;
                        const location = document.getElementById('event-location').value.trim();
                        const description = document.getElementById('event-description').value.trim();
                        
                        if (!title || !date) return '';
                        
                        const eventDate = new Date(date).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
                        
                        let event = `BEGIN:VEVENT\nSUMMARY:${title}\nDTSTART:${eventDate}\n`;
                        if (location) event += `LOCATION:${location}\n`;
                        if (description) event += `DESCRIPTION:${description}\n`;
                        event += 'END:VEVENT';
                        
                        return event;
                    
                    case 'crypto':
                        const cryptoType = document.getElementById('crypto-type').value;
                        const address = document.getElementById('crypto-address').value.trim();
                        const amount = document.getElementById('crypto-amount').value;
                        
                        if (!address) return '';
                        
                        let crypto = `${cryptoType}:${address}`;
                        if (amount) crypto += `?amount=${amount}`;
                        
                        return crypto;
                    
                    case 'geolocation':
                        const lat = document.getElementById('geo-lat').value.trim();
                        const lng = document.getElementById('geo-lng').value.trim();
                        const label = document.getElementById('geo-label').value.trim();
                        
                        if (!lat || !lng) return '';
                        
                        // Google Maps format: geo:lat,lng?q=lat,lng(label)
                        let geo = `geo:${lat},${lng}`;
                        if (label) {
                            geo += `?q=${lat},${lng}(${encodeURIComponent(label)})`;
                        }
                        
                        return geo;
                    
                    case 'social':
                        const platform = document.getElementById('social-platform').value;
                        const username = document.getElementById('social-username').value.trim();
                        
                        if (!username) return '';
                        
                        const socialUrls = {
                            instagram: `https://instagram.com/${username}`,
                            twitter: `https://twitter.com/${username}`,
                            facebook: `https://facebook.com/${username}`,
                            linkedin: `https://linkedin.com/in/${username}`,
                            youtube: `https://youtube.com/@${username}`,
                            tiktok: `https://tiktok.com/@${username}`,
                            whatsapp: `https://wa.me/${username}`
                        };
                        
                        return socialUrls[platform] || '';
                    
                    case 'app':
                        const store = document.getElementById('app-store').value;
                        const appId = document.getElementById('app-id').value.trim();
                        
                        if (!appId) return '';
                        
                        const storeUrls = {
                            ios: `https://apps.apple.com/app/id${appId}`,
                            android: `https://play.google.com/store/apps/details?id=${appId}`,
                            huawei: `https://appgallery.cloud.huawei.com/ag/n/app/C${appId}`
                        };
                        
                        return storeUrls[store] || '';
                    
                    case 'meeting':
                        const meetingUrl = document.getElementById('meeting-url').value.trim();
                        const meetingId = document.getElementById('meeting-id').value.trim();
                        const meetingPassword = document.getElementById('meeting-password').value.trim();
                        
                        if (!meetingUrl) return '';
                        
                        let meeting = meetingUrl;
                        const params = [];
                        
                        if (meetingId) params.push(`meetingId=${encodeURIComponent(meetingId)}`);
                        if (meetingPassword) params.push(`password=${encodeURIComponent(meetingPassword)}`);
                        
                        if (params.length > 0) {
                            meeting += (meetingUrl.includes('?') ? '&' : '?') + params.join('&');
                        }
                        
                        return meeting;
                    
                    default:
                        return '';
                }
            }

            downloadQR() {
                if (!this.currentQR) return;
                
                const link = document.createElement('a');
                link.download = `qr-${this.currentType}-${Date.now()}.png`;
                link.href = this.currentQR.canvas.toDataURL();
                link.click();
                
                this.showNotification('QR kod indirildi!', 'success');
                
                // Update analytics
                this.updateAnalytics('download');
                
                // Track download
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'qr_downloaded', {
                        'event_category': 'QR Generator',
                        'event_label': this.currentType
                    });
                }
            }

            async copyQR() {
                if (!this.currentQR) return;
                
                try {
                    this.currentQR.canvas.toBlob(async (blob) => {
                        if (navigator.clipboard && window.ClipboardItem) {
                            const item = new ClipboardItem({ 'image/png': blob });
                            await navigator.clipboard.write([item]);
                            this.showNotification('QR kod panoya kopyalandı!', 'success');
                        } else {
                            // Fallback
                            this.fallbackCopy();
                        }
                    });
                } catch (error) {
                    this.fallbackCopy();
                }
            }

            fallbackCopy() {
                if (!this.currentQR) return;
                
                try {
                    const dataURL = this.currentQR.canvas.toDataURL();
                    const tempInput = document.createElement('input');
                    tempInput.value = dataURL;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempInput);
                    
                    this.showNotification('QR kod bağlantısı kopyalandı!', 'success');
                } catch (error) {
                    this.showNotification('Kopyalama başarısız', 'error');
                }
            }

            saveQR() {
                if (!this.currentQR) return;
                
                const historyItem = {
                    id: Date.now(),
                    type: this.currentType,
                    data: this.currentQR.data,
                    timestamp: this.currentQR.timestamp,
                    canvas: this.currentQR.canvas.toDataURL()
                };
                
                this.qrHistory.unshift(historyItem);
                
                // Limit history to 50 items
                if (this.qrHistory.length > 50) {
                    this.qrHistory = this.qrHistory.slice(0, 50);
                }
                
                localStorage.setItem('qr-history', JSON.stringify(this.qrHistory));
                this.updateHistoryDisplay();
                
                this.showNotification('QR kod geçmişe kaydedildi!', 'success');
            }

            resetGenerator() {
                // Clear all inputs
                document.querySelectorAll('.input-form input, .input-form textarea, .input-form select').forEach(input => {
                    if (input.type !== 'color' && input.type !== 'range') {
                        input.value = '';
                    }
                });
                
                // Reset QR display
                document.getElementById('qr-display').innerHTML = `
                    <div class="qr-placeholder">
                        <i class="fas fa-qrcode"></i>
                        <p>QR kodunuz burada görünecek</p>
                    </div>
                `;
                
                // Hide actions
                document.getElementById('qr-actions').classList.add('hidden');
                
                this.currentQR = null;
            }

            updateSizeDisplay() {
                const size = document.getElementById('qr-size').value;
                document.getElementById('size-value').textContent = `${size}px`;
            }

            updateErrorLevelDisplay() {
                const level = document.getElementById('error-level').value;
                const texts = { L: 'Düşük', M: 'Orta', Q: 'Yüksek', H: 'En Yüksek' };
                document.getElementById('error-level-text').textContent = texts[level];
            }

            // Scanner functions
            async startScanner() {
                try {
                    // Get available cameras
                    if (this.availableCameras.length === 0) {
                        const devices = await navigator.mediaDevices.enumerateDevices();
                        this.availableCameras = devices.filter(device => device.kind === 'videoinput');
                    }
                    
                    // Set up camera constraints
                    let constraints = { video: { facingMode: 'environment' } };
                    if (this.availableCameras.length > 0 && this.availableCameras[this.currentCameraIndex]) {
                        constraints.video.deviceId = this.availableCameras[this.currentCameraIndex].deviceId;
                    }
                    
                    this.scannerStream = await navigator.mediaDevices.getUserMedia(constraints);
                    
                    const video = document.getElementById('video');
                    video.srcObject = this.scannerStream;
                    video.style.display = 'block';
                    video.classList.add('active');
                    video.play();
                    
                    document.getElementById('scanner-placeholder').style.display = 'none';
                    document.getElementById('scanner-overlay').style.display = 'block';
                    document.getElementById('start-scanner').classList.add('hidden');
                    document.getElementById('stop-scanner').classList.remove('hidden');
                    
                    // Show additional controls if available
                    if (this.availableCameras.length > 1) {
                        document.getElementById('switch-camera').classList.remove('hidden');
                    }
                    
                    // Check for flashlight support
                    const track = this.scannerStream.getVideoTracks()[0];
                    const capabilities = track.getCapabilities();
                    if (capabilities.torch) {
                        document.getElementById('flashlight').classList.remove('hidden');
                    }
                    
                    this.scannerActive = true;
                    this.scanForQR(video);
                    
                } catch (error) {
                    this.showNotification('Kamera erişimi başarısız: ' + error.message, 'error');
                }
            }

            stopScanner() {
                if (this.scannerStream) {
                    this.scannerStream.getTracks().forEach(track => track.stop());
                    this.scannerStream = null;
                }
                
                const video = document.getElementById('video');
                video.style.display = 'none';
                video.classList.remove('active');
                
                document.getElementById('scanner-placeholder').style.display = 'block';
                document.getElementById('scanner-overlay').style.display = 'none';
                document.getElementById('start-scanner').classList.remove('hidden');
                document.getElementById('stop-scanner').classList.add('hidden');
                document.getElementById('switch-camera').classList.add('hidden');
                document.getElementById('flashlight').classList.add('hidden');
                
                this.scannerActive = false;
                this.flashlightOn = false;
            }

            scanForQR(video) {
                if (!this.scannerActive) return;
                
                if (typeof jsQR !== 'undefined') {
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    
                    const code = jsQR(imageData.data, imageData.width, imageData.height);
                    
                    if (code) {
                        this.handleScanResult(code.data);
                        if (!document.getElementById('scanner-continuous').checked) {
                            this.stopScanner();
                        }
                        return;
                    }
                }
                
                // Continue scanning
                requestAnimationFrame(() => this.scanForQR(video));
            }

            displayScanResult(data) {
                document.getElementById('scanned-data').textContent = data;
                document.getElementById('scanner-result').style.display = 'block';
                this.showNotification('QR kod başarıyla tarandı!', 'success');
            }

            copyScanResult() {
                const data = document.getElementById('scanned-data').textContent;
                if (!data) {
                    this.showNotification('Kopyalanacak veri yok', 'warning');
                    return;
                }
                
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(data).then(() => {
                        this.showNotification('Tarama sonucu kopyalandı!', 'success');
                    }).catch(() => {
                        this.fallbackCopyText(data);
                    });
                } else {
                    this.fallbackCopyText(data);
                }
            }

            fallbackCopyText(text) {
                const tempInput = document.createElement('input');
                tempInput.value = text;
                document.body.appendChild(tempInput);
                tempInput.select();
                try {
                    document.execCommand('copy');
                    this.showNotification('Tarama sonucu kopyalandı!', 'success');
                } catch (error) {
                    this.showNotification('Kopyalama başarısız', 'error');
                }
                document.body.removeChild(tempInput);
            }

            // Batch functions
            oldGenerateBatch() {
                // Bu fonksiyon artık kullanılmıyor - yeni async generateBatch() kullanılıyor
                const batchData = document.getElementById('batch-data').value.trim();
                if (!batchData) {
                    this.showNotification('Lütfen toplu veri girin', 'error');
                    return;
                }
                
                const lines = batchData.split('\n').filter(line => line.trim());
                const resultsContainer = document.getElementById('batch-results');
                resultsContainer.innerHTML = '';
                
                lines.forEach((line, index) => {
                    try {
                        const qr = qrcode(0, 'M');
                        qr.addData(line.trim());
                        qr.make();
                        
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'batch-qr-item';
                        
                        const canvas = document.createElement('canvas');
                        const size = 150;
                        canvas.width = size;
                        canvas.height = size;
                        
                        const ctx = canvas.getContext('2d');
                        const cellSize = Math.floor(size / qr.getModuleCount());
                        
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(0, 0, size, size);
                        
                        ctx.fillStyle = '#000000';
                        for (let row = 0; row < qr.getModuleCount(); row++) {
                            for (let col = 0; col < qr.getModuleCount(); col++) {
                                if (qr.isDark(row, col)) {
                                    ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                                }
                            }
                        }
                        
                        itemDiv.appendChild(canvas);
                        
                        const dataDiv = document.createElement('div');
                        dataDiv.textContent = line.substring(0, 30) + (line.length > 30 ? '...' : '');
                        dataDiv.style.marginTop = '0.5rem';
                        dataDiv.style.fontSize = '0.8rem';
                        dataDiv.style.wordBreak = 'break-all';
                        
                        itemDiv.appendChild(dataDiv);
                        
                        const downloadBtn = document.createElement('button');
                        downloadBtn.className = 'action-btn';
                        downloadBtn.style.marginTop = '0.5rem';
                        downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
                        downloadBtn.onclick = () => {
                            const link = document.createElement('a');
                            link.download = `batch-qr-${index + 1}.png`;
                            link.href = canvas.toDataURL();
                            link.click();
                        };
                        
                        itemDiv.appendChild(downloadBtn);
                        resultsContainer.appendChild(itemDiv);
                        
                    } catch (error) {
                        console.error('Batch QR error:', error);
                    }
                });
                
                this.showNotification(`${lines.length} QR kodu oluşturuldu!`, 'success');
            }

            // History functions
            updateHistoryDisplay() {
                const historyList = document.getElementById('history-list');
                const historyCount = document.getElementById('history-count');
                
                historyCount.textContent = this.qrHistory.length;
                
                if (this.qrHistory.length === 0) {
                    historyList.innerHTML = `
                        <div style="text-align: center; color: var(--text-secondary); grid-column: 1 / -1;">
                            <i class="fas fa-history" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                            <p>Henüz QR kodu oluşturmadınız</p>
                        </div>
                    `;
                    return;
                }
                
                historyList.innerHTML = '';
                
                this.qrHistory.forEach(item => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'history-item';
                    
                    const date = new Date(item.timestamp).toLocaleString('tr-TR');
                    
                    itemDiv.innerHTML = `
                        <div class="history-item-header">
                            <span class="history-item-type">${item.type}</span>
                            <span class="history-item-date">${date}</span>
                        </div>
                        <div class="history-item-content">${item.data.substring(0, 100)}${item.data.length > 100 ? '...' : ''}</div>
                        <div class="history-item-qr">
                            <img src="${item.canvas}" style="width: 80px; height: 80px;">
                        </div>
                        <div style="display: flex; gap: 0.5rem; justify-content: center;">
                            <button class="action-btn" onclick="qrApp.downloadHistoryItem(${item.id})">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn secondary" onclick="qrApp.deleteHistoryItem(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    
                    historyList.appendChild(itemDiv);
                });
            }

            downloadHistoryItem(id) {
                const item = this.qrHistory.find(h => h.id === id);
                if (item) {
                    const link = document.createElement('a');
                    link.download = `qr-${item.type}-${id}.png`;
                    link.href = item.canvas;
                    link.click();
                }
            }

            deleteHistoryItem(id) {
                this.qrHistory = this.qrHistory.filter(h => h.id !== id);
                localStorage.setItem('qr-history', JSON.stringify(this.qrHistory));
                this.updateHistoryDisplay();
                this.showNotification('QR kodu silindi', 'info');
            }

            clearHistory() {
                if (confirm('Tüm geçmişi temizlemek istediğinizden emin misiniz?')) {
                    this.qrHistory = [];
                    localStorage.removeItem('qr-history');
                    this.updateHistoryDisplay();
                    this.showNotification('Geçmiş temizlendi', 'info');
                }
            }

            handleKeyboard(e) {
                // Ctrl/Cmd + Enter to generate QR
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    if (this.currentTab === 'generator') {
                        this.generateQR();
                    }
                }
                
                // Ctrl/Cmd + S to save QR
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    if (this.currentQR) {
                        e.preventDefault();
                        this.saveQR();
                    }
                }
                
                // Ctrl/Cmd + D to download QR
                if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                    if (this.currentQR) {
                        e.preventDefault();
                        this.downloadQR();
                    }
                }
                
                // Tab navigation with numbers
                if (e.ctrlKey && e.key >= '1' && e.key <= '4') {
                    e.preventDefault();
                    const tabs = ['generator', 'scanner', 'batch', 'history'];
                    this.switchTab(tabs[parseInt(e.key) - 1]);
                }
            }

            // Enhanced Error Management System
            errorSystem = {
                errorHistory: [],
                maxHistorySize: 50,
                
                logError(error, context = '') {
                    const errorEntry = {
                        timestamp: new Date().toISOString(),
                        message: error.message || error,
                        stack: error.stack,
                        context: context,
                        userAgent: navigator.userAgent,
                        url: window.location.href,
                        severity: this.determineSeverity(error)
                    };
                    
                    this.errorHistory.unshift(errorEntry);
                    if (this.errorHistory.length > this.maxHistorySize) {
                        this.errorHistory = this.errorHistory.slice(0, this.maxHistorySize);
                    }
                    
                    // Store in localStorage
                    try {
                        localStorage.setItem('qr-error-history', JSON.stringify(this.errorHistory));
                    } catch (e) {
                        console.warn('Failed to store error history:', e);
                    }
                    
                    // Send to analytics if available
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'exception', {
                            'description': errorEntry.message,
                            'fatal': errorEntry.severity === 'critical'
                        });
                    }
                    
                    console.error('QR App Error:', errorEntry);
                    return errorEntry;
                },
                
                determineSeverity(error) {
                    const message = error.message?.toLowerCase() || error.toLowerCase();
                    if (message.includes('network') || message.includes('fetch') || message.includes('load')) {
                        return 'network';
                    }
                    if (message.includes('permission') || message.includes('camera') || message.includes('media')) {
                        return 'permission';
                    }
                    if (message.includes('memory') || message.includes('quota')) {
                        return 'resource';
                    }
                    return 'general';
                },
                
                getErrorSuggestion(severity, message) {
                    const suggestions = {
                        network: 'İnternet bağlantınızı kontrol edin ve tekrar deneyin.',
                        permission: 'Tarayıcı izinlerini kontrol edin ve sayfayı yenileyin.',
                        resource: 'Tarayıcı önbelleğini temizleyin veya sekmeleri kapatın.',
                        general: 'Sayfayı yenileyin veya farklı bir tarayıcı deneyin.'
                    };
                    return suggestions[severity] || suggestions.general;
                },
                
                clearHistory() {
                    this.errorHistory = [];
                    localStorage.removeItem('qr-error-history');
                }
            };

            showNotification(message, type = 'info', options = {}) {
                // Enhanced notification system with better UX
                const {
                    duration = type === 'error' ? 6000 : 3000,
                    actionText = null,
                    actionCallback = null,
                    persistent = false,
                    showClose = type === 'error'
                } = options;

                // Remove old notifications of same type unless persistent
                if (!persistent) {
                    document.querySelectorAll(`.notification.${type}`).forEach(n => n.remove());
                }
                
                const notification = document.createElement('div');
                notification.className = `notification ${type} notification-enhanced`;
                
                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle', 
                    warning: 'fa-exclamation-triangle',
                    info: 'fa-info-circle',
                    loading: 'fa-spinner fa-spin'
                };
                
                notification.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-icon">
                            <i class="fas ${icons[type] || icons.info}"></i>
                        </div>
                        <div class="notification-message">${message}</div>
                        <div class="notification-actions">
                            ${actionText && actionCallback ? `
                                <button class="notification-action" onclick="(${actionCallback})(); this.closest('.notification').remove();">
                                    ${actionText}
                                </button>
                            ` : ''}
                            ${showClose ? '<button class="notification-close" onclick="this.closest(\'.notification\').remove();"><i class="fas fa-times"></i></button>' : ''}
                        </div>
                    </div>
                    ${!persistent && duration > 0 ? '<div class="notification-progress"></div>' : ''}
                `;
                
                document.body.appendChild(notification);
                
                // Trigger entrance animation
                requestAnimationFrame(() => {
                    notification.classList.add('show');
                });
                
                // Auto remove with progress bar
                if (!persistent && duration > 0) {
                    const progressBar = notification.querySelector('.notification-progress');
                    if (progressBar) {
                        progressBar.style.animationDuration = duration + 'ms';
                    }
                    
                    setTimeout(() => {
                        notification.classList.add('removing');
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }, duration);
                }
                
                return notification;
            }

            showError(error, context = '', userFriendlyMessage = null) {
                // Enhanced error display with logging
                const errorEntry = this.errorSystem.logError(error, context);
                const suggestion = this.errorSystem.getErrorSuggestion(errorEntry.severity, errorEntry.message);
                
                const message = userFriendlyMessage || 
                    `Bir hata oluştu: ${errorEntry.message}. ${suggestion}`;
                
                this.showNotification(message, 'error', {
                    duration: 8000,
                    showClose: true,
                    actionText: 'Detaylar',
                    actionCallback: () => {
                        console.group('Hata Detayları');
                        console.error('Error Entry:', errorEntry);
                        console.error('Full Error:', error);
                        console.groupEnd();
                        this.showNotification('Hata detayları konsolda görüntülendi (F12 ile açın)', 'info');
                    }
                });
            }

            // Enhanced PWA Support
            async registerServiceWorker() {
                if (!('serviceWorker' in navigator)) {
                    console.warn('Service Worker not supported');
                    return;
                }

                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('SW: Registration successful', registration);
                    
                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('SW: New service worker found');
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                this.showUpdateAvailable();
                            }
                        });
                    });
                    
                    // Listen for messages from SW
                    navigator.serviceWorker.addEventListener('message', (event) => {
                        this.handleServiceWorkerMessage(event.data);
                    });
                    
                    // Handle install prompt
                    this.setupInstallPrompt();
                    
                    // Setup offline detection
                    this.setupOfflineDetection();
                    
                    // Setup background sync
                    this.setupBackgroundSync();
                    
                } catch (error) {
                    console.error('SW: Registration failed:', error);
                }
            }

            showUpdateAvailable() {
                this.showNotification('Uygulama güncellemesi mevcut!', 'info', {
                    persistent: true,
                    actionText: 'Güncelle',
                    actionCallback: () => this.updateServiceWorker()
                });
            }

            updateServiceWorker() {
                if (navigator.serviceWorker.controller) {
                    navigator.serviceWorker.controller.postMessage({ type: 'SKIP_WAITING' });
                    window.location.reload();
                }
            }

            handleServiceWorkerMessage(message) {
                switch (message.type) {
                    case 'SW_ACTIVATED':
                        this.showNotification(message.message, 'success');
                        break;
                    case 'QR_GENERATED_OFFLINE':
                        this.handleOfflineQRGenerated(message.data);
                        break;
                    case 'CACHE_UPDATED':
                        console.log('SW: Cache updated');
                        break;
                }
            }

            setupInstallPrompt() {
                let deferredPrompt;
                
                window.addEventListener('beforeinstallprompt', (e) => {
                    console.log('PWA: Install prompt triggered');
                    e.preventDefault();
                    deferredPrompt = e;
                    this.showInstallPrompt(deferredPrompt);
                });

                // Handle successful installation
                window.addEventListener('appinstalled', () => {
                    console.log('PWA: App installed successfully');
                    this.showNotification('Uygulama başarıyla yüklendi!', 'success');
                    
                    // Track installation
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'pwa_installed', {
                            'event_category': 'PWA',
                            'event_label': 'App Installation'
                        });
                    }
                });
            }

            showInstallPrompt(deferredPrompt) {
                // Show install banner after 30 seconds
                setTimeout(() => {
                    if (deferredPrompt && !this.isInstalled()) {
                        this.displayInstallBanner(deferredPrompt);
                    }
                }, 30000);
            }

            displayInstallBanner(deferredPrompt) {
                const banner = document.createElement('div');
                banner.className = 'install-banner';
                banner.innerHTML = `
                    <div class="install-banner-content">
                        <div class="install-banner-icon">
                            <i class="fas fa-download"></i>
                        </div>
                        <div class="install-banner-text">
                            <h3>QR Generator Pro'yu Yükle</h3>
                            <p>Daha hızlı erişim ve offline kullanım için</p>
                        </div>
                        <div class="install-banner-actions">
                            <button class="btn-primary install-btn">Yükle</button>
                            <button class="btn-secondary dismiss-btn">Hayır</button>
                        </div>
                    </div>
                `;

                // Add styles
                banner.style.cssText = `
                    position: fixed; bottom: 20px; left: 20px; right: 20px;
                    background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.2);
                    padding: 16px; z-index: 10000; animation: slideUp 0.3s ease;
                `;

                document.body.appendChild(banner);

                // Handle install
                banner.querySelector('.install-btn').addEventListener('click', async () => {
                    try {
                        const result = await deferredPrompt.prompt();
                        console.log('PWA: Install prompt result:', result);
                        
                        if (result.outcome === 'accepted') {
                            this.showNotification('Uygulama yükleniyor...', 'loading');
                        }
                    } catch (error) {
                        console.error('PWA: Install failed:', error);
                    }
                    
                    banner.remove();
                    deferredPrompt = null;
                });

                // Handle dismiss
                banner.querySelector('.dismiss-btn').addEventListener('click', () => {
                    banner.remove();
                    
                    // Don't show again for 7 days
                    localStorage.setItem('pwa-install-dismissed', Date.now());
                });

                // Auto dismiss after 10 seconds
                setTimeout(() => {
                    if (banner.parentNode) {
                        banner.remove();
                    }
                }, 10000);
            }

            isInstalled() {
                // Check if running as PWA
                return window.matchMedia('(display-mode: standalone)').matches ||
                       window.navigator.standalone === true;
            }

            setupOfflineDetection() {
                const updateOnlineStatus = () => {
                    const isOnline = navigator.onLine;
                    document.documentElement.setAttribute('data-online', isOnline);
                    
                    if (isOnline) {
                        this.handleOnline();
                    } else {
                        this.handleOffline();
                    }
                };

                window.addEventListener('online', updateOnlineStatus);
                window.addEventListener('offline', updateOnlineStatus);
                
                // Initial check
                updateOnlineStatus();
            }

            handleOnline() {
                console.log('PWA: Back online');
                this.showNotification('İnternet bağlantısı geri geldi!', 'success', {
                    duration: 2000
                });
                
                // Process any queued actions
                this.processOfflineQueue();
            }

            handleOffline() {
                console.log('PWA: Gone offline');
                this.showNotification('Offline modda çalışıyorsunuz', 'info', {
                    duration: 3000
                });
            }

            setupBackgroundSync() {
                if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {
                    console.log('PWA: Background sync supported');
                    this.backgroundSyncSupported = true;
                } else {
                    console.log('PWA: Background sync not supported');
                    this.backgroundSyncSupported = false;
                }
            }

            async addToOfflineQueue(qrData) {
                if (!this.backgroundSyncSupported) {
                    console.warn('PWA: Background sync not supported');
                    return false;
                }

                try {
                    const registration = await navigator.serviceWorker.ready;
                    
                    // Add to IndexedDB queue
                    const success = await this.sendMessageToSW({
                        type: 'ADD_TO_QR_QUEUE',
                        data: qrData
                    });

                    if (success) {
                        // Register background sync
                        await registration.sync.register('qr-generation-queue');
                        console.log('PWA: Added to offline queue');
                        return true;
                    }
                } catch (error) {
                    console.error('PWA: Failed to add to offline queue:', error);
                }
                
                return false;
            }

            async processOfflineQueue() {
                try {
                    const registration = await navigator.serviceWorker.ready;
                    await registration.sync.register('qr-generation-queue');
                    console.log('PWA: Processing offline queue');
                } catch (error) {
                    console.error('PWA: Failed to process offline queue:', error);
                }
            }

            async sendMessageToSW(message) {
                return new Promise((resolve) => {
                    const messageChannel = new MessageChannel();
                    messageChannel.port1.onmessage = (event) => {
                        resolve(event.data);
                    };
                    
                    navigator.serviceWorker.controller?.postMessage(message, [messageChannel.port2]);
                });
            }

            handleOfflineQRGenerated(qrData) {
                console.log('PWA: QR generated offline:', qrData);
                this.showNotification('Offline QR kod oluşturuldu!', 'success');
                
                // Update UI if needed
                this.updateHistoryDisplay();
            }

            // Advanced Customization Functions
            toggleGradient(enabled) {
                const gradientControls = document.getElementById('gradient-controls');
                gradientControls.style.display = enabled ? 'flex' : 'none';
            }

            handleLogoUpload(e) {
                // Premium feature check for logo upload
                if (!window.premiumManager.restrictFeature('logoUpload')) {
                    e.target.value = ''; // Clear the file input
                    return;
                }

                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => {
                        this.logoImage = img;
                        const preview = document.getElementById('logo-preview');
                        // XSS Güvenlik Düzeltmesi - DOM element oluşturma
                        preview.innerHTML = '';
                        const logoImg = document.createElement('img');
                        logoImg.src = event.target.result;
                        logoImg.alt = 'Logo';
                        preview.appendChild(logoImg);
                        this.showNotification('Logo yüklendi!', 'success');
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }

            updateMarginDisplay(value) {
                document.getElementById('margin-value').textContent = value + 'px';
            }

            // Template Functions
            selectTemplate(templateId) {
                document.querySelectorAll('.template-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                document.querySelector(`[data-template="${templateId}"]`).classList.add('selected');
                this.selectedTemplate = templateId;
                document.getElementById('apply-template').disabled = false;
            }

            applyTemplate() {
                if (!this.selectedTemplate) return;

                const templates = {
                    classic: { dark: '#1F2937', light: '#FFFFFF' },
                    ocean: { dark: '#667eea', light: '#764ba2', gradient: true },
                    sunset: { dark: '#f093fb', light: '#f5576c', gradient: true },
                    forest: { dark: '#11998e', light: '#38ef7d', gradient: true },
                    gold: { dark: '#f7971e', light: '#ffd200', gradient: true },
                    purple: { dark: '#667db6', light: '#0082c8', gradient: true },
                    restaurant: { dark: '#ff6b6b', light: '#ee5a24', gradient: true },
                    retail: { dark: '#4834d4', light: '#686de0', gradient: true },
                    event: { dark: '#ff9ff3', light: '#f368e0', gradient: true },
                    tech: { dark: '#0be881', light: '#62d2a2', gradient: true }
                };

                const template = templates[this.selectedTemplate];
                if (!template) return;

                // Apply colors
                document.getElementById('color-dark').value = template.dark;
                document.getElementById('color-light').value = template.light;

                // Apply gradient if template has it
                if (template.gradient) {
                    document.getElementById('use-gradient').checked = true;
                    document.getElementById('gradient-start').value = template.dark;
                    document.getElementById('gradient-end').value = template.light;
                    this.toggleGradient(true);
                }

                this.showNotification(`${this.selectedTemplate} şablonu uygulandı!`, 'success');
                this.switchTab('generator');
            }

            // Analytics Functions
            initializeAnalytics() {
                if (!this.analytics.totalGenerated) {
                    this.analytics = {
                        totalGenerated: 0,
                        totalDownloads: 0,
                        typeCount: {},
                        dailyUsage: {},
                        successRate: 100
                    };
                    localStorage.setItem('qr-analytics', JSON.stringify(this.analytics));
                }
            }

            updateAnalytics(action = 'generate', type = null) {
                const today = new Date().toISOString().split('T')[0];
                
                if (action === 'generate') {
                    this.analytics.totalGenerated++;
                    if (type) {
                        this.analytics.typeCount[type] = (this.analytics.typeCount[type] || 0) + 1;
                    }
                } else if (action === 'download') {
                    this.analytics.totalDownloads++;
                } else if (action === 'scan') {
                    this.analytics.totalScans = (this.analytics.totalScans || 0) + 1;
                }

                // Daily usage tracking
                if (!this.analytics.dailyUsage[today]) {
                    this.analytics.dailyUsage[today] = 0;
                }
                this.analytics.dailyUsage[today]++;

                localStorage.setItem('qr-analytics', JSON.stringify(this.analytics));
            }

            updateAnalyticsDisplay() {
                // Update stats
                document.getElementById('total-generated').textContent = this.analytics.totalGenerated || 0;
                document.getElementById('total-downloads').textContent = this.analytics.totalDownloads || 0;
                document.getElementById('total-scans').textContent = this.analytics.totalScans || 0;
                document.getElementById('success-rate').textContent = this.analytics.successRate + '%';

                // Find most used type
                const typeCount = this.analytics.typeCount || {};
                const mostUsed = Object.keys(typeCount).reduce((a, b) => 
                    typeCount[a] > typeCount[b] ? a : b, 'text'
                );
                document.getElementById('most-used-type').textContent = mostUsed || 'Text';

                // Draw charts
                this.drawTypeChart();
                this.drawUsageChart();
            }

            drawTypeChart() {
                const canvas = document.getElementById('type-chart');
                const ctx = canvas.getContext('2d');
                const typeCount = this.analytics.typeCount || {};
                
                // Clear canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const types = Object.keys(typeCount);
                if (types.length === 0) {
                    ctx.fillStyle = '#666';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Henüz veri yok', canvas.width/2, canvas.height/2);
                    return;
                }

                const colors = ['#4F46E5', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#06B6D4'];
                let currentAngle = 0;
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = Math.min(centerX, centerY) - 20;
                
                const total = Object.values(typeCount).reduce((sum, count) => sum + count, 0);
                
                types.forEach((type, index) => {
                    const sliceAngle = (typeCount[type] / total) * 2 * Math.PI;
                    
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = colors[index % colors.length];
                    ctx.fill();
                    
                    currentAngle += sliceAngle;
                });
            }

            drawUsageChart() {
                const canvas = document.getElementById('usage-chart');
                const ctx = canvas.getContext('2d');
                const dailyUsage = this.analytics.dailyUsage || {};
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const dates = Object.keys(dailyUsage).sort().slice(-7); // Last 7 days
                if (dates.length === 0) {
                    ctx.fillStyle = '#666';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Henüz veri yok', canvas.width/2, canvas.height/2);
                    return;
                }
                
                const values = dates.map(date => dailyUsage[date]);
                const maxValue = Math.max(...values);
                const barWidth = canvas.width / dates.length - 10;
                
                dates.forEach((date, index) => {
                    const barHeight = (values[index] / maxValue) * (canvas.height - 40);
                    const x = index * (barWidth + 10) + 5;
                    const y = canvas.height - barHeight - 20;
                    
                    ctx.fillStyle = '#4F46E5';
                    ctx.fillRect(x, y, barWidth, barHeight);
                    
                    // Draw value on top
                    ctx.fillStyle = '#333';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(values[index].toString(), x + barWidth/2, y - 5);
                });
            }

            // Export Functions
            exportAs(format) {
                if (!this.currentQR) {
                    this.showNotification('Önce bir QR kodu oluşturun', 'warning');
                    return;
                }

                switch (format) {
                    case 'png':
                        this.downloadQR();
                        break;
                    case 'svg':
                        this.exportSVG();
                        break;
                    case 'pdf':
                        this.exportPDF();
                        break;
                    case 'webp':
                        this.exportWebP();
                        break;
                }
            }

            exportSVG() {
                // Basic SVG export - in real implementation, you'd need to recreate QR as SVG
                const canvas = this.currentQR.canvas;
                const dataURL = canvas.toDataURL();
                
                const svg = `
                    <svg width="${canvas.width}" height="${canvas.height}" xmlns="http://www.w3.org/2000/svg">
                        <image href="${dataURL}" width="${canvas.width}" height="${canvas.height}"/>
                    </svg>
                `;
                
                const blob = new Blob([svg], { type: 'image/svg+xml' });
                const link = document.createElement('a');
                link.download = `qr-${this.currentType}-${Date.now()}.svg`;
                link.href = URL.createObjectURL(blob);
                link.click();
                
                this.showNotification('SVG export tamamlandı!', 'success');
            }

            exportPDF() {
                // For a full implementation, you'd need jsPDF library
                this.showNotification('PDF export için jsPDF kütüphanesi gerekli', 'info');
            }

            exportWebP() {
                if (this.currentQR.canvas.toBlob) {
                    this.currentQR.canvas.toBlob((blob) => {
                        const link = document.createElement('a');
                        link.download = `qr-${this.currentType}-${Date.now()}.webp`;
                        link.href = URL.createObjectURL(blob);
                        link.click();
                        this.showNotification('WebP export tamamlandı!', 'success');
                    }, 'image/webp', 0.8);
                } else {
                    this.showNotification('WebP desteklenmiyor', 'error');
                }
            }

            // Social Sharing Functions
            shareToSocial(platform) {
                if (!this.currentQR) {
                    this.showNotification('Önce bir QR kodu oluşturun', 'warning');
                    return;
                }

                const siteUrl = window.location.href;
                const text = `QR Kod Generator Pro ile oluşturdum: ${this.currentQR.data}`;
                
                const urls = {
                    twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(siteUrl)}`,
                    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(siteUrl)}`,
                    whatsapp: `https://wa.me/?text=${encodeURIComponent(text + ' ' + siteUrl)}`,
                    telegram: `https://t.me/share/url?url=${encodeURIComponent(siteUrl)}&text=${encodeURIComponent(text)}`
                };

                if (urls[platform]) {
                    window.open(urls[platform], '_blank', 'width=600,height=400');
                    this.showNotification(`${platform} ile paylaştı!`, 'success');
                }
            }

            // New Format Helper Functions
            getCurrentLocation() {
                if (!navigator.geolocation) {
                    this.showNotification('Tarayıcınız konum bilgisini desteklemiyor', 'error');
                    return;
                }

                this.showNotification('Konum bilgisi alınıyor...', 'loading', { persistent: true });
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude.toFixed(6);
                        const lng = position.coords.longitude.toFixed(6);
                        
                        document.getElementById('geo-lat').value = lat;
                        document.getElementById('geo-lng').value = lng;
                        
                        // Try to get address
                        this.reverseGeocode(lat, lng);
                        
                        // Remove loading notification
                        document.querySelectorAll('.notification.loading').forEach(n => n.remove());
                        this.showNotification('Konum bilgisi alındı!', 'success');
                    },
                    (error) => {
                        document.querySelectorAll('.notification.loading').forEach(n => n.remove());
                        let message = 'Konum bilgisi alınamadı: ';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                message += 'Konum izni reddedildi';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                message += 'Konum bilgisi kullanılamıyor';
                                break;
                            case error.TIMEOUT:
                                message += 'İstek zaman aşımına uğradı';
                                break;
                            default:
                                message += 'Bilinmeyen hata';
                                break;
                        }
                        this.showNotification(message, 'error');
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 300000
                    }
                );
            }

            async reverseGeocode(lat, lng) {
                try {
                    // Using a free geocoding service (you might want to use a proper API key)
                    const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`);
                    const data = await response.json();
                    
                    if (data.display_name) {
                        document.getElementById('geo-label').value = data.display_name;
                    }
                } catch (error) {
                    console.warn('Reverse geocoding failed:', error);
                }
            }

            showLocationHelp() {
                const helpText = `
                Konum QR kodları nasıl kullanılır:

                • Enlem ve boylam değerlerini manuel olarak girebilirsiniz
                • "Mevcut Konum" butonuyla GPS konumunuzu alabilirsiniz
                • Konum etiketi, harita uygulamalarında görünecek açıklamadır
                • QR kod tarandığında telefonun harita uygulaması açılır

                Örnek koordinatlar:
                • İstanbul: 41.0082, 28.9784
                • Ankara: 39.9334, 32.8597
                • İzmir: 38.4237, 27.1428

                GPS koordinatları Google Maps, Apple Maps ve diğer harita uygulamaları tarafından desteklenir.
                `;
                
                this.showNotification(helpText, 'info', {
                    duration: 15000,
                    showClose: true
                });
            }

            updateSocialPreview() {
                const platform = document.getElementById('social-platform').value;
                const username = document.getElementById('social-username').value.trim();
                const preview = document.getElementById('social-preview');
                
                if (!username) {
                    preview.textContent = 'Kullanıcı adını girin';
                    return;
                }
                
                const socialUrls = {
                    instagram: `https://instagram.com/${username}`,
                    twitter: `https://twitter.com/${username}`,
                    facebook: `https://facebook.com/${username}`,
                    linkedin: `https://linkedin.com/in/${username}`,
                    youtube: `https://youtube.com/@${username}`,
                    tiktok: `https://tiktok.com/@${username}`,
                    whatsapp: `https://wa.me/${username}`
                };
                
                preview.innerHTML = `<strong>QR kod URL'si:</strong><br>${socialUrls[platform] || 'Desteklenmeyen platform'}`;
            }

            updateAppPreview() {
                const store = document.getElementById('app-store').value;
                const appId = document.getElementById('app-id').value.trim();
                const preview = document.getElementById('app-preview');
                
                if (!appId) {
                    preview.textContent = 'Uygulama ID\'sini girin';
                    return;
                }
                
                const storeUrls = {
                    ios: `https://apps.apple.com/app/id${appId}`,
                    android: `https://play.google.com/store/apps/details?id=${appId}`,
                    huawei: `https://appgallery.cloud.huawei.com/ag/n/app/C${appId}`
                };
                
                const storeNames = {
                    ios: 'App Store',
                    android: 'Google Play',
                    huawei: 'AppGallery'
                };
                
                preview.innerHTML = `<strong>${storeNames[store]} URL'si:</strong><br>${storeUrls[store]}`;
            }

            updateMeetingForm() {
                const platform = document.getElementById('meeting-platform').value;
                const urlInput = document.getElementById('meeting-url');
                
                const placeholders = {
                    zoom: 'https://zoom.us/j/123456789',
                    teams: 'https://teams.microsoft.com/l/meetup-join/...',
                    meet: 'https://meet.google.com/abc-defg-hij',
                    webex: 'https://company.webex.com/meet/...'
                };
                
                urlInput.placeholder = placeholders[platform] || 'Toplantı URL\'sini girin';
            }

            // Enhanced Batch Processing Functions
            switchBatchMethod(method) {
                // Update active tab
                document.querySelectorAll('.method-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelector(`[data-method="${method}"]`).classList.add('active');

                // Show/hide method content
                document.querySelectorAll('.input-method').forEach(content => content.classList.remove('active'));
                document.querySelector(`[data-method="${method}"].input-method`).classList.add('active');
            }

            handleBatchFileUpload(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    const content = event.target.result;
                    const lines = content.split('\n').filter(line => line.trim());
                    
                    document.getElementById('file-preview').innerHTML = 
                        `<strong>${lines.length} satır bulundu:</strong>\n${lines.slice(0, 10).join('\n')}${lines.length > 10 ? '\n...' : ''}`;
                    
                    // Set data for batch generation
                    this.batchData = lines;
                    this.showNotification(`${lines.length} veri yüklendi`, 'success');
                };
                reader.readAsText(file);
            }

            handleCSVUpload(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    const content = event.target.result;
                    const lines = content.split('\n').filter(line => line.trim());
                    const rows = lines.map(line => line.split(','));
                    
                    // Show CSV options
                    const csvOptions = document.getElementById('csv-options');
                    csvOptions.style.display = 'block';
                    
                    // Update column selector
                    const columnSelect = document.getElementById('csv-column');
                    columnSelect.innerHTML = '';
                    if (rows.length > 0) {
                        for (let i = 0; i < rows[0].length; i++) {
                            const option = document.createElement('option');
                            option.value = i;
                            option.textContent = `${i + 1}. Sütun (${rows[0][i] || 'Boş'})`;
                            columnSelect.appendChild(option);
                        }
                    }
                    
                    // Show preview
                    const preview = rows.slice(0, 5).map(row => row.join(' | ')).join('\n');
                    document.getElementById('csv-preview').innerHTML = 
                        `<strong>${rows.length} satır bulundu:</strong>\n${preview}${rows.length > 5 ? '\n...' : ''}`;
                    
                    this.csvData = rows;
                    this.showNotification(`CSV dosyası yüklendi (${rows.length} satır)`, 'success');
                };
                reader.readAsText(file);
            }

            async generateBatch() {
                // Premium feature check for batch generation
                if (!window.premiumManager.restrictFeature('batchLimit')) {
                    return;
                }

                let data = [];
                
                // Get data based on selected method
                const activeMethod = document.querySelector('.method-tab.active').dataset.method;
                
                switch (activeMethod) {
                    case 'manual':
                        const textData = document.getElementById('batch-data').value.trim();
                        data = textData.split('\n').filter(line => line.trim());
                        break;
                    case 'file':
                        data = this.batchData || [];
                        break;
                    case 'csv':
                        if (this.csvData) {
                            const columnIndex = parseInt(document.getElementById('csv-column').value);
                            data = this.csvData.map(row => row[columnIndex]).filter(cell => cell && cell.trim());
                        }
                        break;
                }
                
                if (data.length === 0) {
                    this.showNotification('Lütfen önce veri girin', 'warning');
                    return;
                }

                // Get settings
                const size = parseInt(document.getElementById('batch-size').value);
                const format = document.getElementById('batch-format').value;
                const naming = document.getElementById('batch-naming').value;
                const createZip = document.getElementById('batch-zip').checked;

                // Show progress
                const progressContainer = document.getElementById('batch-progress');
                const progressFill = document.getElementById('progress-fill');
                const progressText = document.getElementById('progress-text');
                progressContainer.style.display = 'block';
                progressFill.style.width = '0%';
                progressText.textContent = `0 / ${data.length}`;

                const resultsContainer = document.getElementById('batch-results');
                resultsContainer.innerHTML = '<h3>📦 Oluşturulan QR Kodları:</h3>';

                this.batchResults = [];
                const batchGrid = document.createElement('div');
                batchGrid.className = 'batch-grid';
                batchGrid.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;';
                resultsContainer.appendChild(batchGrid);

                // Process each item with delay for better UX
                for (let i = 0; i < data.length; i++) {
                    try {
                        const item = data[i];
                        
                        // Create QR code
                        const qr = qrcode(0, 'M');
                        qr.addData(item);
                        qr.make();
                        
                        const canvas = document.createElement('canvas');
                        canvas.width = size;
                        canvas.height = size;
                        const ctx = canvas.getContext('2d');
                        
                        // Draw QR code
                        const modules = qr.getModuleCount();
                        const moduleSize = size / modules;
                        
                        ctx.fillStyle = '#FFFFFF';
                        ctx.fillRect(0, 0, size, size);
                        ctx.fillStyle = '#000000';
                        
                        for (let row = 0; row < modules; row++) {
                            for (let col = 0; col < modules; col++) {
                                if (qr.isDark(row, col)) {
                                    ctx.fillRect(col * moduleSize, row * moduleSize, moduleSize, moduleSize);
                                }
                            }
                        }

                        // Generate filename
                        let filename;
                        switch (naming) {
                            case 'content':
                                filename = item.substring(0, 30).replace(/[^a-zA-Z0-9]/g, '_');
                                break;
                            case 'timestamp':
                                filename = `qr_${Date.now()}_${i}`;
                                break;
                            default:
                                filename = `qr-${i + 1}`;
                        }

                        // Store result
                        this.batchResults.push({
                            canvas: canvas,
                            filename: filename,
                            data: item,
                            format: format
                        });

                        // Create result item
                        const itemDiv = document.createElement('div');
                        itemDiv.style.cssText = 'background: white; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #e1e5e9;';
                        
                        itemDiv.innerHTML = `
                            <div style="margin-bottom: 10px;">
                                <img src="${canvas.toDataURL()}" style="width: 80px; height: 80px; border-radius: 6px;">
                            </div>
                            <div style="font-size: 0.8rem; color: #666; margin-bottom: 8px; word-break: break-all;">${item.substring(0, 40)}${item.length > 40 ? '...' : ''}</div>
                            <button onclick="app.downloadBatchItem(${i})" class="action-btn" style="font-size: 0.8rem; padding: 5px 10px;">
                                <i class="fas fa-download"></i>
                            </button>
                        `;
                        
                        batchGrid.appendChild(itemDiv);
                        
                        // Update progress
                        const progress = ((i + 1) / data.length) * 100;
                        progressFill.style.width = progress + '%';
                        progressText.textContent = `${i + 1} / ${data.length}`;
                        
                        // Small delay for smooth animation
                        await new Promise(resolve => setTimeout(resolve, 50));
                        
                    } catch (error) {
                        console.error(`Batch QR error for item ${i}:`, error);
                    }
                }

                // Show download all button
                document.getElementById('download-all-batch').style.display = 'inline-block';
                
                // Update analytics
                this.updateAnalytics('generate', 'batch');
                
                this.showNotification(`${data.length} QR kodu başarıyla oluşturuldu!`, 'success');
                
                // Hide progress after completion
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 1000);
            }

            downloadBatchItem(index) {
                if (!this.batchResults || !this.batchResults[index]) return;
                
                const item = this.batchResults[index];
                const link = document.createElement('a');
                
                if (item.format === 'svg') {
                    // Basic SVG export
                    const dataURL = item.canvas.toDataURL();
                    const svg = `<svg width="${item.canvas.width}" height="${item.canvas.height}" xmlns="http://www.w3.org/2000/svg">
                        <image href="${dataURL}" width="${item.canvas.width}" height="${item.canvas.height}"/>
                    </svg>`;
                    const blob = new Blob([svg], { type: 'image/svg+xml' });
                    link.href = URL.createObjectURL(blob);
                    link.download = `${item.filename}.svg`;
                } else if (item.format === 'jpg') {
                    link.href = item.canvas.toDataURL('image/jpeg', 0.9);
                    link.download = `${item.filename}.jpg`;
                } else {
                    link.href = item.canvas.toDataURL();
                    link.download = `${item.filename}.png`;
                }
                
                link.click();
                this.updateAnalytics('download');
            }

            async downloadAllBatch() {
                if (!this.batchResults || this.batchResults.length === 0) return;

                const createZip = document.getElementById('batch-zip').checked;
                
                if (createZip) {
                    this.showNotification('ZIP oluşturma özelliği yakında eklenecek', 'info');
                    return;
                }

                // Download all individually
                for (let i = 0; i < this.batchResults.length; i++) {
                    setTimeout(() => {
                        this.downloadBatchItem(i);
                    }, i * 100); // Small delay between downloads
                }
                
                this.showNotification(`${this.batchResults.length} dosya indiriliyor...`, 'success');
            }

            clearBatchResults() {
                document.getElementById('batch-results').innerHTML = '';
                document.getElementById('batch-progress').style.display = 'none';
                document.getElementById('download-all-batch').style.display = 'none';
                this.batchResults = [];
                this.batchData = [];
                this.csvData = [];
                
                // Clear file inputs
                document.getElementById('batch-file').value = '';
                document.getElementById('csv-file').value = '';
                document.getElementById('file-preview').innerHTML = '';
                document.getElementById('csv-preview').innerHTML = '';
                document.getElementById('csv-options').style.display = 'none';
                
                this.showNotification('Batch sonuçları temizlendi', 'info');
            }

            // Enhanced Scanner Functions
            switchScannerMode(mode) {
                this.currentScannerMode = mode;
                
                // Update active button
                document.querySelectorAll('.scanner-mode-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                
                // Show/hide mode content
                document.querySelectorAll('.scanner-mode').forEach(content => content.classList.remove('active'));
                document.querySelector(`[data-mode="${mode}"].scanner-mode`).classList.add('active');
                
                // Stop camera if switching away from camera mode
                if (mode !== 'camera' && this.scannerActive) {
                    this.stopScanner();
                }
            }

            async switchCamera() {
                if (this.availableCameras.length <= 1) return;
                
                this.currentCameraIndex = (this.currentCameraIndex + 1) % this.availableCameras.length;
                
                if (this.scannerActive) {
                    await this.stopScanner();
                    await this.startScanner();
                }
                
                this.showNotification(`Kamera değiştirildi (${this.currentCameraIndex + 1}/${this.availableCameras.length})`, 'info');
            }

            async toggleFlashlight() {
                if (!this.scannerStream) return;

                try {
                    const track = this.scannerStream.getVideoTracks()[0];
                    const capabilities = track.getCapabilities();
                    
                    if (capabilities.torch) {
                        this.flashlightOn = !this.flashlightOn;
                        await track.applyConstraints({
                            advanced: [{ torch: this.flashlightOn }]
                        });
                        
                        const flashBtn = document.getElementById('flashlight');
                        flashBtn.style.backgroundColor = this.flashlightOn ? '#fbbf24' : '';
                        this.showNotification(this.flashlightOn ? 'Fener açıldı' : 'Fener kapatıldı', 'info');
                    } else {
                        this.showNotification('Fener desteklenmiyor', 'warning');
                    }
                } catch (error) {
                    this.showNotification('Fener kontrolü başarısız', 'error');
                }
            }

            handleQRFileUpload(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => {
                        document.getElementById('preview-image').src = event.target.result;
                        document.getElementById('file-preview').style.display = 'block';
                        this.scanFromImage(img);
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }

            handleDragOver(e) {
                e.preventDefault();
                e.currentTarget.classList.add('dragover');
            }

            handleFileDrop(e) {
                e.preventDefault();
                e.currentTarget.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.type.startsWith('image/')) {
                        // Simulate file input
                        const fileInput = document.getElementById('qr-file-input');
                        const dt = new DataTransfer();
                        dt.items.add(file);
                        fileInput.files = dt.files;
                        
                        this.handleQRFileUpload({ target: fileInput });
                    } else {
                        this.showNotification('Lütfen bir resim dosyası seçin', 'warning');
                    }
                }
            }

            async scanFromURL() {
                const url = document.getElementById('qr-url-input').value.trim();
                if (!url) {
                    this.showNotification('Lütfen geçerli bir URL girin', 'warning');
                    return;
                }

                try {
                    const img = new Image();
                    img.crossOrigin = 'anonymous';
                    img.onload = () => {
                        document.getElementById('url-image').src = url;
                        document.getElementById('url-preview').style.display = 'block';
                        this.scanFromImage(img);
                    };
                    img.onerror = () => {
                        this.showNotification('Resim yüklenemedi', 'error');
                    };
                    img.src = url;
                } catch (error) {
                    this.showNotification('URL taraması başarısız', 'error');
                }
            }

            scanFromImage(img) {
                try {
                    const canvas = document.getElementById('scanner-canvas');
                    const ctx = canvas.getContext('2d');
                    
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, imageData.height);
                    
                    if (code) {
                        this.handleScanResult(code.data);
                        this.showNotification('QR kod başarıyla okundu!', 'success');
                    } else {
                        this.showNotification('QR kod bulunamadı', 'warning');
                    }
                } catch (error) {
                    console.error('Scan error:', error);
                    this.showNotification('Tarama sırasında hata oluştu', 'error');
                }
            }

            handleScanResult(data) {
                // Display result
                document.getElementById('scanned-data').textContent = data;
                document.getElementById('scanner-result').classList.add('has-result');
                document.getElementById('scanner-result-actions').style.display = 'flex';
                
                // Add to history if enabled
                if (document.getElementById('scanner-history').checked) {
                    this.addToScanHistory(data);
                }
                
                // Play sound if enabled
                if (document.getElementById('scanner-sound').checked) {
                    this.playScanSound();
                }
                
                // Analytics
                this.updateAnalytics('scan');
                
                this.currentScanResult = data;
            }

            addToScanHistory(data) {
                const historyItem = {
                    id: Date.now(),
                    data: data,
                    timestamp: new Date().toLocaleString('tr-TR'),
                    type: this.detectQRType(data)
                };
                
                this.scanHistory.unshift(historyItem);
                
                // Keep only last 50 scans
                this.scanHistory = this.scanHistory.slice(0, 50);
                
                localStorage.setItem('scan-history', JSON.stringify(this.scanHistory));
                this.updateScanHistoryDisplay();
            }

            detectQRType(data) {
                if (data.startsWith('http://') || data.startsWith('https://')) return 'URL';
                if (data.startsWith('mailto:')) return 'Email';
                if (data.startsWith('tel:')) return 'Telefon';
                if (data.startsWith('WIFI:')) return 'WiFi';
                if (data.startsWith('BEGIN:VCARD')) return 'vCard';
                if (data.startsWith('BEGIN:VEVENT')) return 'Etkinlik';
                return 'Metin';
            }

            updateScanHistoryDisplay() {
                const historyList = document.getElementById('scan-history-list');
                
                if (this.scanHistory.length === 0) {
                    historyList.innerHTML = '<p style="text-align: center; color: #999;">Henüz tarama yapılmadı</p>';
                    return;
                }
                
                // XSS Güvenlik Düzeltmesi - innerHTML yerine güvenli DOM oluşturma
                historyList.innerHTML = '';
                this.scanHistory.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'scan-history-item';
                    
                    const typeDiv = document.createElement('div');
                    typeDiv.style.fontWeight = '500';
                    typeDiv.textContent = item.type; // XSS safe
                    
                    const dataDiv = document.createElement('div');
                    dataDiv.style.cssText = 'font-size: 0.8rem; color: #666; margin-top: 2px;';
                    const displayData = item.data.length > 40 ? item.data.substring(0, 40) + '...' : item.data;
                    dataDiv.textContent = displayData; // XSS safe
                    
                    const containerDiv = document.createElement('div');
                    containerDiv.appendChild(typeDiv);
                    containerDiv.appendChild(dataDiv);
                    
                    const timestampDiv = document.createElement('div');
                    timestampDiv.className = 'scan-timestamp';
                    timestampDiv.textContent = item.timestamp; // XSS safe
                    
                    historyItem.appendChild(containerDiv);
                    historyItem.appendChild(timestampDiv);
                    
                    // Click handler'ı güvenli şekilde ekle
                    historyItem.addEventListener('click', () => {
                        this.selectScanHistoryItem(item.data);
                    });
                    
                    historyList.appendChild(historyItem);
                });
            }

            selectScanHistoryItem(data) {
                this.handleScanResult(data);
            }

            playScanSound() {
                // Create a simple beep sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.2);
            }

            openScannedData() {
                if (!this.currentScanResult) return;
                
                if (this.currentScanResult.startsWith('http://') || this.currentScanResult.startsWith('https://')) {
                    window.open(this.currentScanResult, '_blank');
                } else if (this.currentScanResult.startsWith('mailto:')) {
                    window.location.href = this.currentScanResult;
                } else if (this.currentScanResult.startsWith('tel:')) {
                    window.location.href = this.currentScanResult;
                } else {
                    this.showNotification('Bu veri türü açılamaz', 'info');
                }
            }

            createQRFromScan() {
                if (!this.currentScanResult) return;
                
                // Switch to generator tab
                this.switchTab('generator');
                
                // Set the scanned data
                document.getElementById('text-input').value = this.currentScanResult;
                document.querySelector('[data-type="text"]').click();
                
                this.showNotification('Veriler generator\'e aktarıldı', 'success');
            }

            saveScanResult() {
                if (!this.currentScanResult) return;
                
                const blob = new Blob([this.currentScanResult], { type: 'text/plain' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `qr-scan-${Date.now()}.txt`;
                link.click();
                
                this.showNotification('Tarama sonucu kaydedildi', 'success');
            }

            clearScanHistory() {
                this.scanHistory = [];
                localStorage.removeItem('scan-history');
                this.updateScanHistoryDisplay();
                this.showNotification('Tarama geçmişi temizlendi', 'info');
            }
        }

        // Advanced Theme Manager
        class ThemeManager {
            constructor() {
                this.currentTheme = 'auto';
                this.themes = ['light', 'dark', 'auto', 'high-contrast'];
                this.systemPreference = null;
                this.init();
            }

            init() {
                this.loadSavedTheme();
                this.setupSystemPreferenceListener();
                this.bindEvents();
                this.applyTheme(this.currentTheme);
                this.updateThemeIndicator();
            }

            loadSavedTheme() {
                const saved = localStorage.getItem('qr-theme-preference');
                if (saved && this.themes.includes(saved)) {
                    this.currentTheme = saved;
                } else {
                    // Auto-detect based on system preference
                    this.currentTheme = 'auto';
                }
            }

            setupSystemPreferenceListener() {
                this.systemPreference = window.matchMedia('(prefers-color-scheme: dark)');
                
                // Listen for system theme changes
                this.systemPreference.addEventListener('change', (e) => {
                    if (this.currentTheme === 'auto') {
                        this.applyTheme('auto');
                        this.announceThemeChange();
                    }
                });

                // Listen for high contrast preference
                const highContrastPreference = window.matchMedia('(prefers-contrast: high)');
                highContrastPreference.addEventListener('change', (e) => {
                    if (e.matches && this.currentTheme === 'auto') {
                        this.setTheme('high-contrast');
                    }
                });
            }

            bindEvents() {
                // Theme toggle button
                const themeToggle = document.getElementById('theme-toggle');
                const themeSelector = document.getElementById('theme-selector');

                if (themeToggle) {
                    themeToggle.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleThemeSelector();
                    });
                }

                // Theme options
                document.addEventListener('click', (e) => {
                    if (e.target.matches('.theme-option')) {
                        const theme = e.target.dataset.theme;
                        this.setTheme(theme);
                        this.hideThemeSelector();
                    } else if (!e.target.closest('.theme-controls')) {
                        this.hideThemeSelector();
                    }
                });

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    // Ctrl/Cmd + Shift + T for theme toggle
                    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key.toLowerCase() === 't') {
                        e.preventDefault();
                        this.cycleTheme();
                    }

                    // Escape to close theme selector
                    if (e.key === 'Escape') {
                        this.hideThemeSelector();
                    }
                });
            }

            setTheme(theme) {
                if (!this.themes.includes(theme)) {
                    console.warn('Invalid theme:', theme);
                    return;
                }

                this.currentTheme = theme;
                this.applyTheme(theme);
                this.saveTheme(theme);
                this.updateThemeIndicator();
                this.announceThemeChange();

                // Track theme usage
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'theme_changed', {
                        'event_category': 'UI',
                        'event_label': theme,
                        'value': 1
                    });
                }
            }

            applyTheme(theme) {
                const html = document.documentElement;
                
                // Remove all theme classes
                this.themes.forEach(t => {
                    html.classList.remove(`theme-${t}`);
                });

                // Apply new theme
                html.setAttribute('data-theme', theme);
                html.classList.add(`theme-${theme}`);

                // Handle auto theme
                if (theme === 'auto') {
                    const isDarkMode = this.systemPreference?.matches || false;
                    html.setAttribute('data-effective-theme', isDarkMode ? 'dark' : 'light');
                } else {
                    html.setAttribute('data-effective-theme', theme);
                }

                // Update meta theme color
                this.updateMetaThemeColor(theme);
                
                // Trigger custom event
                window.dispatchEvent(new CustomEvent('themechange', {
                    detail: { theme, effectiveTheme: html.getAttribute('data-effective-theme') }
                }));
            }

            updateMetaThemeColor(theme) {
                const metaThemeColor = document.querySelector('meta[name="theme-color"]');
                if (!metaThemeColor) return;

                const colors = {
                    light: '#4338CA',
                    dark: '#6366F1',
                    'high-contrast': '#0000FF',
                    auto: this.systemPreference?.matches ? '#6366F1' : '#4338CA'
                };

                metaThemeColor.setAttribute('content', colors[theme] || colors.light);
            }

            saveTheme(theme) {
                try {
                    localStorage.setItem('qr-theme-preference', theme);
                } catch (error) {
                    console.warn('Failed to save theme preference:', error);
                }
            }

            cycleTheme() {
                const currentIndex = this.themes.indexOf(this.currentTheme);
                const nextIndex = (currentIndex + 1) % this.themes.length;
                this.setTheme(this.themes[nextIndex]);
            }

            toggleThemeSelector() {
                const selector = document.getElementById('theme-selector');
                if (selector) {
                    selector.classList.toggle('active');
                    
                    // Focus management
                    if (selector.classList.contains('active')) {
                        const firstOption = selector.querySelector('.theme-option');
                        if (firstOption) {
                            firstOption.focus();
                        }
                    }
                }
            }

            hideThemeSelector() {
                const selector = document.getElementById('theme-selector');
                if (selector) {
                    selector.classList.remove('active');
                }
            }

            updateThemeIndicator() {
                // Update active theme option
                document.querySelectorAll('.theme-option').forEach(option => {
                    const isActive = option.dataset.theme === this.currentTheme;
                    option.classList.toggle('active', isActive);
                    option.setAttribute('aria-pressed', isActive);
                });

                // Update theme toggle icon
                const toggle = document.getElementById('theme-toggle');
                if (toggle) {
                    const effectiveTheme = document.documentElement.getAttribute('data-effective-theme');
                    toggle.setAttribute('aria-label', `Mevcut tema: ${this.getThemeDisplayName(this.currentTheme)}`);
                    toggle.setAttribute('title', `Mevcut tema: ${this.getThemeDisplayName(this.currentTheme)}`);
                }
            }

            getThemeDisplayName(theme) {
                const names = {
                    light: 'Açık',
                    dark: 'Koyu',
                    auto: 'Otomatik',
                    'high-contrast': 'Yüksek Kontrast'
                };
                return names[theme] || theme;
            }

            announceThemeChange() {
                // Announce theme change to screen readers
                if (window.accessibilityManager) {
                    const themeName = this.getThemeDisplayName(this.currentTheme);
                    window.accessibilityManager.announce(`Tema değiştirildi: ${themeName}`, 'polite');
                }
            }

            // Dynamic theme adjustment based on time
            setupAutoThemeSchedule() {
                const now = new Date();
                const hours = now.getHours();
                
                // Auto dark mode between 7 PM and 7 AM
                if (this.currentTheme === 'auto') {
                    const shouldBeDark = hours >= 19 || hours <= 7;
                    
                    if (shouldBeDark && !this.systemPreference?.matches) {
                        this.applyTheme('dark');
                        setTimeout(() => this.applyTheme('auto'), 60000); // Revert after 1 minute
                    }
                }
            }

            // Get contrast ratio for accessibility
            getContrastRatio(color1, color2) {
                const getLuminance = (color) => {
                    const rgb = parseInt(color.replace('#', ''), 16);
                    const r = (rgb >> 16) & 0xff;
                    const g = (rgb >>  8) & 0xff;
                    const b = (rgb >>  0) & 0xff;
                    
                    const [rs, gs, bs] = [r, g, b].map(c => {
                        c = c / 255;
                        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
                    });
                    
                    return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
                };
                
                const lum1 = getLuminance(color1);
                const lum2 = getLuminance(color2);
                const brightest = Math.max(lum1, lum2);
                const darkest = Math.min(lum1, lum2);
                
                return (brightest + 0.05) / (darkest + 0.05);
            }

            // Enhanced theme validation
            validateThemeAccessibility() {
                const styles = getComputedStyle(document.documentElement);
                const bgColor = styles.getPropertyValue('--bg-primary');
                const textColor = styles.getPropertyValue('--text-primary');
                
                // Check contrast ratio (WCAG AA requires 4.5:1 for normal text)
                const contrast = this.getContrastRatio(bgColor, textColor);
                
                if (contrast < 4.5) {
                    console.warn(`Theme accessibility warning: Contrast ratio ${contrast.toFixed(2)} is below WCAG AA standard (4.5:1)`);
                }
                
                return contrast >= 4.5;
            }
        }

        // AI-Powered QR Code Optimizer
        class QROptimizer {
            constructor() {
                this.optimizationHistory = [];
                this.performanceMetrics = {};
                this.init();
            }

            init() {
                this.loadOptimizationData();
                this.setupPerformanceTracking();
            }

            loadOptimizationData() {
                const saved = localStorage.getItem('qr-optimization-data');
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        this.optimizationHistory = data.history || [];
                        this.performanceMetrics = data.metrics || {};
                    } catch (error) {
                        console.warn('Failed to load optimization data:', error);
                    }
                }
            }

            saveOptimizationData() {
                try {
                    localStorage.setItem('qr-optimization-data', JSON.stringify({
                        history: this.optimizationHistory,
                        metrics: this.performanceMetrics
                    }));
                } catch (error) {
                    console.warn('Failed to save optimization data:', error);
                }
            }

            // AI-powered content optimization
            optimizeQRContent(data, type) {
                const optimization = {
                    original: data,
                    optimized: data,
                    improvements: [],
                    efficiency: 1.0,
                    timestamp: Date.now()
                };

                switch (type) {
                    case 'url':
                        optimization.optimized = this.optimizeURL(data);
                        break;
                    case 'text':
                        optimization.optimized = this.optimizeText(data);
                        break;
                    case 'email':
                        optimization.optimized = this.optimizeEmail(data);
                        break;
                    case 'phone':
                        optimization.optimized = this.optimizePhone(data);
                        break;
                    case 'wifi':
                        optimization.optimized = this.optimizeWiFi(data);
                        break;
                    default:
                        optimization.optimized = this.optimizeGeneric(data);
                }

                // Calculate efficiency improvement
                optimization.efficiency = this.calculateEfficiency(
                    optimization.original, 
                    optimization.optimized
                );

                // Store optimization
                this.optimizationHistory.push(optimization);
                this.saveOptimizationData();

                return optimization;
            }

            optimizeURL(url) {
                let optimized = url;
                const improvements = [];

                // Remove unnecessary parameters
                try {
                    const urlObj = new URL(url);
                    
                    // Common tracking parameters to remove
                    const trackingParams = [
                        'utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content',
                        'fbclid', 'gclid', 'msclkid', '_ga', 'mc_eid', 'mc_cid'
                    ];

                    trackingParams.forEach(param => {
                        if (urlObj.searchParams.has(param)) {
                            urlObj.searchParams.delete(param);
                            improvements.push(`Removed tracking parameter: ${param}`);
                        }
                    });

                    // Remove default ports
                    if ((urlObj.protocol === 'https:' && urlObj.port === '443') ||
                        (urlObj.protocol === 'http:' && urlObj.port === '80')) {
                        urlObj.port = '';
                        improvements.push('Removed default port');
                    }

                    // Remove trailing slash if not needed
                    if (urlObj.pathname === '/') {
                        urlObj.pathname = '';
                        improvements.push('Removed trailing slash');
                    }

                    optimized = urlObj.toString();

                } catch (error) {
                    console.warn('URL optimization failed:', error);
                }

                // Suggest URL shortening for very long URLs
                if (optimized.length > 100) {
                    improvements.push('Consider using a URL shortener for better QR readability');
                }

                return { optimized, improvements };
            }

            optimizeText(text) {
                let optimized = text.trim();
                const improvements = [];

                // Remove excessive whitespace
                if (/\s{2,}/.test(optimized)) {
                    optimized = optimized.replace(/\s+/g, ' ');
                    improvements.push('Normalized whitespace');
                }

                // Remove common redundant words for QR codes
                const redundantPatterns = [
                    /^(scan this|qr code|here is|this is)\s+/i,
                    /\s+(qr code|code)$/i
                ];

                redundantPatterns.forEach(pattern => {
                    if (pattern.test(optimized)) {
                        optimized = optimized.replace(pattern, '');
                        improvements.push('Removed redundant QR text');
                    }
                });

                // Suggest abbreviations for common words
                const abbreviations = {
                    'information': 'info',
                    'telephone': 'tel',
                    'website': 'site',
                    'address': 'addr'
                };

                Object.entries(abbreviations).forEach(([full, abbr]) => {
                    const regex = new RegExp(`\\b${full}\\b`, 'gi');
                    if (regex.test(optimized) && optimized.length > 50) {
                        improvements.push(`Consider abbreviating "${full}" to "${abbr}"`);
                    }
                });

                return { optimized, improvements };
            }

            optimizeEmail(emailData) {
                // Parse email data
                const improvements = [];
                let optimized = emailData;

                // Extract email components
                const emailMatch = emailData.match(/mailto:([^?]+)(\?.*)?/);
                if (emailMatch) {
                    const email = emailMatch[1];
                    const params = emailMatch[2] || '';

                    // Optimize email parameters
                    if (params.includes('subject=')) {
                        const urlParams = new URLSearchParams(params.substring(1));
                        const subject = urlParams.get('subject');
                        
                        if (subject && subject.length > 50) {
                            improvements.push('Consider shortening email subject for better QR readability');
                        }
                    }
                }

                return { optimized, improvements };
            }

            optimizePhone(phone) {
                let optimized = phone;
                const improvements = [];

                // Standardize phone format
                const cleaned = phone.replace(/[\s\-\(\)]/g, '');
                if (cleaned !== phone) {
                    optimized = cleaned;
                    improvements.push('Standardized phone number format');
                }

                // Add tel: protocol if missing
                if (!phone.startsWith('tel:')) {
                    optimized = `tel:${optimized}`;
                    improvements.push('Added tel: protocol for better mobile compatibility');
                }

                return { optimized, improvements };
            }

            optimizeWiFi(wifiData) {
                // WiFi QR codes have a specific format: WIFI:T:WPA;S:network_name;P:password;H:;
                const improvements = [];
                let optimized = wifiData;

                // Check for hidden network flag optimization
                if (wifiData.includes('H:false') || wifiData.includes('H:0')) {
                    optimized = wifiData.replace(/H:(false|0)/, 'H:');
                    improvements.push('Optimized hidden network flag');
                }

                // Check for unnecessary semicolons
                if (wifiData.endsWith(';;')) {
                    optimized = optimized.replace(/;+$/, ';');
                    improvements.push('Removed excessive semicolons');
                }

                return { optimized, improvements };
            }

            optimizeGeneric(data) {
                const improvements = [];
                let optimized = data.trim();

                // Basic optimizations
                if (optimized !== data) {
                    improvements.push('Trimmed whitespace');
                }

                return { optimized, improvements };
            }

            // Calculate QR code efficiency
            calculateEfficiency(original, optimized) {
                if (typeof optimized === 'object') {
                    optimized = optimized.optimized || optimized;
                }

                if (original.length === 0) return 1;
                
                const reduction = (original.length - optimized.length) / original.length;
                return 1 + Math.max(0, reduction); // 1.0 = no change, >1.0 = improvement
            }

            // Smart QR size recommendation
            recommendQRSize(data, targetDistance = 'arm') {
                const dataLength = data.length;
                let recommendedSize;

                // Size recommendations based on data density and viewing distance
                const sizeMatrix = {
                    arm: { // 30cm viewing distance
                        small: { max: 25, size: 128 },
                        medium: { max: 100, size: 192 },
                        large: { max: 300, size: 256 },
                        xlarge: { max: Infinity, size: 384 }
                    },
                    desk: { // 60cm viewing distance  
                        small: { max: 25, size: 192 },
                        medium: { max: 100, size: 256 },
                        large: { max: 300, size: 384 },
                        xlarge: { max: Infinity, size: 512 }
                    },
                    room: { // 2m+ viewing distance
                        small: { max: 25, size: 256 },
                        medium: { max: 100, size: 384 },
                        large: { max: 300, size: 512 },
                        xlarge: { max: Infinity, size: 768 }
                    }
                };

                const distances = sizeMatrix[targetDistance] || sizeMatrix.arm;
                
                for (const [size, config] of Object.entries(distances)) {
                    if (dataLength <= config.max) {
                        recommendedSize = config.size;
                        break;
                    }
                }

                return recommendedSize || 256;
            }

            // Error correction level optimization
            optimizeErrorCorrection(data, usage = 'general') {
                const dataLength = data.length;
                let recommendedLevel;

                // Usage-based recommendations
                switch (usage) {
                    case 'print': // May get damaged
                        recommendedLevel = dataLength < 50 ? 'H' : 'Q';
                        break;
                    case 'digital': // Clean environment
                        recommendedLevel = dataLength < 100 ? 'M' : 'L';
                        break;
                    case 'outdoor': // May get dirty/damaged
                        recommendedLevel = 'H';
                        break;
                    case 'general':
                    default:
                        if (dataLength < 25) recommendedLevel = 'Q';
                        else if (dataLength < 100) recommendedLevel = 'M';
                        else recommendedLevel = 'L';
                        break;
                }

                return recommendedLevel;
            }

            // Performance tracking
            setupPerformanceTracking() {
                this.performanceMetrics = {
                    totalOptimizations: 0,
                    averageImprovement: 0,
                    popularTypes: {},
                    successfulOptimizations: 0
                };
            }

            trackOptimization(type, improvement) {
                this.performanceMetrics.totalOptimizations++;
                
                if (improvement > 1.0) {
                    this.performanceMetrics.successfulOptimizations++;
                }

                // Update averages
                const currentAvg = this.performanceMetrics.averageImprovement;
                const count = this.performanceMetrics.totalOptimizations;
                this.performanceMetrics.averageImprovement = 
                    (currentAvg * (count - 1) + improvement) / count;

                // Track popular types
                this.performanceMetrics.popularTypes[type] = 
                    (this.performanceMetrics.popularTypes[type] || 0) + 1;

                this.saveOptimizationData();
            }

            // Get optimization suggestions
            getOptimizationSuggestions(data, type, context = {}) {
                const suggestions = [];
                const analysis = this.analyzeQRComplexity(data);

                // Size-based suggestions
                if (analysis.complexity === 'high') {
                    suggestions.push({
                        type: 'size',
                        message: 'Consider using a larger QR size for better readability',
                        recommendation: this.recommendQRSize(data, context.distance)
                    });
                }

                // Error correction suggestions
                const errorLevel = this.optimizeErrorCorrection(data, context.usage);
                suggestions.push({
                    type: 'error-correction',
                    message: `Recommended error correction level: ${errorLevel}`,
                    recommendation: errorLevel
                });

                // Type-specific suggestions
                if (type === 'url' && data.length > 150) {
                    suggestions.push({
                        type: 'url-shortening',
                        message: 'Long URLs create dense QR codes. Consider using a URL shortener.',
                        action: 'shorten-url'
                    });
                }

                return suggestions;
            }

            analyzeQRComplexity(data) {
                const length = data.length;
                let complexity;

                if (length < 25) complexity = 'low';
                else if (length < 100) complexity = 'medium';
                else complexity = 'high';

                return {
                    complexity,
                    length,
                    estimatedModules: Math.ceil(Math.sqrt(length * 8))
                };
            }
        }

        // Viral Marketing & Social Sharing System
        class ViralManager {
            constructor() {
                this.shareData = {};
                this.socialMetrics = {
                    shares: 0,
                    referrals: 0,
                    viral_coefficient: 0
                };
                this.init();
            }

            init() {
                this.loadSocialMetrics();
                this.setupSocialSharing();
                this.setupReferralTracking();
                this.setupViralCampaigns();
                this.initializeShareButtons();
            }

            loadSocialMetrics() {
                const saved = localStorage.getItem('viral-metrics');
                if (saved) {
                    try {
                        this.socialMetrics = { ...this.socialMetrics, ...JSON.parse(saved) };
                    } catch (error) {
                        console.warn('Failed to load viral metrics:', error);
                    }
                }
            }

            saveSocialMetrics() {
                try {
                    localStorage.setItem('viral-metrics', JSON.stringify(this.socialMetrics));
                } catch (error) {
                    console.warn('Failed to save viral metrics:', error);
                }
            }

            // Advanced Social Sharing System
            setupSocialSharing() {
                // Add share buttons to QR results
                this.addShareButtonsToUI();
                
                // Native Web Share API support
                if ('share' in navigator) {
                    this.setupNativeSharing();
                }
            }

            addShareButtonsToUI() {
                const shareHTML = `
                    <div class="viral-share-section" id="viral-share-section" style="display: none;">
                        <h3><i class="fas fa-share-alt"></i> QR Kodunuzu Paylaşın ve Ödüller Kazanın!</h3>
                        <div class="viral-stats">
                            <div class="stat">
                                <span class="stat-number" id="total-shares">0</span>
                                <span class="stat-label">Toplam Paylaşım</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="viral-score">0</span>
                                <span class="stat-label">Viral Skor</span>
                            </div>
                        </div>
                        <div class="share-buttons">
                            <button class="share-btn twitter" onclick="viralManager.shareToTwitter()">
                                <i class="fab fa-twitter"></i> Twitter'da Paylaş
                            </button>
                            <button class="share-btn facebook" onclick="viralManager.shareToFacebook()">
                                <i class="fab fa-facebook"></i> Facebook'ta Paylaş
                            </button>
                            <button class="share-btn linkedin" onclick="viralManager.shareToLinkedIn()">
                                <i class="fab fa-linkedin"></i> LinkedIn'de Paylaş
                            </button>
                            <button class="share-btn whatsapp" onclick="viralManager.shareToWhatsApp()">
                                <i class="fab fa-whatsapp"></i> WhatsApp'ta Paylaş
                            </button>
                            <button class="share-btn native" id="native-share" onclick="viralManager.shareNative()" style="display: none;">
                                <i class="fas fa-share"></i> Paylaş
                            </button>
                            <button class="share-btn copy-link" onclick="viralManager.copyShareLink()">
                                <i class="fas fa-copy"></i> Link Kopyala
                            </button>
                        </div>
                        
                        <!-- Viral Incentives -->
                        <div class="viral-incentives">
                            <div class="incentive-card">
                                <i class="fas fa-gift"></i>
                                <h4>Referral Bonus!</h4>
                                <p>5 kişi linkine tıklarsa premium özelliklere 1 hafta ücretsiz erişim!</p>
                            </div>
                            <div class="incentive-card">
                                <i class="fas fa-trophy"></i>
                                <h4>Viral Challenge!</h4>
                                <p>Bu ayın en çok paylaşılan QR kodu sahibi özel rozet kazanır!</p>
                            </div>
                        </div>
                    </div>
                `;

                // Add to QR actions section
                const qrActions = document.getElementById('qr-actions');
                if (qrActions) {
                    qrActions.insertAdjacentHTML('afterend', shareHTML);
                }
            }

            setupNativeSharing() {
                const nativeShareBtn = document.getElementById('native-share');
                if (nativeShareBtn && 'share' in navigator) {
                    nativeShareBtn.style.display = 'inline-flex';
                }
            }

            // Social Platform Sharing Functions
            shareToTwitter() {
                const qrData = window.app?.currentQR?.data || '';
                const text = this.generateShareText('twitter', qrData);
                const url = this.generateShareURL();
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}&hashtags=QRCode,QRGenerator,Tech,Free`;
                
                this.openShareWindow(twitterUrl, 'twitter');
                this.trackShare('twitter');
            }

            shareToFacebook() {
                const url = this.generateShareURL();
                const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
                
                this.openShareWindow(facebookUrl, 'facebook');
                this.trackShare('facebook');
            }

            shareToLinkedIn() {
                const qrData = window.app?.currentQR?.data || '';
                const text = this.generateShareText('linkedin', qrData);
                const url = this.generateShareURL();
                
                const linkedInUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}&title=${encodeURIComponent('QR Generator Pro ile QR Kod Oluşturdum!')}&summary=${encodeURIComponent(text)}`;
                
                this.openShareWindow(linkedInUrl, 'linkedin');
                this.trackShare('linkedin');
            }

            shareToWhatsApp() {
                const qrData = window.app?.currentQR?.data || '';
                const text = this.generateShareText('whatsapp', qrData);
                const url = this.generateShareURL();
                
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`;
                
                window.open(whatsappUrl, '_blank');
                this.trackShare('whatsapp');
            }

            async shareNative() {
                if (!('share' in navigator)) return;
                
                try {
                    const qrData = window.app?.currentQR?.data || '';
                    const shareData = {
                        title: 'QR Generator Pro ile Oluşturulan QR Kod',
                        text: this.generateShareText('native', qrData),
                        url: this.generateShareURL()
                    };
                    
                    await navigator.share(shareData);
                    this.trackShare('native');
                } catch (error) {
                    console.log('Native sharing cancelled or failed:', error);
                }
            }

            copyShareLink() {
                const url = this.generateShareURL();
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(url).then(() => {
                        this.showShareNotification('Link kopyalandı! 📋');
                        this.trackShare('copy');
                    });
                } else {
                    // Fallback for older browsers
                    const textArea = document.createElement('textarea');
                    textArea.value = url;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    this.showShareNotification('Link kopyalandı! 📋');
                    this.trackShare('copy');
                }
            }

            generateShareText(platform, qrData) {
                const texts = {
                    twitter: '🚀 QR Generator Pro ile harika bir QR kod oluşturdum! AI destekli, tema seçenekleri, offline çalışma ve daha fazlası. Siz de deneyin!',
                    facebook: 'QR Generator Pro\'yu keşfettim! Gerçekten kullanışlı bir araç. AI optimizasyonu, profesyonel temalar ve offline destek. Tavsiye ederim!',
                    linkedin: 'İş projelerim için QR Generator Pro kullanıyorum. Professional QR kodlar, analytics ve güvenli altyapı. Harika bir araç!',
                    whatsapp: '🔥 Bu QR generator\'ı denemelisin! QR Generator Pro - AI destekli, ücretsiz ve çok kullanışlı.',
                    native: 'QR Generator Pro ile oluşturulan profesyonel QR kod'
                };
                
                return texts[platform] || texts.native;
            }

            generateShareURL() {
                const baseUrl = 'https://qrgenerator-pro.com';
                const referralCode = this.generateReferralCode();
                return `${baseUrl}?ref=${referralCode}&utm_source=share&utm_medium=social&utm_campaign=viral`;
            }

            generateReferralCode() {
                // Generate or retrieve user's referral code
                let referralCode = localStorage.getItem('user-referral-code');
                if (!referralCode) {
                    referralCode = 'usr' + Math.random().toString(36).substr(2, 8);
                    localStorage.setItem('user-referral-code', referralCode);
                }
                return referralCode;
            }

            openShareWindow(url, platform) {
                const width = 600;
                const height = 400;
                const left = (screen.width - width) / 2;
                const top = (screen.height - height) / 2;
                
                window.open(
                    url,
                    `share-${platform}`,
                    `width=${width},height=${height},left=${left},top=${top},scrollbars=yes,resizable=yes`
                );
            }

            trackShare(platform) {
                this.socialMetrics.shares++;
                
                // Platform specific tracking
                const platformKey = `shares_${platform}`;
                this.socialMetrics[platformKey] = (this.socialMetrics[platformKey] || 0) + 1;
                
                this.updateViralScore();
                this.saveSocialMetrics();
                this.updateShareUI();
                
                // Analytics tracking
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'share', {
                        'event_category': 'Social',
                        'event_label': platform,
                        'value': 1
                    });
                }
                
                this.showShareNotification(`${platform.charAt(0).toUpperCase() + platform.slice(1)} üzerinde paylaşıldı! 🎉`);
            }

            updateViralScore() {
                // Calculate viral coefficient
                const totalShares = this.socialMetrics.shares;
                const referrals = this.socialMetrics.referrals;
                
                this.socialMetrics.viral_coefficient = referrals > 0 ? totalShares / referrals : totalShares * 0.1;
            }

            updateShareUI() {
                document.getElementById('total-shares').textContent = this.socialMetrics.shares;
                document.getElementById('viral-score').textContent = Math.round(this.socialMetrics.viral_coefficient * 100);
            }

            setupReferralTracking() {
                // Check for referral parameter in URL
                const urlParams = new URLSearchParams(window.location.search);
                const referralCode = urlParams.get('ref');
                
                if (referralCode) {
                    this.trackReferral(referralCode);
                }
            }

            trackReferral(referralCode) {
                // Track incoming referral
                const referralData = {
                    code: referralCode,
                    timestamp: Date.now(),
                    userAgent: navigator.userAgent
                };
                
                // Store referral for attribution
                localStorage.setItem('referral-source', JSON.stringify(referralData));
                
                // Send to analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'referral_visit', {
                        'event_category': 'Viral',
                        'event_label': referralCode,
                        'value': 1
                    });
                }
                
                // Show referral welcome message
                setTimeout(() => {
                    this.showShareNotification('🎁 Bir arkadaşınız sizi davet etti! Hoş geldiniz!', 'success', 5000);
                }, 2000);
            }

            setupViralCampaigns() {
                // Milestone-based rewards
                this.checkMilestones();
                
                // Seasonal campaigns
                this.checkSeasonalCampaigns();
            }

            checkMilestones() {
                const shares = this.socialMetrics.shares;
                
                if (shares >= 5 && !localStorage.getItem('milestone-5-shares')) {
                    this.triggerMilestone('5 paylaşım tamamlandı! 🏆 Premium özellikler 1 hafta ücretsiz!');
                    localStorage.setItem('milestone-5-shares', 'true');
                }
                
                if (shares >= 25 && !localStorage.getItem('milestone-25-shares')) {
                    this.triggerMilestone('25 paylaşım! 🌟 Özel rozet kazandınız!');
                    localStorage.setItem('milestone-25-shares', 'true');
                }
            }

            checkSeasonalCampaigns() {
                const now = new Date();
                const month = now.getMonth();
                const day = now.getDate();
                
                // New Year campaign
                if (month === 0 && day <= 7) {
                    this.showCampaignBanner('🎊 Yeni Yıl Özel! Paylaştıkça ödül kazan!');
                }
                
                // Valentine's Day
                if (month === 1 && day >= 10 && day <= 16) {
                    this.showCampaignBanner('💝 Sevgililer Günü Özel! Aşk dolu QR kodlar oluştur!');
                }
            }

            triggerMilestone(message) {
                // Create milestone celebration
                const celebration = document.createElement('div');
                celebration.className = 'milestone-celebration';
                celebration.innerHTML = `
                    <div class="milestone-content">
                        <div class="milestone-icon">🎉</div>
                        <h3>Tebrikler!</h3>
                        <p>${message}</p>
                        <button onclick="this.parentElement.parentElement.remove()" class="btn-primary">
                            Harika! 🚀
                        </button>
                    </div>
                `;
                
                document.body.appendChild(celebration);
                
                // Auto remove after 10 seconds
                setTimeout(() => {
                    if (celebration.parentNode) {
                        celebration.remove();
                    }
                }, 10000);
            }

            showCampaignBanner(message) {
                if (localStorage.getItem('campaign-shown-today')) return;
                
                const banner = document.createElement('div');
                banner.className = 'campaign-banner';
                banner.innerHTML = `
                    <div class="campaign-content">
                        <span>${message}</span>
                        <button onclick="this.parentElement.parentElement.remove()" class="campaign-close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                document.body.insertBefore(banner, document.body.firstChild);
                
                // Don't show again today
                localStorage.setItem('campaign-shown-today', new Date().toDateString());
            }

            showShareNotification(message, type = 'info', duration = 3000) {
                if (window.app && window.app.showNotification) {
                    window.app.showNotification(message, type, { duration });
                }
            }

            initializeShareButtons() {
                // Show share section when QR is generated
                window.addEventListener('qr-generated', () => {
                    const shareSection = document.getElementById('viral-share-section');
                    if (shareSection) {
                        shareSection.style.display = 'block';
                        this.updateShareUI();
                    }
                });
            }
        }

        // Enhanced Security Manager
        class SecurityManager {
            constructor() {
                this.init();
            }

            init() {
                this.setupInputSanitization();
                this.setupRateLimiting();
                this.setupIntegrityChecks();
                this.monitorSuspiciousActivity();
            }

            // Input sanitization and validation
            sanitizeInput(input, type = 'text') {
                if (typeof input !== 'string') {
                    return '';
                }

                // Basic sanitization
                let sanitized = input.trim();
                
                switch (type) {
                    case 'url':
                        return this.sanitizeURL(sanitized);
                    case 'email':
                        return this.sanitizeEmail(sanitized);
                    case 'phone':
                        return this.sanitizePhone(sanitized);
                    case 'coordinates':
                        return this.sanitizeCoordinates(sanitized);
                    case 'text':
                    default:
                        return this.sanitizeText(sanitized);
                }
            }

            sanitizeText(text) {
                // Remove potentially dangerous characters
                return text
                    .replace(/[<>\"'&]/g, '') // Remove HTML chars
                    .replace(/javascript:/gi, '') // Remove javascript: protocol
                    .replace(/data:/gi, '') // Remove data: protocol
                    .replace(/vbscript:/gi, '') // Remove vbscript: protocol
                    .substring(0, 10000); // Limit length
            }

            sanitizeURL(url) {
                try {
                    // Allow only http, https, mailto protocols
                    const allowedProtocols = ['http:', 'https:', 'mailto:', 'tel:', 'sms:'];
                    
                    // Add protocol if missing
                    if (!url.includes('://') && !url.startsWith('mailto:') && !url.startsWith('tel:') && !url.startsWith('sms:')) {
                        url = 'https://' + url;
                    }

                    const urlObj = new URL(url);
                    
                    if (!allowedProtocols.includes(urlObj.protocol)) {
                        throw new Error('Invalid protocol');
                    }

                    // Additional checks for suspicious patterns
                    if (urlObj.hostname.includes('..') || urlObj.pathname.includes('..')) {
                        throw new Error('Suspicious URL pattern');
                    }

                    return urlObj.toString();
                } catch (error) {
                    console.warn('Security: Invalid URL sanitized:', url, error);
                    return '';
                }
            }

            sanitizeEmail(email) {
                const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                
                if (!emailRegex.test(email) || email.length > 254) {
                    console.warn('Security: Invalid email sanitized:', email);
                    return '';
                }
                
                return email.toLowerCase();
            }

            sanitizePhone(phone) {
                // Remove all non-numeric characters except + and spaces
                const cleaned = phone.replace(/[^\d\+\s\-\(\)]/g, '');
                
                // Basic validation
                if (cleaned.length < 7 || cleaned.length > 20) {
                    console.warn('Security: Invalid phone sanitized:', phone);
                    return '';
                }
                
                return cleaned;
            }

            sanitizeCoordinates(coord) {
                const num = parseFloat(coord);
                
                // Validate latitude/longitude ranges
                if (isNaN(num) || num < -180 || num > 180) {
                    console.warn('Security: Invalid coordinates sanitized:', coord);
                    return '';
                }
                
                return num.toString();
            }

            // Rate limiting to prevent abuse
            setupRateLimiting() {
                this.rateLimits = {
                    qrGeneration: { count: 0, lastReset: Date.now(), limit: 100 }, // 100 per hour
                    scanning: { count: 0, lastReset: Date.now(), limit: 50 }, // 50 per hour
                    fileUpload: { count: 0, lastReset: Date.now(), limit: 20 } // 20 per hour
                };
            }

            checkRateLimit(action) {
                const now = Date.now();
                const rateLimit = this.rateLimits[action];
                
                if (!rateLimit) return true;

                // Reset counter every hour
                if (now - rateLimit.lastReset > 3600000) {
                    rateLimit.count = 0;
                    rateLimit.lastReset = now;
                }

                if (rateLimit.count >= rateLimit.limit) {
                    console.warn(`Security: Rate limit exceeded for ${action}`);
                    return false;
                }

                rateLimit.count++;
                return true;
            }

            // File upload validation
            validateFile(file, allowedTypes = ['image/*'], maxSize = 5 * 1024 * 1024) {
                if (!file || !file.type) {
                    throw new Error('Geçersiz dosya');
                }

                // Check file type
                const isTypeAllowed = allowedTypes.some(type => {
                    if (type.endsWith('/*')) {
                        return file.type.startsWith(type.slice(0, -1));
                    }
                    return file.type === type;
                });

                if (!isTypeAllowed) {
                    throw new Error(`Desteklenmeyen dosya türü: ${file.type}`);
                }

                // Check file size
                if (file.size > maxSize) {
                    throw new Error(`Dosya çok büyük. Maksimum: ${Math.round(maxSize / 1024 / 1024)}MB`);
                }

                // Additional security checks
                if (file.name.includes('..') || file.name.includes('/') || file.name.includes('\\')) {
                    throw new Error('Geçersiz dosya adı');
                }

                return true;
            }

            // Monitor suspicious activity
            monitorSuspiciousActivity() {
                this.suspiciousActivity = {
                    rapidClicks: { count: 0, lastClick: 0 },
                    invalidInputs: { count: 0, lastInput: 0 },
                    failedOperations: { count: 0, lastFailure: 0 }
                };

                // Monitor rapid clicking
                document.addEventListener('click', (e) => {
                    const now = Date.now();
                    const activity = this.suspiciousActivity.rapidClicks;
                    
                    if (now - activity.lastClick < 100) { // Less than 100ms between clicks
                        activity.count++;
                        if (activity.count > 10) {
                            this.handleSuspiciousActivity('rapid_clicking');
                        }
                    } else {
                        activity.count = 0;
                    }
                    
                    activity.lastClick = now;
                });

                // Monitor console access (basic detection)
                let devtools = false;
                setInterval(() => {
                    if (window.outerHeight - window.innerHeight > 200 && !devtools) {
                        devtools = true;
                        console.warn('Security: Developer tools detected');
                    } else if (window.outerHeight - window.innerHeight <= 200) {
                        devtools = false;
                    }
                }, 1000);
            }

            handleSuspiciousActivity(type) {
                console.warn(`Security: Suspicious activity detected: ${type}`);
                
                // Track in analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'security_alert', {
                        'event_category': 'Security',
                        'event_label': type,
                        'value': 1
                    });
                }

                // Could implement additional measures here
                // like temporary rate limiting or user verification
            }

            // Integrity checks
            setupIntegrityChecks() {
                // Check for DOM tampering
                this.originalTitle = document.title;
                
                setInterval(() => {
                    if (document.title !== this.originalTitle && 
                        !document.title.startsWith('QR Generator Pro')) {
                        console.warn('Security: Title tampering detected');
                        document.title = this.originalTitle;
                    }
                }, 5000);
            }

            // Generate secure random IDs
            generateSecureId(length = 16) {
                const array = new Uint8Array(length);
                crypto.getRandomValues(array);
                return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
            }

            // Secure localStorage operations
            secureLocalStorage = {
                set: (key, value) => {
                    try {
                        const encrypted = btoa(JSON.stringify({
                            data: value,
                            timestamp: Date.now(),
                            checksum: this.generateChecksum(JSON.stringify(value))
                        }));
                        localStorage.setItem(key, encrypted);
                    } catch (error) {
                        console.error('Security: Failed to store data securely:', error);
                    }
                },
                
                get: (key) => {
                    try {
                        const encrypted = localStorage.getItem(key);
                        if (!encrypted) return null;
                        
                        const decrypted = JSON.parse(atob(encrypted));
                        
                        // Verify checksum
                        if (this.generateChecksum(JSON.stringify(decrypted.data)) !== decrypted.checksum) {
                            console.warn('Security: Data integrity check failed for:', key);
                            return null;
                        }
                        
                        return decrypted.data;
                    } catch (error) {
                        console.error('Security: Failed to retrieve data securely:', error);
                        return null;
                    }
                }
            };

            generateChecksum(data) {
                // Simple checksum for data integrity
                let hash = 0;
                for (let i = 0; i < data.length; i++) {
                    const char = data.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // Convert to 32bit integer
                }
                return hash.toString(16);
            }
        }

        // Enhanced Accessibility Functions
        class AccessibilityManager {
            constructor() {
                this.focusTrap = null;
                this.lastFocusedElement = null;
                this.init();
            }

            init() {
                this.setupKeyboardNavigation();
                this.setupScreenReaderAnnouncements();
                this.setupFocusManagement();
                this.detectMotionPreference();
            }

            setupKeyboardNavigation() {
                // Tab navigation between nav tabs
                document.addEventListener('keydown', (e) => {
                    if (e.target.matches('.nav-tab')) {
                        this.handleTabNavigation(e);
                    }
                    
                    // Global keyboard shortcuts
                    this.handleGlobalShortcuts(e);
                });
            }

            handleTabNavigation(e) {
                const tabs = Array.from(document.querySelectorAll('.nav-tab'));
                const currentIndex = tabs.indexOf(e.target);
                let targetIndex;

                switch (e.key) {
                    case 'ArrowLeft':
                    case 'ArrowUp':
                        e.preventDefault();
                        targetIndex = currentIndex > 0 ? currentIndex - 1 : tabs.length - 1;
                        break;
                    case 'ArrowRight':
                    case 'ArrowDown':
                        e.preventDefault();
                        targetIndex = currentIndex < tabs.length - 1 ? currentIndex + 1 : 0;
                        break;
                    case 'Home':
                        e.preventDefault();
                        targetIndex = 0;
                        break;
                    case 'End':
                        e.preventDefault();
                        targetIndex = tabs.length - 1;
                        break;
                    case 'Enter':
                    case ' ':
                        e.preventDefault();
                        e.target.click();
                        return;
                    default:
                        return;
                }

                if (targetIndex !== undefined) {
                    this.switchToTab(tabs[targetIndex], targetIndex);
                }
            }

            switchToTab(targetTab, index) {
                // Update all tabs
                document.querySelectorAll('.nav-tab').forEach((tab, i) => {
                    const isSelected = i === index;
                    tab.setAttribute('aria-selected', isSelected);
                    tab.setAttribute('tabindex', isSelected ? '0' : '-1');
                    tab.classList.toggle('active', isSelected);
                });

                // Focus the new tab
                targetTab.focus();
                
                // Trigger tab change
                const tabId = targetTab.getAttribute('data-tab');
                if (window.app) {
                    window.app.switchTab(tabId);
                }
                
                // Announce the change
                this.announce(`${targetTab.textContent} sekmesi seçildi`);
            }

            handleGlobalShortcuts(e) {
                // Alt + 1-6 for quick tab switching
                if (e.altKey && e.key >= '1' && e.key <= '6') {
                    e.preventDefault();
                    const tabIndex = parseInt(e.key) - 1;
                    const tabs = document.querySelectorAll('.nav-tab');
                    if (tabs[tabIndex]) {
                        this.switchToTab(tabs[tabIndex], tabIndex);
                    }
                }

                // Escape key to close modals/notifications
                if (e.key === 'Escape') {
                    this.closeActiveModals();
                }
            }

            setupScreenReaderAnnouncements() {
                // Create live region for announcements
                const liveRegion = document.createElement('div');
                liveRegion.setAttribute('aria-live', 'polite');
                liveRegion.setAttribute('aria-atomic', 'true');
                liveRegion.className = 'sr-only';
                liveRegion.id = 'live-region';
                document.body.appendChild(liveRegion);
            }

            announce(message, priority = 'polite') {
                const liveRegion = document.getElementById('live-region');
                if (liveRegion) {
                    liveRegion.setAttribute('aria-live', priority);
                    liveRegion.textContent = message;
                    
                    // Clear after announcement
                    setTimeout(() => {
                        liveRegion.textContent = '';
                    }, 1000);
                }
            }

            setupFocusManagement() {
                // Track focus for restoration
                document.addEventListener('focusin', (e) => {
                    this.lastFocusedElement = e.target;
                });
            }

            detectMotionPreference() {
                // Respect user's motion preferences
                const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
                document.documentElement.setAttribute('data-reduced-motion', prefersReducedMotion.matches);
                
                prefersReducedMotion.addEventListener('change', () => {
                    document.documentElement.setAttribute('data-reduced-motion', prefersReducedMotion.matches);
                });
            }

            closeActiveModals() {
                // Close any open notifications
                document.querySelectorAll('.notification').forEach(n => n.remove());
                
                // Focus restoration
                if (this.lastFocusedElement && this.lastFocusedElement !== document.body) {
                    this.lastFocusedElement.focus();
                }
            }
        }

        // Advanced Security & Spam Protection System
        class SecurityEnforcer {
            constructor() {
                this.rateLimiter = new Map();
                this.suspiciousActivity = new Map();
                this.botDetectionScore = 0;
                this.securityEvents = [];
                this.maxRequestsPerMinute = 60;
                this.maxRequestsPerHour = 500;
                this.bannedIPs = new Set();
                this.honeypots = new Set();
                this.fingerprint = null;
                
                this.init();
            }
            
            init() {
                this.generateFingerprint();
                this.setupRateLimiting();
                this.setupBotDetection();
                this.setupHoneypots();
                this.monitorSuspiciousActivity();
                this.protectAgainstXSS();
                this.setupCSRFProtection();
                
                console.log('🔒 Advanced Security System Active');
            }
            
            generateFingerprint() {
                // Generate unique browser fingerprint for tracking
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('Security fingerprint', 2, 2);
                
                const fingerprint = {
                    screen: `${screen.width}x${screen.height}x${screen.colorDepth}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    language: navigator.language,
                    platform: navigator.platform,
                    userAgent: navigator.userAgent.substring(0, 100),
                    canvas: canvas.toDataURL().substring(0, 50),
                    webgl: this.getWebGLFingerprint(),
                    timestamp: Date.now()
                };
                
                this.fingerprint = btoa(JSON.stringify(fingerprint)).substring(0, 32);
                localStorage.setItem('security_fp', this.fingerprint);
            }
            
            getWebGLFingerprint() {
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    if (!gl) return 'no-webgl';
                    
                    const vendor = gl.getParameter(gl.VENDOR);
                    const renderer = gl.getParameter(gl.RENDERER);
                    return `${vendor}_${renderer}`.substring(0, 50);
                } catch (e) {
                    return 'webgl-error';
                }
            }
            
            setupRateLimiting() {
                // Track API calls and QR generations
                this.trackAPICall = (endpoint = 'general') => {
                    const now = Date.now();
                    const minute = Math.floor(now / 60000);
                    const hour = Math.floor(now / 3600000);
                    
                    const key = `${this.fingerprint}_${endpoint}`;
                    
                    if (!this.rateLimiter.has(key)) {
                        this.rateLimiter.set(key, {
                            minute: { count: 0, time: minute },
                            hour: { count: 0, time: hour },
                            total: 0
                        });
                    }
                    
                    const limits = this.rateLimiter.get(key);
                    
                    // Reset counters if time window changed
                    if (limits.minute.time !== minute) {
                        limits.minute = { count: 0, time: minute };
                    }
                    if (limits.hour.time !== hour) {
                        limits.hour = { count: 0, time: hour };
                    }
                    
                    limits.minute.count++;
                    limits.hour.count++;
                    limits.total++;
                    
                    // Check rate limits
                    if (limits.minute.count > this.maxRequestsPerMinute) {
                        this.logSecurityEvent('rate_limit_exceeded', { 
                            type: 'minute', 
                            count: limits.minute.count,
                            endpoint 
                        });
                        return false;
                    }
                    
                    if (limits.hour.count > this.maxRequestsPerHour) {
                        this.logSecurityEvent('rate_limit_exceeded', { 
                            type: 'hour', 
                            count: limits.hour.count,
                            endpoint 
                        });
                        return false;
                    }
                    
                    return true;
                };
            }
            
            setupBotDetection() {
                let mouseMovements = 0;
                let keystrokes = 0;
                let humanBehaviorScore = 0;
                
                // Track human-like behavior
                document.addEventListener('mousemove', () => {
                    mouseMovements++;
                    humanBehaviorScore += 0.1;
                }, { passive: true });
                
                document.addEventListener('keydown', () => {
                    keystrokes++;
                    humanBehaviorScore += 0.2;
                }, { passive: true });
                
                document.addEventListener('scroll', () => {
                    humanBehaviorScore += 0.15;
                }, { passive: true });
                
                // Check for bot-like behavior
                setTimeout(() => {
                    if (mouseMovements === 0 && keystrokes === 0) {
                        this.botDetectionScore += 30;
                    }
                    
                    if (humanBehaviorScore < 1) {
                        this.botDetectionScore += 20;
                    }
                    
                    // Check for headless browser indicators
                    if (navigator.webdriver) {
                        this.botDetectionScore += 50;
                    }
                    
                    if (window.phantom || window._phantom) {
                        this.botDetectionScore += 50;
                    }
                    
                    if (this.botDetectionScore > 50) {
                        this.logSecurityEvent('bot_detected', { 
                            score: this.botDetectionScore,
                            mouseMovements,
                            keystrokes,
                            humanBehaviorScore
                        });
                    }
                }, 10000);
            }
            
            setupHoneypots() {
                // Create invisible honeypot fields
                const honeypot = document.createElement('input');
                honeypot.type = 'email';
                honeypot.name = 'email_verify';
                honeypot.style.position = 'absolute';
                honeypot.style.left = '-9999px';
                honeypot.style.opacity = '0';
                honeypot.style.height = '0';
                honeypot.tabIndex = -1;
                
                document.body.appendChild(honeypot);
                
                honeypot.addEventListener('change', () => {
                    if (honeypot.value) {
                        this.logSecurityEvent('honeypot_triggered', { 
                            value: honeypot.value 
                        });
                    }
                });
            }
            
            monitorSuspiciousActivity() {
                // Monitor for suspicious patterns
                let rapidClicks = 0;
                let lastClickTime = 0;
                
                document.addEventListener('click', (e) => {
                    const now = Date.now();
                    if (now - lastClickTime < 100) { // Clicks faster than 100ms
                        rapidClicks++;
                        if (rapidClicks > 10) {
                            this.logSecurityEvent('rapid_clicking', { 
                                count: rapidClicks,
                                target: e.target.tagName 
                            });
                        }
                    } else {
                        rapidClicks = 0;
                    }
                    lastClickTime = now;
                });
                
                // Monitor console access
                let devtools = false;
                setInterval(() => {
                    const start = performance.now();
                    debugger; // This will pause if devtools is open
                    const end = performance.now();
                    
                    if (end - start > 100) {
                        if (!devtools) {
                            devtools = true;
                            this.logSecurityEvent('devtools_detected');
                        }
                    } else {
                        devtools = false;
                    }
                }, 1000);
            }
            
            protectAgainstXSS() {
                // Sanitize user inputs
                this.sanitizeInput = (input) => {
                    if (typeof input !== 'string') return input;
                    
                    const dangerous = /<script|javascript:|data:|vbscript:|on\w+\s*=/i;
                    if (dangerous.test(input)) {
                        this.logSecurityEvent('xss_attempt', { input: input.substring(0, 100) });
                        return '';
                    }
                    
                    return input
                        .replace(/</g, '&lt;')
                        .replace(/>/g, '&gt;')
                        .replace(/"/g, '&quot;')
                        .replace(/'/g, '&#x27;')
                        .replace(/\//g, '&#x2F;');
                };
                
                // Override dangerous functions
                const originalEval = window.eval;
                window.eval = function(code) {
                    window.securityEnforcer?.logSecurityEvent('eval_attempted', { 
                        code: code?.toString().substring(0, 100) 
                    });
                    return originalEval(code);
                };
            }
            
            setupCSRFProtection() {
                // Generate CSRF token
                this.csrfToken = btoa(Math.random().toString()).substring(0, 32);
                sessionStorage.setItem('csrf_token', this.csrfToken);
                
                // Add CSRF token to forms
                const addCSRFToForms = () => {
                    const forms = document.querySelectorAll('form');
                    forms.forEach(form => {
                        if (!form.querySelector('input[name="csrf_token"]')) {
                            const token = document.createElement('input');
                            token.type = 'hidden';
                            token.name = 'csrf_token';
                            token.value = this.csrfToken;
                            form.appendChild(token);
                        }
                    });
                };
                
                addCSRFToForms();
                
                // Re-add tokens when DOM changes
                const observer = new MutationObserver(addCSRFToForms);
                observer.observe(document.body, { childList: true, subtree: true });
            }
            
            validateRequest(endpoint = 'general') {
                // Check if request is allowed
                if (this.bannedIPs.has(this.fingerprint)) {
                    this.logSecurityEvent('banned_access_attempt', { endpoint });
                    return false;
                }
                
                if (!this.trackAPICall(endpoint)) {
                    return false;
                }
                
                if (this.botDetectionScore > 70) {
                    this.logSecurityEvent('high_bot_score_blocked', { 
                        score: this.botDetectionScore,
                        endpoint 
                    });
                    return false;
                }
                
                return true;
            }
            
            logSecurityEvent(type, details = {}) {
                const event = {
                    type,
                    details,
                    fingerprint: this.fingerprint,
                    timestamp: new Date().toISOString(),
                    url: window.location.href,
                    userAgent: navigator.userAgent.substring(0, 200)
                };
                
                this.securityEvents.push(event);
                
                // Keep only last 100 events
                if (this.securityEvents.length > 100) {
                    this.securityEvents = this.securityEvents.slice(-100);
                }
                
                // Send to analytics if available
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'security_event', {
                        'security_type': type,
                        'security_details': JSON.stringify(details).substring(0, 100)
                    });
                }
                
                console.warn('🚨 Security Event:', type, details);
                
                // Auto-ban for critical events
                const criticalEvents = ['honeypot_triggered', 'xss_attempt', 'eval_attempted'];
                if (criticalEvents.includes(type)) {
                    this.bannedIPs.add(this.fingerprint);
                    localStorage.setItem('security_banned', 'true');
                }
            }
            
            getSecurityReport() {
                return {
                    fingerprint: this.fingerprint,
                    botDetectionScore: this.botDetectionScore,
                    totalEvents: this.securityEvents.length,
                    recentEvents: this.securityEvents.slice(-10),
                    rateLimits: Object.fromEntries(this.rateLimiter),
                    isBanned: this.bannedIPs.has(this.fingerprint)
                };
            }
        }

        // Simple Local Analytics Manager
        class SimpleAnalyticsManager {
            constructor() {
                this.analytics = {
                    visitors: 0,
                    qrGenerated: 0,
                    adViews: 0,
                    adClicks: 0,
                    bounceRate: 0,
                    sessionTime: 0,
                    conversionRate: 0,
                    totalScans: 0,
                    popularQRTypes: {},
                    dailyStats: {}
                };
                
                this.sessionStart = Date.now();
                this.interactions = 0;
                this.hasGenerated = false;
                
                this.loadStoredData();
                this.init();
            }

            init() {
                this.trackSession();
                this.trackUserEvents();
                this.setupPeriodicUpdate();
                this.updateDashboard();
                console.log('📊 Simple Analytics Active');
            }

            loadStoredData() {
                const stored = localStorage.getItem('qr_analytics');
                if (stored) {
                    try {
                        const data = JSON.parse(stored);
                        this.analytics = { ...this.analytics, ...data };
                    } catch (e) {
                        console.warn('Analytics data corrupted, resetting');
                    }
                }
                
                // New session
                this.analytics.visitors++;
            }

            trackSession() {
                // Track user interactions
                ['click', 'scroll', 'keypress', 'mousemove'].forEach(event => {
                    document.addEventListener(event, () => {
                        this.interactions++;
                    }, { passive: true, once: false });
                });

                // Update session metrics every 5 seconds
                setInterval(() => {
                    this.updateSessionMetrics();
                }, 5000);
            }

            updateSessionMetrics() {
                const sessionTime = Math.round((Date.now() - this.sessionStart) / 1000);
                this.analytics.sessionTime = sessionTime;
                
                // Bounce rate calculation
                this.analytics.bounceRate = this.interactions === 0 ? 100 : 
                    Math.max(0, 100 - Math.min(this.interactions * 2, 95));
                
                // Conversion rate
                this.analytics.conversionRate = this.analytics.visitors > 0 ? 
                    Math.round((this.analytics.qrGenerated / this.analytics.visitors) * 100) : 0;

                this.saveData();
            }

            trackUserEvents() {
                // QR Generation tracking
                document.addEventListener('click', (e) => {
                    if (e.target.id === 'generate-btn' || e.target.closest('#generate-btn')) {
                        this.analytics.qrGenerated++;
                        this.hasGenerated = true;
                        
                        const qrType = this.getCurrentQRType();
                        this.analytics.popularQRTypes[qrType] = (this.analytics.popularQRTypes[qrType] || 0) + 1;
                        
                        // Track daily stats
                        const today = new Date().toISOString().split('T')[0];
                        if (!this.analytics.dailyStats[today]) {
                            this.analytics.dailyStats[today] = { generated: 0, visitors: 0 };
                        }
                        this.analytics.dailyStats[today].generated++;
                        
                        this.updateDashboard();
                    }
                });

                // Ad interaction tracking (simplified)
                document.querySelectorAll('.adsense-container').forEach((ad, index) => {
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                this.analytics.adViews++;
                                this.updateDashboard();
                            }
                        });
                    }, { threshold: 0.5 });
                    observer.observe(ad);

                    ad.addEventListener('click', () => {
                        this.analytics.adClicks++;
                        this.updateDashboard();
                    });
                });
            }

            getCurrentQRType() {
                const activeType = document.querySelector('.type-btn.active');
                return activeType ? activeType.dataset.type || 'text' : 'text';
            }

            setupPeriodicUpdate() {
                // Update dashboard every 10 seconds
                setInterval(() => {
                    this.updateDashboard();
                }, 10000);

                // Save data every 30 seconds
                setInterval(() => {
                    this.saveData();
                }, 30000);
            }

            updateDashboard() {
                // Update existing analytics elements
                const updates = {
                    'total-generated': this.analytics.qrGenerated,
                    'total-downloads': Math.floor(this.analytics.qrGenerated * 0.8), // Estimated
                    'total-scans': this.analytics.totalScans,
                    'success-rate': this.analytics.qrGenerated > 0 ? '98%' : '100%',
                    'most-used-type': this.getMostPopularType(),
                    'ad-revenue': '$' + (this.analytics.adClicks * 0.05).toFixed(2),
                    'ad-views': this.analytics.adViews,
                    'ad-ctr': this.getAdCTR()
                };

                Object.entries(updates).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element && element.textContent !== value.toString()) {
                        element.textContent = value;
                        
                        // Add visual feedback
                        element.style.transition = 'all 0.3s ease';
                        element.style.transform = 'scale(1.1)';
                        element.style.color = '#10B981';
                        setTimeout(() => {
                            element.style.transform = 'scale(1)';
                            element.style.color = '';
                        }, 500);
                    }
                });
            }

            getMostPopularType() {
                const types = this.analytics.popularQRTypes;
                if (Object.keys(types).length === 0) return 'Text';
                
                return Object.entries(types).reduce((a, b) => 
                    types[a[0]] > types[b[0]] ? a : b
                )[0].toUpperCase();
            }

            getAdCTR() {
                if (this.analytics.adViews === 0) return '0%';
                return ((this.analytics.adClicks / this.analytics.adViews) * 100).toFixed(1) + '%';
            }

            saveData() {
                try {
                    localStorage.setItem('qr_analytics', JSON.stringify(this.analytics));
                } catch (e) {
                    console.warn('Failed to save analytics data');
                }
            }

            getReport() {
                const sessionMinutes = Math.floor(this.analytics.sessionTime / 60);
                const sessionSeconds = this.analytics.sessionTime % 60;
                
                return {
                    summary: {
                        totalVisitors: this.analytics.visitors,
                        qrGenerated: this.analytics.qrGenerated,
                        conversionRate: this.analytics.conversionRate + '%',
                        bounceRate: this.analytics.bounceRate + '%',
                        avgSessionTime: `${sessionMinutes}:${sessionSeconds.toString().padStart(2, '0')}`,
                        adRevenue: '$' + (this.analytics.adClicks * 0.05).toFixed(2),
                        adCTR: this.getAdCTR()
                    },
                    popular: this.analytics.popularQRTypes,
                    daily: this.analytics.dailyStats
                };
            }

            reset() {
                this.analytics = {
                    visitors: 1,
                    qrGenerated: 0,
                    adViews: 0,
                    adClicks: 0,
                    bounceRate: 0,
                    sessionTime: 0,
                    conversionRate: 0,
                    totalScans: 0,
                    popularQRTypes: {},
                    dailyStats: {}
                };
                
                localStorage.removeItem('qr_analytics');
                this.updateDashboard();
                console.log('Analytics data reset');
            }
        }

        // AdSense Revenue Tracking & Optimization System
        class AdSenseMonetizationManager {
            constructor() {
                this.adViews = 0;
                this.adClicks = 0;
                this.revenue = 0;
                this.ctr = 0;
                this.viewability = new Map();
                this.performanceData = this.loadAdPerformance();
                this.init();
            }

            init() {
                this.trackAdViews();
                this.optimizeAdPlacements();
                this.setupAdAnalytics();
                this.monitorViewability();
                console.log('💰 AdSense Revenue Tracking Initialized');
            }

            trackAdViews() {
                // Track ad visibility using Intersection Observer
                const adContainers = document.querySelectorAll('.adsense-container');
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                            const adId = entry.target.dataset.adId || 'default';
                            this.recordAdView(adId);
                        }
                    });
                }, { threshold: 0.5 });

                adContainers.forEach((container, index) => {
                    container.dataset.adId = `ad-${index + 1}`;
                    observer.observe(container);
                });
            }

            recordAdView(adId) {
                if (!this.viewability.has(adId)) {
                    this.adViews++;
                    this.viewability.set(adId, {
                        viewed: true,
                        timestamp: Date.now()
                    });
                    
                    // Google Analytics event
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'ad_view', {
                            'ad_unit': adId,
                            'value': 1
                        });
                    }
                    
                    this.updateRevenueMetrics();
                }
            }

            optimizeAdPlacements() {
                // A/B test different ad positions
                const testGroup = Math.random() > 0.5 ? 'A' : 'B';
                
                if (testGroup === 'B') {
                    // Move first ad to be more prominent
                    const firstAd = document.querySelector('.adsense-container');
                    if (firstAd) {
                        firstAd.style.transform = 'scale(1.05)';
                        firstAd.style.border = '2px solid rgba(245, 158, 11, 0.3)';
                    }
                }
                
                localStorage.setItem('ad_test_group', testGroup);
            }

            setupAdAnalytics() {
                // Track page engagement time
                let startTime = Date.now();
                let engagementTime = 0;
                
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        engagementTime = Date.now() - startTime;
                        this.recordEngagement(engagementTime);
                    } else {
                        startTime = Date.now();
                    }
                });

                // Track user interactions that might lead to ad clicks
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.adsense-container')) {
                        this.recordAdClick();
                    }
                });
            }

            recordAdClick() {
                this.adClicks++;
                this.ctr = (this.adClicks / this.adViews * 100).toFixed(2);
                
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'ad_click', {
                        'ctr': this.ctr,
                        'value': 1
                    });
                }
                
                this.updateRevenueMetrics();
            }

            recordEngagement(time) {
                // Higher engagement = better ad performance
                const engagementScore = Math.min(time / 60000, 10); // Max 10 minutes
                
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'engagement', {
                        'engagement_time_msec': time,
                        'engagement_score': engagementScore
                    });
                }
            }

            monitorViewability() {
                // Monitor ad viewability score
                setInterval(() => {
                    const visibleAds = document.querySelectorAll('.adsense-container:not([style*="display: none"])');
                    const totalAds = document.querySelectorAll('.adsense-container').length;
                    const viewabilityScore = (visibleAds.length / totalAds * 100).toFixed(1);
                    
                    if (viewabilityScore < 70) {
                        this.optimizeViewability();
                    }
                }, 30000); // Check every 30 seconds
            }

            optimizeViewability() {
                // Dynamic ad optimization
                const ads = document.querySelectorAll('.adsense-container');
                ads.forEach(ad => {
                    const rect = ad.getBoundingClientRect();
                    if (rect.top < 0 || rect.bottom > window.innerHeight) {
                        ad.style.position = 'sticky';
                        ad.style.top = '20px';
                        ad.style.zIndex = '50';
                    }
                });
            }

            updateRevenueMetrics() {
                // Estimate revenue (approximate values)
                this.revenue = (this.adViews * 0.001) + (this.adClicks * 0.05); // Example rates
                
                this.saveAdPerformance();
                this.updateDashboard();
            }

            updateDashboard() {
                // Update analytics dashboard with ad metrics
                const adRevenueEl = document.getElementById('ad-revenue');
                const adCtrEl = document.getElementById('ad-ctr'); 
                const adViewsEl = document.getElementById('ad-views');
                
                if (adRevenueEl) adRevenueEl.textContent = `$${this.revenue.toFixed(2)}`;
                if (adCtrEl) adCtrEl.textContent = `${this.ctr}%`;
                if (adViewsEl) adViewsEl.textContent = this.adViews;
            }

            saveAdPerformance() {
                const data = {
                    adViews: this.adViews,
                    adClicks: this.adClicks,
                    revenue: this.revenue,
                    ctr: this.ctr,
                    lastUpdated: Date.now()
                };
                localStorage.setItem('ad_performance', JSON.stringify(data));
            }

            loadAdPerformance() {
                const data = localStorage.getItem('ad_performance');
                if (data) {
                    const parsed = JSON.parse(data);
                    this.adViews = parsed.adViews || 0;
                    this.adClicks = parsed.adClicks || 0;
                    this.revenue = parsed.revenue || 0;
                    this.ctr = parsed.ctr || 0;
                    return parsed;
                }
                return {};
            }
        }

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize theme manager first (affects everything visually)
            window.themeManager = new ThemeManager();
            
            // Initialize viral marketing system
            window.viralManager = new ViralManager();
            
            // Initialize AI optimizer
            window.qrOptimizer = new QROptimizer();
            
            // Initialize security manager
            window.securityManager = new SecurityManager();
            
            // Initialize accessibility manager
            window.accessibilityManager = new AccessibilityManager();
            
            // Initialize Simple Analytics System
            window.simpleAnalytics = new SimpleAnalyticsManager();
            
            // Initialize AdSense monetization system
            window.adSenseManager = new AdSenseMonetizationManager();
            
            // Initialize performance monitoring
            window.performanceMonitor = new PerformanceMonitor();
            
            // Initialize advanced security system
            window.securityEnforcer = new SecurityEnforcer();

            // Premium Management System
            class PremiumManager {
                constructor() {
                    this.currentPlan = localStorage.getItem('premium_plan') || 'free';
                    this.subscriptionDate = localStorage.getItem('subscription_date');
                    this.features = {
                        free: {
                            qrLimit: 10,
                            batchLimit: 0,
                            logoUpload: false,
                            analytics: false,
                            apiAccess: false,
                            prioritySupport: false,
                            customDomains: false,
                            advancedSecurity: false
                        },
                        pro: {
                            qrLimit: 500,
                            batchLimit: 100,
                            logoUpload: true,
                            analytics: true,
                            apiAccess: false,
                            prioritySupport: true,
                            customDomains: false,
                            advancedSecurity: true
                        },
                        enterprise: {
                            qrLimit: -1, // unlimited
                            batchLimit: -1, // unlimited
                            logoUpload: true,
                            analytics: true,
                            apiAccess: true,
                            prioritySupport: true,
                            customDomains: true,
                            advancedSecurity: true
                        }
                    };
                    this.updatePlanDisplay();
                }

                getCurrentPlan() {
                    return this.currentPlan;
                }

                hasFeature(feature) {
                    return this.features[this.currentPlan][feature];
                }

                canUseFeature(feature, currentUsage = 0) {
                    const limit = this.features[this.currentPlan][feature + 'Limit'];
                    return limit === -1 || currentUsage < limit;
                }

                upgradeToPlan(planType) {
                    if (planType === 'pro' || planType === 'enterprise') {
                        // Simulate payment process
                        this.showPaymentModal(planType);
                    }
                }

                showPaymentModal(planType) {
                    const planPrices = { pro: '$4.99', enterprise: '$29.00' };
                    const planNames = { pro: 'QR Pro', enterprise: 'QR Enterprise' };
                    
                    const modal = document.createElement('div');
                    modal.className = 'premium-modal';
                    modal.style.display = 'block';
                    modal.innerHTML = `
                        <div class="premium-modal-content">
                            <span class="premium-close">&times;</span>
                            <h3><i class="fas fa-credit-card"></i> Ödeme</h3>
                            <div style="text-align: center; margin: 20px 0;">
                                <h4>${planNames[planType]} Planına Yükseltme</h4>
                                <div style="font-size: 2em; color: var(--primary-color); font-weight: bold;">
                                    ${planPrices[planType]}/ay
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                                <h4>Demo Mod Aktif</h4>
                                <p>Bu demo sürümünde ödeme işlemi simüle edilmektedir. Gerçek uygulamada Stripe, PayPal veya başka bir ödeme sağlayıcısı entegre edilecektir.</p>
                                <button class="demo-upgrade-btn" onclick="window.premiumManager.simulateUpgrade('${planType}')">
                                    Demo Yükseltmesi Yap
                                </button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    
                    modal.querySelector('.premium-close').onclick = () => {
                        document.body.removeChild(modal);
                    };
                    
                    modal.onclick = (e) => {
                        if (e.target === modal) {
                            document.body.removeChild(modal);
                        }
                    };
                }

                simulateUpgrade(planType) {
                    this.currentPlan = planType;
                    this.subscriptionDate = new Date().toISOString();
                    
                    localStorage.setItem('premium_plan', planType);
                    localStorage.setItem('subscription_date', this.subscriptionDate);
                    
                    this.updatePlanDisplay();
                    
                    // Close modal
                    const modal = document.querySelector('.premium-modal');
                    if (modal) {
                        document.body.removeChild(modal);
                    }
                    
                    // Show success notification
                    window.notificationSystem.show(
                        `🎉 ${planType.charAt(0).toUpperCase() + planType.slice(1)} planına başarıyla yükseltildi!`, 
                        'success', 
                        5000
                    );
                    
                    // Track upgrade
                    if (window.simpleAnalytics) {
                        window.simpleAnalytics.trackEvent('premium_upgrade', { plan: planType });
                    }
                }

                downgrade() {
                    const confirmDowngrade = confirm('Premium planınızı iptal etmek istediğinizden emin misiniz? Tüm premium özellikler kaybolacak.');
                    
                    if (confirmDowngrade) {
                        this.currentPlan = 'free';
                        localStorage.setItem('premium_plan', 'free');
                        localStorage.removeItem('subscription_date');
                        
                        this.updatePlanDisplay();
                        
                        window.notificationSystem.show(
                            'Premium planınız iptal edildi. Temel özellikler kullanılabilir.', 
                            'info', 
                            5000
                        );
                        
                        // Track downgrade
                        if (window.simpleAnalytics) {
                            window.simpleAnalytics.trackEvent('premium_downgrade');
                        }
                    }
                }

                updatePlanDisplay() {
                    // Update plan buttons
                    const planButtons = document.querySelectorAll('.plan-btn');
                    planButtons.forEach(btn => {
                        const planType = btn.dataset.plan;
                        
                        if (planType === this.currentPlan) {
                            btn.textContent = 'Aktif Plan';
                            btn.disabled = true;
                            btn.style.background = 'var(--success-color)';
                        } else if (planType === 'free') {
                            if (this.currentPlan !== 'free') {
                                btn.textContent = 'Plana Geç';
                                btn.disabled = false;
                                btn.onclick = () => this.downgrade();
                            } else {
                                btn.textContent = 'Aktif Plan';
                                btn.disabled = true;
                            }
                        } else {
                            btn.textContent = 'Yükselt';
                            btn.disabled = false;
                            btn.onclick = () => this.upgradeToPlan(planType);
                        }
                    });

                    // Update navbar plan indicator
                    this.updateNavbarPlanIndicator();
                }

                updateNavbarPlanIndicator() {
                    const navbarPlan = document.querySelector('.navbar-plan');
                    if (!navbarPlan) {
                        const navContainer = document.querySelector('.nav-container');
                        const planIndicator = document.createElement('div');
                        planIndicator.className = 'navbar-plan';
                        navContainer.appendChild(planIndicator);
                    }
                    
                    const planIndicator = document.querySelector('.navbar-plan');
                    const planNames = { free: 'Ücretsiz', pro: 'Pro', enterprise: 'Enterprise' };
                    const planColors = { free: '#6b7280', pro: '#4f46e5', enterprise: '#f59e0b' };
                    
                    planIndicator.innerHTML = `
                        <div class="plan-badge-nav" style="background: ${planColors[this.currentPlan]}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                            ${planNames[this.currentPlan]}
                        </div>
                    `;
                }

                restrictFeature(featureName, currentUsage = 0) {
                    if (!this.hasFeature(featureName)) {
                        this.showUpgradePrompt(featureName);
                        return false;
                    }
                    
                    const limit = this.features[this.currentPlan][featureName + 'Limit'];
                    if (limit !== -1 && currentUsage >= limit) {
                        this.showLimitReachedPrompt(featureName, limit);
                        return false;
                    }
                    
                    return true;
                }

                showUpgradePrompt(featureName) {
                    const featureNames = {
                        logoUpload: 'Logo Ekleme',
                        analytics: 'Gelişmiş Analytics',
                        apiAccess: 'API Erişimi',
                        batchLimit: 'Toplu Üretim',
                        advancedSecurity: 'Gelişmiş Güvenlik'
                    };
                    
                    const modal = document.createElement('div');
                    modal.className = 'premium-modal';
                    modal.style.display = 'block';
                    modal.innerHTML = `
                        <div class="premium-modal-content">
                            <span class="premium-close">&times;</span>
                            <h3><i class="fas fa-lock"></i> Premium Özellik</h3>
                            <div style="text-align: center; margin: 20px 0;">
                                <p><strong>${featureNames[featureName]}</strong> premium bir özelliktir.</p>
                                <p>Bu özelliği kullanmak için planınızı yükseltin.</p>
                                <button class="upgrade-now-btn" onclick="document.querySelector('[data-tab=\\"premium\\"]').click(); document.body.removeChild(this.closest('.premium-modal'));">
                                    Şimdi Yükselt
                                </button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    
                    modal.querySelector('.premium-close').onclick = () => {
                        document.body.removeChild(modal);
                    };
                    
                    modal.onclick = (e) => {
                        if (e.target === modal) {
                            document.body.removeChild(modal);
                        }
                    };
                }

                showLimitReachedPrompt(featureName, limit) {
                    const featureNames = {
                        qr: 'QR Kod Üretimi',
                        batch: 'Toplu Üretim'
                    };
                    
                    window.notificationSystem.show(
                        `${featureNames[featureName]} limitiniz (${limit}) dolmuştur. Premium plana yükseltin.`, 
                        'warning', 
                        5000
                    );
                }
            }

            // Initialize premium management
            window.premiumManager = new PremiumManager();
            
            // Preload critical resources
            LazyLoader.preloadCriticalResources();
            
            // Then initialize the main app
            window.app = new QRGeneratorPro();
            
            // Set up global managers
            window.app.themeManager = window.themeManager;
            window.app.viralManager = window.viralManager;
            window.app.qrOptimizer = window.qrOptimizer;
            window.app.accessibilityManager = window.accessibilityManager;
            window.app.securityManager = window.securityManager;
            
            console.log('🎯 QR Generator Pro v2.2 - Simple Analytics Edition Loaded');
        });
        
        // Helper functions for Simple Analytics
        function viewAnalyticsReport() {
            const report = window.simpleAnalytics?.getReport();
            if (!report) {
                showNotification('Analytics sistemi yüklenemedi', 'error');
                return;
            }
            
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <html>
                <head>
                    <title>QR Generator Pro - Analytics Raporu</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
                        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
                        h1 { color: #4F46E5; text-align: center; }
                        .section { margin: 30px 0; }
                        .metric { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
                        .metric strong { color: #333; }
                        .popular-types { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
                        .type-card { background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h1>📊 QR Generator Pro Analytics</h1>
                        
                        <div class="section">
                            <h2>📈 Genel İstatistikler</h2>
                            <div class="metric"><span>Toplam Ziyaretçi:</span><strong>${report.summary.totalVisitors}</strong></div>
                            <div class="metric"><span>Oluşturulan QR:</span><strong>${report.summary.qrGenerated}</strong></div>
                            <div class="metric"><span>Dönüşüm Oranı:</span><strong>${report.summary.conversionRate}</strong></div>
                            <div class="metric"><span>Çıkış Oranı:</span><strong>${report.summary.bounceRate}</strong></div>
                            <div class="metric"><span>Ortalama Süre:</span><strong>${report.summary.avgSessionTime}</strong></div>
                            <div class="metric"><span>Ad Geliri:</span><strong>${report.summary.adRevenue}</strong></div>
                            <div class="metric"><span>Ad CTR:</span><strong>${report.summary.adCTR}</strong></div>
                        </div>
                        
                        <div class="section">
                            <h2>🔥 Popüler QR Türleri</h2>
                            <div class="popular-types">
                                ${Object.entries(report.popular).map(([type, count]) => 
                                    `<div class="type-card"><strong>${type.toUpperCase()}</strong><br>${count} kez</div>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <div class="section">
                            <h2>📅 Günlük İstatistikler</h2>
                            ${Object.entries(report.daily).map(([date, stats]) => 
                                `<div class="metric"><span>${date}:</span><strong>${stats.generated} QR oluşturuldu</strong></div>`
                            ).join('')}
                        </div>
                        
                        <p style="text-align: center; color: #666; margin-top: 30px;">
                            Rapor Oluşturulma: ${new Date().toLocaleString('tr-TR')}
                        </p>
                    </div>
                </body>
                </html>
            `);
        }
        
        function exportAnalytics() {
            const report = window.simpleAnalytics?.getReport();
            if (!report) {
                showNotification('Analytics sistemi yüklenemedi', 'error');
                return;
            }
            
            const data = {
                exportDate: new Date().toISOString(),
                summary: report.summary,
                popularTypes: report.popular,
                dailyStats: report.daily
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `qr-analytics-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Analytics verisi indirildi!', 'success');
        }
        
        function resetAnalytics() {
            if (confirm('Tüm analytics verilerini silmek istediğinizden emin misiniz?')) {
                window.simpleAnalytics?.reset();
                showNotification('Analytics verileri sıfırlandı', 'info');
            }
        }
        
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                showNotification(successful ? 'Apps Script kodu kopyalandı!' : 'Kopyalama başarısız', 'info');
            } catch (err) {
                showNotification('Kopyalama başarısız', 'error');
            }
            
            document.body.removeChild(textArea);
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification notification-' + type;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#3B82F6'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                z-index: 10001;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                box-shadow: 0 10px 25px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // Social sharing functions
        function shareOnTwitter() {
            const text = encodeURIComponent('QR Generator Pro ile profesyonel QR kodlar oluşturuyorum! 🚀 Ücretsiz ve AI destekli: ');
            const url = encodeURIComponent(window.location.href);
            window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
            
            // Track share event (optional)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'social_share', { platform: 'twitter' });
            }
        }
        
        function shareOnLinkedIn() {
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
            
            // Track share event (optional)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'social_share', { platform: 'linkedin' });
            }
        }
        
        function shareOnWhatsApp() {
            const text = encodeURIComponent('QR Generator Pro - Profesyonel QR kod üretici! Ücretsiz ve AI destekli: ' + window.location.href);
            window.open(`https://wa.me/?text=${text}`, '_blank');
            
            // Track share event (optional)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'social_share', { platform: 'whatsapp' });
            }
        }
        
        // Conversion popup functions
        function closeConversionPopup() {
            const popup = document.getElementById('conversion-popup');
            if (popup) popup.style.display = 'none';
        }
        
        function closeExitIntent() {
            const popup = document.getElementById('exit-intent-popup');
            if (popup) popup.style.display = 'none';
        }
        
        function stayAndCreate() {
            closeExitIntent();
            // Focus on the main generator
            document.getElementById('text-input')?.focus();
            // Track exit intent conversion (optional)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'exit_intent_converted', { action: 'stayed' });
            }
        }
        
        // Exit intent detection
        let mouseY = 0;
        let hasShownExitIntent = false;
        
        document.addEventListener('mousemove', (e) => {
            mouseY = e.clientY;
        });
        
        document.addEventListener('mouseout', (e) => {
            if (!hasShownExitIntent && mouseY < 50 && !e.relatedTarget) {
                // Show exit intent popup
                const popup = document.getElementById('exit-intent-popup');
                if (popup && window.simpleAnalytics?.analytics.qrGenerated === 0) {
                    popup.style.display = 'flex';
                    hasShownExitIntent = true;
                    // Track exit intent (optional)
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'exit_intent_shown');
                    }
                }
            }
        });
        
        // Add CSS for notifications animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // Initialize AdSense
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>